<!doctype html><html lang=en-us><head><meta charset=utf-8><title>config | Documentation</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Manage authentication profiles"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=https://entra-auth-cli-docs.garrardkitchen.com/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://entra-auth-cli-docs.garrardkitchen.com/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://entra-auth-cli-docs.garrardkitchen.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://entra-auth-cli-docs.garrardkitchen.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://entra-auth-cli-docs.garrardkitchen.com/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://entra-auth-cli-docs.garrardkitchen.com/site.webmanifest><meta property="og:title" content="config"><meta property="og:description" content="Manage authentication profiles"><meta property="og:type" content="article"><meta property="og:url" content="https://entra-auth-cli-docs.garrardkitchen.com/docs/reference/config/"><meta property="og:image" content="https://entra-auth-cli-docs.garrardkitchen.com/opengraph/card-base-2_hu_5b5da44ac3eca99d.png"><meta property="article:section" content="docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://entra-auth-cli-docs.garrardkitchen.com/opengraph/card-base-2_hu_5b5da44ac3eca99d.png"><meta name=twitter:title content="config"><meta name=twitter:description content="Manage authentication profiles"><link rel=alternate type=application/atom+xml title="Atom feed for Entra Auth Cli Documentation" href=/index.xml><script type=text/javascript src=https://entra-auth-cli-docs.garrardkitchen.com/docs/js/flexsearch.bundle.min.f5159d5a2151ffbb653996ec17eaff7da4e04c286bd879fc41839d36a5586f3f20eaead0b6089de48f9adc669cdee771.js integrity=sha384-9RWdWiFR/7tlOZbsF+r/faTgTChr2Hn8QYOdNqVYbz8g6urQtgid5I+a3Gac3udx crossorigin=anonymous></script><link rel=stylesheet href=/docs/scss/style.min.5b3937c5bc437fb231e93eb1428b0995f2b57f1f3510302d048e9803c07e46354bfe64d3a5a730662e405adc1c7776d6.css integrity=sha384-Wzk3xbxDf7Ix6T6xQosJlfK1fx81EDAtBI6YA8B+RjVL/mTTpacwZi5AWtwcd3bW crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li class="sidebar-dropdown no-icon"><button class=btn>
Getting Started</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/getting-started/installation/>Installation</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/getting-started/quickstart/>Quick Start</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/getting-started/first-token/>First Token Tutorial</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Core Concepts</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/core-concepts/profiles/>Authentication Profiles</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/core-concepts/oauth2-flows/>OAuth2 Flows</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/core-concepts/scopes/>Scopes & Permissions</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/core-concepts/secure-storage/>Secure Storage</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
User Guide</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/user-guide/managing-profiles/>Managing Profiles</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/user-guide/generating-tokens/>Generating Tokens</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/user-guide/working-with-tokens/>Working with Tokens</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Recipes & Examples</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/microsoft-graph/>Microsoft Graph API</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/azure-management/>Azure Management API</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/cicd-integration/>CI/CD Integration</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/bash-scripts/>Bash Scripting</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/powershell-scripts/>PowerShell Scripting</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/security-hardening/>Security Hardening</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/recipes/common-patterns/>Common Patterns</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
OAuth2 Flows</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/oauth-flows/client-credentials/>Client Credentials Flow</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/oauth-flows/authorization-code/>Authorization Code Flow</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/oauth-flows/device-code/>Device Code Flow</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/oauth-flows/interactive-browser/>Interactive Browser Flow</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Certificate Authentication</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/certificates/overview/>Overview</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/certificates/creating/>Creating Certificates</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/certificates/registering/>Registering in Azure</a></li></ul></div></li><li class="sidebar-dropdown no-icon current active"><button class=btn>
Command Reference</button><div class="sidebar-submenu d-block"><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/reference/get-token/>get-token</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/reference/refresh/>refresh</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/reference/inspect/>inspect</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/reference/discover/>discover</a></li><li class="current no-icon"><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/reference/config/>config</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Platform Guides</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/platform-guides/windows/>Windows</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/platform-guides/macos/>macOS</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/platform-guides/linux/>Linux</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Troubleshooting</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entra-auth-cli-docs.garrardkitchen.com/docs/troubleshooting/profiles/>Profile Issues</a></li></ul></div></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentColor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentColor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentColor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentColor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentColor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentColor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentColor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://github.com/https://github.com/garrardkitchen/entra-token-cli alt=github rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></div></a></li></ul></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/reference/><span itemprop=name>Command Reference</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>config</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=TableOfContents><ul><li><a href=#synopsis>Synopsis</a></li><li><a href=#description>Description</a></li><li><a href=#subcommands>Subcommands</a><ul><li><a href=#create>create</a></li><li><a href=#list>list</a></li><li><a href=#show>show</a></li><li><a href=#edit>edit</a></li><li><a href=#delete>delete</a></li><li><a href=#export>export</a></li><li><a href=#import>import</a></li></ul></li><li><a href=#complete-examples>Complete Examples</a><ul><li><a href=#creating-profiles>Creating Profiles</a></li><li><a href=#managing-profiles>Managing Profiles</a></li><li><a href=#backup-and-migration>Backup and Migration</a></li><li><a href=#environment-based-configuration>Environment-Based Configuration</a></li><li><a href=#validation-script>Validation Script</a></li></ul></li><li><a href=#profile-storage>Profile Storage</a><ul><li><a href=#windows>Windows</a></li><li><a href=#macos>macOS</a></li><li><a href=#linux>Linux</a></li></ul></li><li><a href=#security-best-practices>Security Best Practices</a><ul><li><a href=#secrets-management>Secrets Management</a></li><li><a href=#profile-naming>Profile Naming</a></li><li><a href=#regular-rotation>Regular Rotation</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#profile-not-found>Profile Not Found</a></li><li><a href=#cannot-create-profile>Cannot Create Profile</a></li><li><a href=#profile-corruption>Profile Corruption</a></li></ul></li><li><a href=#see-also>See Also</a></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#synopsis>Synopsis</a></li><li><a href=#description>Description</a></li><li><a href=#subcommands>Subcommands</a><ul><li><a href=#create>create</a></li><li><a href=#list>list</a></li><li><a href=#show>show</a></li><li><a href=#edit>edit</a></li><li><a href=#delete>delete</a></li><li><a href=#export>export</a></li><li><a href=#import>import</a></li></ul></li><li><a href=#complete-examples>Complete Examples</a><ul><li><a href=#creating-profiles>Creating Profiles</a></li><li><a href=#managing-profiles>Managing Profiles</a></li><li><a href=#backup-and-migration>Backup and Migration</a></li><li><a href=#environment-based-configuration>Environment-Based Configuration</a></li><li><a href=#validation-script>Validation Script</a></li></ul></li><li><a href=#profile-storage>Profile Storage</a><ul><li><a href=#windows>Windows</a></li><li><a href=#macos>macOS</a></li><li><a href=#linux>Linux</a></li></ul></li><li><a href=#security-best-practices>Security Best Practices</a><ul><li><a href=#secrets-management>Secrets Management</a></li><li><a href=#profile-naming>Profile Naming</a></li><li><a href=#regular-rotation>Regular Rotation</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#profile-not-found>Profile Not Found</a></li><li><a href=#cannot-create-profile>Cannot Create Profile</a></li><li><a href=#profile-corruption>Profile Corruption</a></li></ul></li><li><a href=#see-also>See Also</a></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><h1 class="content-title mb-0">config</h1></div><div id=content class=main-content><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h1 id=config>config <a href=#config class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><p>Manage authentication profiles for storing connection settings and credentials.</p><h2 id=synopsis>Synopsis <a href=#synopsis class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><div class="prism-codeblock linenos"><pre id=7bb30ae class="language-bash line-numbers">
  <code>entra-auth-cli config &lt;command&gt; [flags]</code>
  </pre></div><h2 id=description>Description <a href=#description class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>The <code>config</code> command manages authentication profiles, which store tenant information, client credentials, and authentication settings. Profiles allow you to easily switch between different applications, environments, or authentication methods.</p><p>Each profile contains:</p><ul><li>Tenant ID</li><li>Client ID</li><li>Authentication method (client secret or certificate)</li><li>Default scopes</li><li>Other configuration options</li></ul><h2 id=subcommands>Subcommands <a href=#subcommands class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=create>create <a href=#create class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Create a new authentication profile.</p><div class="prism-codeblock linenos"><pre id=5d8e333 class="language-bash line-numbers">
  <code>entra-auth-cli config create [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--name</code>, <code>-n</code> - Profile name</li><li><code>--tenant-id</code> - Azure tenant ID</li><li><code>--client-id</code> - Application client ID</li><li><code>--client-secret</code> - Client secret (interactive prompt if not provided)</li><li><code>--certificate</code> - Path to certificate file (PFX/PEM)</li><li><code>--certificate-password</code> - Certificate password</li><li><code>--scope</code> - Default scopes (space-separated)</li><li><code>--interactive</code> - Use interactive prompts for all fields</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=27acef8 class="language-bash line-numbers">
  <code># Interactive creation (recommended)
entra-auth-cli config create

# With flags
entra-auth-cli config create \
  --name production \
  --tenant-id &#34;12345678-1234-1234-1234-123456789012&#34; \
  --client-id &#34;87654321-4321-4321-4321-210987654321&#34; \
  --client-secret &#34;your-secret&#34;

# With certificate
entra-auth-cli config create \
  --name secure-app \
  --tenant-id &#34;$TENANT_ID&#34; \
  --client-id &#34;$CLIENT_ID&#34; \
  --certificate &#34;./cert.pfx&#34; \
  --certificate-password &#34;password&#34;

# With custom scopes
entra-auth-cli config create \
  --name graph-api \
  --scope &#34;User.Read Mail.Read Calendars.Read&#34;</code>
  </pre></div><h3 id=list>list <a href=#list class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>List all configured profiles.</p><div class="prism-codeblock linenos"><pre id=4853366 class="language-bash line-numbers">
  <code>entra-auth-cli config list [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--output</code>, <code>-o</code> - Output format (text, json, yaml)</li><li><code>--verbose</code>, <code>-v</code> - Show additional details</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=15b1159 class="language-bash line-numbers">
  <code># Simple list
entra-auth-cli config list

# With details
entra-auth-cli config list --verbose

# JSON output
entra-auth-cli config list --output json</code>
  </pre></div><h3 id=show>show <a href=#show class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Display detailed information about a profile.</p><div class="prism-codeblock linenos"><pre id=a64247d class="language-bash line-numbers">
  <code>entra-auth-cli config show [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--name</code>, <code>-n</code> - Profile name</li><li><code>--output</code>, <code>-o</code> - Output format (text, json, yaml)</li><li><code>--show-secrets</code> - Show sensitive values (use with caution)</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=3f787eb class="language-bash line-numbers">
  <code># Show profile details
entra-auth-cli config show --name production

# JSON format
entra-auth-cli config show --name production --output json

# Show with secrets (sensitive)
entra-auth-cli config show --name production --show-secrets</code>
  </pre></div><h3 id=edit>edit <a href=#edit class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Edit an existing profile.</p><div class="prism-codeblock linenos"><pre id=5b785bc class="language-bash line-numbers">
  <code>entra-auth-cli config edit [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--name</code>, <code>-n</code> - Profile name</li><li><code>--tenant-id</code> - Update tenant ID</li><li><code>--client-id</code> - Update client ID</li><li><code>--client-secret</code> - Update client secret</li><li><code>--certificate</code> - Update certificate</li><li><code>--scope</code> - Update default scopes</li><li><code>--interactive</code> - Use interactive editor</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=dc03267 class="language-bash line-numbers">
  <code># Interactive edit
entra-auth-cli config edit --name production

# Update specific fields
entra-auth-cli config edit --name production --scope &#34;User.Read Mail.Send&#34;

# Update credentials
entra-auth-cli config edit --name production --client-secret &#34;new-secret&#34;

# Switch to certificate auth
entra-auth-cli config edit --name production \
  --certificate &#34;./new-cert.pfx&#34; \
  --certificate-password &#34;password&#34;</code>
  </pre></div><h3 id=delete>delete <a href=#delete class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Delete a profile.</p><div class="prism-codeblock linenos"><pre id=028d816 class="language-bash line-numbers">
  <code>entra-auth-cli config delete [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--name</code>, <code>-n</code> - Profile name</li><li><code>--force</code>, <code>-f</code> - Skip confirmation prompt</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=4616bc6 class="language-bash line-numbers">
  <code># Delete with confirmation
entra-auth-cli config delete --name old-profile

# Force delete (no confirmation)
entra-auth-cli config delete --name old-profile --force

# Delete multiple profiles
for profile in old-dev old-test old-staging; do
    entra-auth-cli config delete --name &#34;$profile&#34; --force
done</code>
  </pre></div><h3 id=export>export <a href=#export class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Export profile configuration to a file.</p><div class="prism-codeblock linenos"><pre id=bcd0e03 class="language-bash line-numbers">
  <code>entra-auth-cli config export [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--name</code>, <code>-n</code> - Profile name (or all profiles if omitted)</li><li><code>--output</code>, <code>-o</code> - Output file path</li><li><code>--include-secrets</code> - Include sensitive data (use with caution)</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=65ff86f class="language-bash line-numbers">
  <code># Export single profile
entra-auth-cli config export --name production &gt; production-profile.json

# Export all profiles
entra-auth-cli config export &gt; all-profiles.json

# Export with secrets (for backup/migration)
entra-auth-cli config export --name production --include-secrets &gt; backup.json</code>
  </pre></div><h3 id=import>import <a href=#import class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>Import profile configuration from a file.</p><div class="prism-codeblock linenos"><pre id=e873620 class="language-bash line-numbers">
  <code>entra-auth-cli config import [flags]</code>
  </pre></div><p><strong>Flags:</strong></p><ul><li><code>--file</code>, <code>-f</code> - Input file path</li><li><code>--overwrite</code> - Overwrite existing profiles</li><li><code>--dry-run</code> - Show what would be imported without making changes</li></ul><p><strong>Examples:</strong></p><div class="prism-codeblock linenos"><pre id=d88051d class="language-bash line-numbers">
  <code># Import from file
entra-auth-cli config import --file production-profile.json

# Import from stdin
cat production-profile.json | entra-auth-cli config import

# Import with overwrite
entra-auth-cli config import --file all-profiles.json --overwrite

# Dry run to preview
entra-auth-cli config import --file backup.json --dry-run</code>
  </pre></div><h2 id=complete-examples>Complete Examples <a href=#complete-examples class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=creating-profiles>Creating Profiles <a href=#creating-profiles class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><h4 id=client-secret-authentication>Client Secret Authentication <a href=#client-secret-authentication class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=e0c8427 class="language-bash line-numbers">
  <code># Interactive (recommended for first-time users)
entra-auth-cli config create

# You&#39;ll be prompted for:
# - Profile name: production
# - Tenant ID: 12345678-1234-1234-1234-123456789012
# - Client ID: 87654321-4321-4321-4321-210987654321
# - Auth method: client-secret
# - Client secret: (hidden input)
# - Scopes: https://graph.microsoft.com/.default</code>
  </pre></div><h4 id=certificate-authentication>Certificate Authentication <a href=#certificate-authentication class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=791cbab class="language-bash line-numbers">
  <code># Create with certificate
entra-auth-cli config create \
  --name secure-prod \
  --tenant-id &#34;$TENANT_ID&#34; \
  --client-id &#34;$CLIENT_ID&#34; \
  --certificate &#34;./certs/production.pfx&#34; \
  --certificate-password &#34;$CERT_PASSWORD&#34; \
  --scope &#34;https://graph.microsoft.com/.default&#34;</code>
  </pre></div><h4 id=multiple-environments>Multiple Environments <a href=#multiple-environments class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=724ddf7 class="language-bash line-numbers">
  <code># Development environment
entra-auth-cli config create --name dev \
  --tenant-id &#34;$DEV_TENANT_ID&#34; \
  --client-id &#34;$DEV_CLIENT_ID&#34; \
  --client-secret &#34;$DEV_SECRET&#34;

# Staging environment
entra-auth-cli config create --name staging \
  --tenant-id &#34;$STAGING_TENANT_ID&#34; \
  --client-id &#34;$STAGING_CLIENT_ID&#34; \
  --client-secret &#34;$STAGING_SECRET&#34;

# Production environment
entra-auth-cli config create --name production \
  --tenant-id &#34;$PROD_TENANT_ID&#34; \
  --client-id &#34;$PROD_CLIENT_ID&#34; \
  --certificate &#34;./certs/prod.pfx&#34;</code>
  </pre></div><h3 id=managing-profiles>Managing Profiles <a href=#managing-profiles class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><h4 id=list-and-view>List and View <a href=#list-and-view class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=fdcc3e5 class="language-bash line-numbers">
  <code># List all profiles
entra-auth-cli config list

# Output:
# default
# production
# staging
# dev
# graph-api

# Show details of specific profile
entra-auth-cli config show --name production

# Output:
# Profile: production
# Tenant ID: 12345678-1234-1234-1234-123456789012
# Client ID: 87654321-4321-4321-4321-210987654321
# Auth Method: certificate
# Certificate: /path/to/cert.pfx
# Default Scopes: https://graph.microsoft.com/.default</code>
  </pre></div><h4 id=update-configuration>Update Configuration <a href=#update-configuration class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=611063b class="language-bash line-numbers">
  <code># Change default scopes
entra-auth-cli config edit --name production \
  --scope &#34;User.Read Mail.Read Calendars.Read&#34;

# Rotate client secret
entra-auth-cli config edit --name production \
  --client-secret &#34;$NEW_SECRET&#34;

# Switch from secret to certificate
entra-auth-cli config edit --name production \
  --certificate &#34;./new-cert.pfx&#34; \
  --certificate-password &#34;$CERT_PASS&#34;</code>
  </pre></div><h3 id=backup-and-migration>Backup and Migration <a href=#backup-and-migration class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><h4 id=backup-profiles>Backup Profiles <a href=#backup-profiles class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=8550de9 class="language-bash line-numbers">
  <code>#!/bin/bash

# Backup all profiles
BACKUP_DIR=&#34;./profile-backups&#34;
TIMESTAMP=$(date &#43;%Y%m%d_%H%M%S)

mkdir -p &#34;$BACKUP_DIR&#34;

# Export each profile
for profile in $(entra-auth-cli config list); do
    echo &#34;Backing up profile: $profile&#34;
    entra-auth-cli config export --name &#34;$profile&#34; --include-secrets \
      &gt; &#34;$BACKUP_DIR/${profile}_${TIMESTAMP}.json&#34;
done

echo &#34;Backup complete: $BACKUP_DIR&#34;</code>
  </pre></div><h4 id=migrate-to-new-machine>Migrate to New Machine <a href=#migrate-to-new-machine class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h4><div class="prism-codeblock linenos"><pre id=34984af class="language-bash line-numbers">
  <code># On old machine
entra-auth-cli config export --include-secrets &gt; profiles-backup.json

# Transfer file to new machine
scp profiles-backup.json user@newmachine:/tmp/

# On new machine
entra-auth-cli config import --file /tmp/profiles-backup.json

# Verify
entra-auth-cli config list</code>
  </pre></div><h3 id=environment-based-configuration>Environment-Based Configuration <a href=#environment-based-configuration class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=dae99f9 class="language-bash line-numbers">
  <code>#!/bin/bash

# Script to create profiles based on environment
create_env_profile() {
    local env=&#34;$1&#34;
    local tenant_var=&#34;${env}_TENANT_ID&#34;
    local client_var=&#34;${env}_CLIENT_ID&#34;
    local secret_var=&#34;${env}_CLIENT_SECRET&#34;
    
    echo &#34;Creating profile for $env environment...&#34;
    
    entra-auth-cli config create \
        --name &#34;$env&#34; \
        --tenant-id &#34;${!tenant_var}&#34; \
        --client-id &#34;${!client_var}&#34; \
        --client-secret &#34;${!secret_var}&#34; \
        --scope &#34;https://graph.microsoft.com/.default&#34;
}

# Create profiles for each environment
for env in DEV STAGING PRODUCTION; do
    create_env_profile &#34;$env&#34;
done

echo &#34;All profiles created:&#34;
entra-auth-cli config list</code>
  </pre></div><h3 id=validation-script>Validation Script <a href=#validation-script class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=05b4cac class="language-bash line-numbers">
  <code>#!/bin/bash

# Validate all profiles can generate tokens
echo &#34;Validating profiles...&#34;

failed=0
for profile in $(entra-auth-cli config list); do
    echo -n &#34;Testing $profile... &#34;
    
    if entra-auth-cli get-token --profile &#34;$profile&#34; --output json &gt; /dev/null 2&gt;&amp;1; then
        echo &#34;✓ OK&#34;
    else
        echo &#34;✗ FAILED&#34;
        failed=$((failed &#43; 1))
    fi
done

if [ $failed -eq 0 ]; then
    echo &#34;All profiles valid!&#34;
    exit 0
else
    echo &#34;$failed profile(s) failed validation&#34;
    exit 1
fi</code>
  </pre></div><h2 id=profile-storage>Profile Storage <a href=#profile-storage class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><p>Profiles are stored in platform-specific locations:</p><h3 id=windows>Windows <a href=#windows class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=5faa212 class=language->
  <code>%LOCALAPPDATA%\EntraAuthCli\profiles\</code>
  </pre></div><h3 id=macos>macOS <a href=#macos class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=0324af4 class=language->
  <code>~/Library/Application Support/entra-auth-cli/profiles/</code>
  </pre></div><h3 id=linux>Linux <a href=#linux class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=prism-codeblock><pre id=4d9be74 class=language->
  <code>~/.entra-auth-cli/profiles/</code>
  </pre></div><p>Each profile consists of:</p><ul><li><code>profile-name.json</code> - Configuration</li><li><code>profile-name.token</code> - Encrypted tokens (if cached)</li></ul><h2 id=security-best-practices>Security Best Practices <a href=#security-best-practices class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=secrets-management>Secrets Management <a href=#secrets-management class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=c869ed2 class="language-bash line-numbers">
  <code># ✅ Good - use environment variables
export CLIENT_SECRET=$(vault read -field=secret secret/azure/client)
entra-auth-cli config create --client-secret &#34;$CLIENT_SECRET&#34;

# ✅ Good - interactive prompt (hides input)
entra-auth-cli config create  # Will prompt for secret

# ❌ Bad - hardcoded in script
entra-auth-cli config create --client-secret &#34;my-secret-123&#34;

# ❌ Bad - visible in command history
entra-auth-cli config create --client-secret &#34;$SECRET&#34;  # If $SECRET expands</code>
  </pre></div><h3 id=profile-naming>Profile Naming <a href=#profile-naming class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=52d7c37 class="language-bash line-numbers">
  <code># ✅ Good - descriptive names
entra-auth-cli config create --name prod-graph-api
entra-auth-cli config create --name staging-azure-mgmt
entra-auth-cli config create --name dev-user-app

# ❌ Avoid - generic names
entra-auth-cli config create --name app1
entra-auth-cli config create --name test</code>
  </pre></div><h3 id=regular-rotation>Regular Rotation <a href=#regular-rotation class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=975a680 class="language-bash line-numbers">
  <code>#!/bin/bash
# Rotate secrets for all profiles

for profile in $(entra-auth-cli config list); do
    echo &#34;Rotating secret for $profile&#34;
    
    # Get new secret from vault
    NEW_SECRET=$(vault read -field=secret &#34;secret/azure/$profile&#34;)
    
    # Update profile
    entra-auth-cli config edit --name &#34;$profile&#34; --client-secret &#34;$NEW_SECRET&#34;
    
    # Verify
    if entra-auth-cli get-token --profile &#34;$profile&#34; &gt; /dev/null; then
        echo &#34;✓ $profile updated successfully&#34;
    else
        echo &#34;✗ $profile update failed&#34;
    fi
done</code>
  </pre></div><h2 id=troubleshooting>Troubleshooting <a href=#troubleshooting class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=profile-not-found>Profile Not Found <a href=#profile-not-found class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=6764923 class="language-bash line-numbers">
  <code># List available profiles
entra-auth-cli config list

# Check exact name (case-sensitive)
entra-auth-cli config show --name Production  # Won&#39;t match &#34;production&#34;</code>
  </pre></div><h3 id=cannot-create-profile>Cannot Create Profile <a href=#cannot-create-profile class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=5f2c7ab class="language-bash line-numbers">
  <code># Check storage directory permissions
# Linux/macOS
ls -la ~/.entra-auth-cli/profiles/
chmod 700 ~/.entra-auth-cli/profiles/

# Windows (PowerShell)
Test-Path &#34;$env:LOCALAPPDATA\EntraAuthCli\profiles&#34;</code>
  </pre></div><h3 id=profile-corruption>Profile Corruption <a href=#profile-corruption class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class="prism-codeblock linenos"><pre id=cb8458a class="language-bash line-numbers">
  <code># View raw profile file
# Linux/macOS
cat ~/.entra-auth-cli/profiles/production.json

# If corrupted, delete and recreate
entra-auth-cli config delete --name production --force
entra-auth-cli config create --name production</code>
  </pre></div><h2 id=see-also>See Also <a href=#see-also class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><ul><li><a href=/docs/user-guide/managing-profiles/>Managing Profiles</a> - Detailed profile management guide</li><li><a href=/docs/reference/get-token/>get-token</a> - Generate tokens using profiles</li><li><a href=/docs/recipes/security-hardening/>Security Best Practices</a> - Secure configuration practices</li></ul></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/docs/core-concepts/secure-storage/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Secure Storage</p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>© 2025 Garrard Kitchen</p></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script src=/docs/js/bootstrap.9830259bc28edf5a45a3c7aa85d782bb2b8ac9a68e8ff3e14e4ad92a0aaf7882b8c20ea2ba1c4fc65f4415a3046aca9a.js integrity=sha384-mDAlm8KO31pFo8eqhdeCuyuKyaaOj/PhTkrZKgqveIK4wg6iuhxPxl9EFaMEasqa defer></script><script type=text/javascript src=https://entra-auth-cli-docs.garrardkitchen.com/docs/js/bundle.min.baa0ebb6e46d281a19f55f70b02116c310cc759790781a6816ccd54a2be3652fca404ceadc2542b3776d181b9f80c532.js integrity=sha384-uqDrtuRtKBoZ9V9wsCEWwxDMdZeQeBpoFszVSivjZS/KQEzq3CVCs3dtGBufgMUy crossorigin=anonymous defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    


    

    

    index.add(
            {
                id:  0 ,
                href: "\/docs\/",
                title: "Documentation",
                description: "Complete guide to using Entra Auth Cli",
                content: "Entra Auth Cli Documentation linkWelcome to the comprehensive documentation for Entra Auth Cli, a cross-platform tool for generating Microsoft Entra ID access tokens.\nGetting Started linkNew to Entra Auth Cli? Start here:\nInstallation - Install the tool on your platform Quick Start - Generate your first token in 5 minutes First Token Tutorial - Complete walkthrough Core Concepts linkUnderstand the fundamentals:\nAuthentication Profiles - What are profiles and how they work OAuth2 Flows - Understanding authentication flows Scopes \u0026 Resources - Managing API permissions Secure Storage - How secrets are protected User Guide linkDetailed guides for all features:\nManaging Profiles - Create, edit, delete, import/export Generating Tokens - Get tokens with different flows Working with Tokens - Inspect, refresh, manage tokens Reference linkComplete command reference and configuration:\nCommands - Full command-line reference Configuration - Profile schema and settings Environment Variables - Supported environment variables Need Help? link Check the Troubleshooting guide Review Common Errors Visit our GitHub Discussions "
            }
        );
    index.add(
            {
                id:  1 ,
                href: "\/docs\/getting-started\/",
                title: "Getting Started",
                description: "Get up and running with Entra Auth Cli",
                content: "Getting Started linkWelcome! This section will help you install Entra Auth Cli and generate your first token.\nWhat You’ll Learn link How to install the tool on your platform Creating your first authentication profile Generating and using access tokens Understanding the basics of OAuth2 flows Prerequisites linkBefore you begin, ensure you have:\n.NET Runtime (for global tool) or download self-contained executable Azure/Entra ID Account with access to app registrations App Registration (or permission to create one) Don’t have an app registration yet? No problem! The First Token Tutorial walks you through the complete setup.\nQuick Links link Installation Guide - Choose your installation method Quick Start - 5-minute guide to your first token Complete Tutorial - End-to-end walkthrough Next Steps link Install the tool → Follow the Quick Start guide Explore Core Concepts to understand how it works "
            }
        );
    index.add(
            {
                id:  2 ,
                href: "\/docs\/recipes\/microsoft-graph\/",
                title: "Microsoft Graph API",
                description: "Integrate with Microsoft Graph for user management, email, and more",
                content: "Microsoft Graph API linkLearn how to use Entra Auth Cli to authenticate and interact with Microsoft Graph API.\nOverview linkMicrosoft Graph is the unified API for Microsoft 365, providing access to:\nUsers and groups Mail and calendars Files (OneDrive/SharePoint) Teams and collaboration Security and compliance Base URL: https://graph.microsoft.com/v1.0/\nQuick Start linkSetup Profile link entra-auth-cli config create # Name: graph-readonly # Client ID: # Tenant ID: # Scope: https://graph.microsoft.com/User.Read Get Token and Call API link TOKEN=$(entra-auth-cli get-token -p graph-readonly --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me | jq Read User Profile linkRetrieve information about the authenticated user.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-readonly --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me | jq Required scope: User.Read\nList All Users linkRetrieve a list of users in your organization.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-admin --silent \\ --scope \"https://graph.microsoft.com/User.Read.All\") curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://graph.microsoft.com/v1.0/users?$select=displayName,mail,userPrincipalName' | jq Required scope: User.Read.All\nSend Email linkSend an email via Microsoft Graph.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-mail --silent \\ --scope \"https://graph.microsoft.com/Mail.Send\") curl -X POST \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d '{ \"message\": { \"subject\": \"Test Email\", \"body\": { \"contentType\": \"Text\", \"content\": \"This is a test email from Entra Auth Cli\" }, \"toRecipients\": [ { \"emailAddress\": { \"address\": \"user@contoso.com\" } } ] }, \"saveToSentItems\": \"true\" }' \\ https://graph.microsoft.com/v1.0/me/sendMail Required scope: Mail.Send\nList Calendar Events linkRetrieve calendar events for the authenticated user.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-calendar --silent \\ --scope \"https://graph.microsoft.com/Calendars.Read\") curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://graph.microsoft.com/v1.0/me/calendar/events?$select=subject,start,end' | jq Required scope: Calendars.Read\nCreate Calendar Event linkCreate a new calendar event.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-calendar --silent \\ --scope \"https://graph.microsoft.com/Calendars.ReadWrite\") curl -X POST \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d '{ \"subject\": \"Team Meeting\", \"body\": { \"contentType\": \"HTML\", \"content\": \"Discuss Q1 goals\" }, \"start\": { \"dateTime\": \"2024-01-15T14:00:00\", \"timeZone\": \"UTC\" }, \"end\": { \"dateTime\": \"2024-01-15T15:00:00\", \"timeZone\": \"UTC\" } }' \\ https://graph.microsoft.com/v1.0/me/calendar/events | jq Required scope: Calendars.ReadWrite\nCommon Scopes link Scope Permission Use Case User.Read Read user profile Basic user info User.Read.All Read all users Directory queries Mail.Read Read email Email client Mail.Send Send email Email automation Calendars.Read Read calendars Calendar sync Calendars.ReadWrite Modify calendars Event management Files.Read Read files Document access Files.ReadWrite Modify files File uploads Best Practices linkUse Specific Scopes link # Good: Specific scope entra-auth-cli get-token -p graph --scope \"https://graph.microsoft.com/User.Read\" # Avoid: .default in scripts (requests all consented permissions) entra-auth-cli get-token -p graph --scope \"https://graph.microsoft.com/.default\" Cache Tokens link #!/bin/bash TOKEN_CACHE=\"/tmp/graph-token.txt\" get_graph_token() { if [ -f \"$TOKEN_CACHE\" ] \u0026\u0026 entra-auth-cli discover -f \"$TOKEN_CACHE\" \u0026\u003e/dev/null; then cat \"$TOKEN_CACHE\" else entra-auth-cli get-token -p graph --silent | tee \"$TOKEN_CACHE\" chmod 600 \"$TOKEN_CACHE\" fi } TOKEN=$(get_graph_token) Handle Pagination link #!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-admin --silent) URL=\"https://graph.microsoft.com/v1.0/users\" while [ -n \"$URL\" ]; do response=$(curl -s -H \"Authorization: Bearer $TOKEN\" \"$URL\") # Process users echo \"$response\" | jq -r '.value[].displayName' # Get next page URL URL=$(echo \"$response\" | jq -r '.[\"@odata.nextLink\"] // empty') done Next Steps link Azure Management API CI/CD Integration Security Hardening Scopes \u0026 Permissions "
            }
        );
    index.add(
            {
                id:  3 ,
                href: "\/docs\/certificates\/overview\/",
                title: "Overview",
                description: "Introduction to certificate authentication",
                content: "Certificate Authentication Overview linkX.509 certificates provide a more secure alternative to client secrets for authenticating service principals with Microsoft Entra ID.\nAdvantages Over Client Secrets link Feature Client Secret Certificate Security Medium High Validity Period Up to 2 years Up to 3 years Rotation Manual Automated possible Compromise Risk Higher Lower Audit Trail Limited Better Storage Text-based PKI infrastructure Revocation Immediate Requires CRL/OCSP When to Use Certificates link✅ Use Certificates For: linkProduction Service Principals\nLong-running automated services High-security requirements Compliance requirements (SOC 2, HIPAA) Certificate-based infrastructure Enterprise Deployments\nOrganizations with PKI infrastructure Centralized certificate management Hardware security module (HSM) integration Certificate lifecycle management Regulated Industries\nFinancial services Healthcare (HIPAA) Government Critical infrastructure ⚠️ Use Client Secrets For: linkDevelopment and Testing\nQuick prototyping Local development Short-lived projects POC implementations Simple Automation\nPersonal scripts Internal tools Non-production workloads Limited scope applications Certificate Types linkPFX/PKCS12 Format linkMost common format for certificates with private keys\n# File extensions certificate.pfx certificate.p12 Contains:\nX.509 certificate (public key) Private key (encrypted) Optional: Certificate chain Password protected Supported by:\nWindows Certificate Store macOS Keychain File-based storage Most PKI systems PEM Format linkText-based format (not directly supported)\n# Separate files certificate.pem # Public key private-key.pem # Private key To use with Entra Auth Cli: Convert to PFX format:\nopenssl pkcs12 -export \\ -in certificate.pem \\ -inkey private-key.pem \\ -out certificate.pfx \\ -password pass:YourPassword Certificate vs Thumbprint linkFile-Based (Recommended)\nStore PFX file on disk Portable across systems Easier backup and restore Better for CI/CD Thumbprint-Based (Windows/macOS)\nReference certificate in system store Requires certificate import Better integration with OS Automatic key protection Security Benefits link1. Stronger Cryptography linkCertificates use asymmetric encryption (RSA 2048/4096-bit):\nPrivate key never leaves your system Only public key uploaded to Azure Cannot be guessed or brute-forced 2. Better Audit Trail linkCertificate operations are more traceable:\nCertificate serial numbers Issuer information Validity periods Usage timestamps 3. Reduced Compromise Risk linkIf certificate is compromised:\nCan be revoked via CRL/OCSP Clear expiration dates Hardware protection possible (HSM) Less likely to be accidentally exposed 4. Compliance-Friendly linkCertificates align with security standards:\nSOC 2 requirements HIPAA compliance PCI-DSS standards ISO 27001 controls How Certificate Authentication Works linkFlow Diagram link 1. Client → Generates JWT assertion signed with private key 2. Client → Sends assertion to Azure AD 3. Azure AD → Verifies signature using public key from app registration 4. Azure AD → Issues access token 5. Client → Uses access token to call API Detailed Steps link1. Certificate Configuration\nPrivate key stored securely on client Public key uploaded to Azure app registration Certificate thumbprint recorded 2. Token Request\nClient creates JWT assertion Signs assertion with private key Includes certificate thumbprint in header 3. Azure Verification\nAzure retrieves public key by thumbprint Verifies JWT signature Checks certificate validity Validates app permissions 4. Token Issuance\nAzure issues access token Token contains claims and scopes Valid for 1 hour (default) Certificate Lifecycle link1. Creation link Generate key pair (public + private) Create certificate signing request (CSR) Sign certificate (self-signed or CA) 2. Registration link Upload public key to Azure app registration Record certificate thumbprint Configure permissions 3. Usage link Store private key securely Configure application profiles Generate access tokens 4. Rotation link Generate new certificate Upload to Azure (keep old active) Update applications Remove old certificate 5. Revocation link Revoke if compromised Update CRL/OCSP Replace with new certificate Comparison with Other Auth Methods linkCertificate vs Client Secret link Aspect Certificate Client Secret Setup Complexity Higher Lower Security Stronger Weaker Rotation More complex Simpler Best For Production Development Certificate vs Managed Identity link Aspect Certificate Managed Identity Azure-Only No Yes Setup Manual Automatic Management Self-managed Azure-managed Best For Hybrid/On-prem Azure resources Certificate vs Interactive Auth link Aspect Certificate Interactive Auth User Interaction None Required Automation Yes No Delegated Permissions No Yes Best For Services User applications Next Steps link Creating Certificates - Generate self-signed or CA certificates Registering in Azure - Upload to app registrations Configuring Profiles - Set up certificate authentication Certificate Storage - Secure storage options "
            }
        );
    index.add(
            {
                id:  4 ,
                href: "\/docs\/recipes\/azure-management\/",
                title: "Azure Management API",
                description: "Automate Azure resource management",
                content: "Azure Management API linkLearn how to use Entra Auth Cli to authenticate and manage Azure resources.\nOverview linkThe Azure Management API provides programmatic access to:\nSubscriptions and resource groups Virtual machines and networking Storage accounts and databases Azure services configuration Resource provisioning and monitoring Base URL: https://management.azure.com/\nQuick Start linkSetup Profile link entra-auth-cli config create # Name: azure-mgmt # Client ID: # Tenant ID: # Scope: https://management.azure.com/.default Get Token and Call API link TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://management.azure.com/subscriptions?api-version=2020-01-01' | jq List Subscriptions linkRetrieve all Azure subscriptions.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent \\ --scope \"https://management.azure.com/.default\") curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://management.azure.com/subscriptions?api-version=2020-01-01' | jq List Resource Groups linkList resource groups in a subscription.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) SUBSCRIPTION_ID=\"12345678-1234-1234-1234-123456789abc\" curl -H \"Authorization: Bearer $TOKEN\" \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/resourcegroups?api-version=2021-04-01\" | jq Create Resource Group linkCreate a new resource group.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) SUBSCRIPTION_ID=\"12345678-1234-1234-1234-123456789abc\" RESOURCE_GROUP=\"my-resource-group\" LOCATION=\"eastus\" curl -X PUT \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d '{ \"location\": \"'$LOCATION'\" }' \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/resourceGroups/$RESOURCE_GROUP?api-version=2021-04-01\" | jq List Virtual Machines linkList all VMs in a resource group.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) SUBSCRIPTION_ID=\"12345678-1234-1234-1234-123456789abc\" RESOURCE_GROUP=\"my-rg\" curl -H \"Authorization: Bearer $TOKEN\" \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/resourceGroups/$RESOURCE_GROUP/providers/Microsoft.Compute/virtualMachines?api-version=2021-03-01\" | jq Create Virtual Machine linkCreate a new virtual machine.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-admin --silent) SUBSCRIPTION_ID=\"...\" RESOURCE_GROUP=\"my-rg\" VM_NAME=\"my-vm\" curl -X PUT \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d @vm-config.json \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/resourceGroups/$RESOURCE_GROUP/providers/Microsoft.Compute/virtualMachines/$VM_NAME?api-version=2021-03-01\" vm-config.json:\n{ \"location\": \"eastus\", \"properties\": { \"hardwareProfile\": { \"vmSize\": \"Standard_B1s\" }, \"storageProfile\": { \"imageReference\": { \"publisher\": \"Canonical\", \"offer\": \"UbuntuServer\", \"sku\": \"18.04-LTS\", \"version\": \"latest\" } }, \"osProfile\": { \"computerName\": \"my-vm\", \"adminUsername\": \"azureuser\", \"adminPassword\": \"P@ssw0rd123!\" }, \"networkProfile\": { \"networkInterfaces\": [ { \"id\": \"/subscriptions/.../networkInterfaces/my-nic\" } ] } } } List Storage Accounts linkList storage accounts in a subscription.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) SUBSCRIPTION_ID=\"12345678-1234-1234-1234-123456789abc\" curl -H \"Authorization: Bearer $TOKEN\" \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/providers/Microsoft.Storage/storageAccounts?api-version=2021-04-01\" | jq Best Practices linkUse Service Principal linkFor automation, use a service principal with appropriate RBAC roles:\n# Create service principal az ad sp create-for-rbac --name \"entra-auth-cli-automation\" \\ --role \"Contributor\" \\ --scopes \"/subscriptions/YOUR_SUBSCRIPTION_ID\" # Configure profile entra-auth-cli config create # Client ID: # Client Secret: # Tenant ID: # Scope: https://management.azure.com/.default Limit Permissions linkAssign minimum required roles:\nReader: List resources only Contributor: Manage resources Owner: Full control (avoid if possible) Handle Long-Running Operations link #!/bin/bash TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) # Start operation response=$(curl -X PUT \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d @resource-config.json \\ \"https://management.azure.com/...\") # Get operation status URL status_url=$(echo \"$response\" | jq -r '.properties.provisioningState') # Poll until complete while true; do status=$(curl -s -H \"Authorization: Bearer $TOKEN\" \"$status_url\") state=$(echo \"$status\" | jq -r '.status') if [ \"$state\" = \"Succeeded\" ]; then echo \"Operation completed\" break elif [ \"$state\" = \"Failed\" ]; then echo \"Operation failed\" exit 1 fi sleep 10 done Next Steps link Microsoft Graph API CI/CD Integration Security Hardening OAuth2 Flows "
            }
        );
    index.add(
            {
                id:  5 ,
                href: "\/docs\/core-concepts\/",
                title: "Core Concepts",
                description: "Understand the fundamentals of Entra Auth Cli",
                content: "Core Concepts linkUnderstanding these fundamental concepts will help you use Entra Auth Cli effectively.\nKey Topics linkAuthentication Profiles linkLearn what profiles are, how they work, and why they’re useful for managing multiple authentication scenarios.\nOAuth2 Flows linkUnderstand the four OAuth2 authentication flows supported by the tool and when to use each one.\nScopes \u0026 Resources linkMaster how scopes define API permissions and learn common scope patterns for Microsoft Graph and custom APIs.\nSecure Storage linkDiscover how secrets are protected on each platform and understand the security model.\nQuick Overview linkProfiles store your authentication configuration (tenant, client ID, credentials) so you don’t have to enter them repeatedly.\nOAuth2 Flows determine how authentication happens - some require user interaction, others are fully automated.\nScopes specify what resources and permissions your token will have access to.\nSecure Storage keeps your secrets safe using platform-native encryption (DPAPI on Windows, Keychain on macOS).\nNext Steps linkStart with Authentication Profiles to understand the foundation of how the tool works.\n"
            }
        );
    index.add(
            {
                id:  6 ,
                href: "\/docs\/certificates\/creating\/",
                title: "Creating Certificates",
                description: "Generate self-signed and CA-signed certificates",
                content: "Creating Certificates linkLearn how to generate X.509 certificates for authentication with Microsoft Entra ID.\nSelf-Signed Certificates linkFor Development/Testing Only link⚠️ Warning: Self-signed certificates should only be used for development and testing. Use CA-signed certificates for production.\nWindows (PowerShell) link # Generate self-signed certificate $cert = New-SelfSignedCertificate ` -Subject \"CN=MyApp Dev Certificate\" ` -CertStoreLocation \"Cert:\\CurrentUser\\My\" ` -KeyExportPolicy Exportable ` -KeySpec Signature ` -KeyLength 4096 ` -KeyAlgorithm RSA ` -HashAlgorithm SHA256 ` -NotAfter (Get-Date).AddYears(2) # Export to PFX with password $password = ConvertTo-SecureString -String \"YourStrongPassword123!\" -Force -AsPlainText $pfxPath = \"$env:USERPROFILE\\Documents\\certificate.pfx\" Export-PfxCertificate -Cert $cert -FilePath $pfxPath -Password $password Write-Host \"Certificate created: $pfxPath\" Write-Host \"Thumbprint: $($cert.Thumbprint)\" macOS / Linux link # Generate private key and certificate openssl req -x509 -newkey rsa:4096 \\ -keyout key.pem \\ -out cert.pem \\ -days 730 \\ -nodes \\ -subj \"/CN=MyApp Dev Certificate/O=My Organization/C=US\" # Convert to PFX format openssl pkcs12 -export \\ -in cert.pem \\ -inkey key.pem \\ -out certificate.pfx \\ -password pass:YourStrongPassword123! echo \"Certificate created: certificate.pfx\" # Display certificate info openssl x509 -in cert.pem -text -noout With Subject Alternative Names (SAN) link # Create OpenSSL config file cat \u003e cert.conf \u003c"
            }
        );
    index.add(
            {
                id:  7 ,
                href: "\/docs\/recipes\/cicd-integration\/",
                title: "CI/CD Integration",
                description: "Integrate with GitHub Actions, Azure Pipelines, and other CI/CD platforms",
                content: "CI/CD Integration linkLearn how to integrate Entra Auth Cli into your CI/CD pipelines for automated authentication.\nGitHub Actions linkBasic Example link name: Deploy on: [push] jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Install Entra Auth Cli run: | dotnet tool install --global EntraAuthCli - name: Create Profile env: CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }} TENANT_ID: ${{ secrets.AZURE_TENANT_ID }} CLIENT_SECRET: ${{ secrets.AZURE_CLIENT_SECRET }} run: | # Create profile non-interactively cat \u003e profile.json \u003c"
            }
        );
    index.add(
            {
                id:  8 ,
                href: "\/docs\/certificates\/registering\/",
                title: "Registering in Azure",
                description: "Upload certificates to Azure app registrations",
                content: "Registering Certificates in Azure linkLearn how to upload and manage certificates in Azure app registrations.\nPrerequisites linkBefore registering a certificate:\n✅ Certificate created (PFX format) ✅ Azure app registration exists ✅ Appropriate permissions in Azure AD Upload Certificate linkVia Azure Portal link1. Navigate to App Registration\nSign in to Azure Portal Navigate to Azure Active Directory Select App registrations Find and select your application 2. Access Certificates \u0026 Secrets\nIn the left menu, select Certificates \u0026 secrets Click the Certificates tab 3. Upload Certificate\nClick Upload certificate Click Select a file Select your .cer or .pem file (public key only) Add a description (e.g., “Production Certificate 2024”) Click Add 4. Verify Upload\nCertificate appears in the list Note the thumbprint Check expiration date Extract Public Key from PFX linkAzure requires only the public key (.cer or .pem), not the private key.\nmacOS / Linux:\n# Extract public key from PFX openssl pkcs12 -in certificate.pfx \\ -clcerts -nokeys \\ -out certificate.cer \\ -passin pass:YourPassword # Verify extraction openssl x509 -in certificate.cer -text -noout Windows (PowerShell):\n# Extract public key $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2(\"certificate.pfx\", \"YourPassword\") $bytes = $cert.Export([System.Security.Cryptography.X509Certificates.X509ContentType]::Cert) [System.IO.File]::WriteAllBytes(\"certificate.cer\", $bytes) # Verify certutil -dump certificate.cer Via Azure CLI linkUpload Certificate link # Login to Azure az login # Upload certificate (using .cer file) az ad app credential reset \\ --id \\ --cert @certificate.cer \\ --append # Or create from PFX (extracts public key automatically) az ad app credential reset \\ --id \\ --cert @certificate.pfx \\ --append List Certificates link # List all credentials for app az ad app credential list \\ --id # Filter for certificates only az ad app credential list \\ --id \\ --query \"[?type=='AsymmetricX509Cert']\" Delete Certificate link # Delete by key ID az ad app credential delete \\ --id \\ --key-id Via PowerShell (AzureAD Module) linkUpload Certificate link # Install module if needed Install-Module AzureAD # Connect Connect-AzureAD # Load certificate $certPath = \"C:\\path\\to\\certificate.cer\" $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2($certPath) # Upload to app $appObjectId = \"\" New-AzureADApplicationKeyCredential ` -ObjectId $appObjectId ` -CustomKeyIdentifier \"Production Cert 2024\" ` -Type AsymmetricX509Cert ` -Usage Verify ` -Value $cert.GetRawCertData() List Certificates link # Get app $app = Get-AzureADApplication -ObjectId \"\" # List key credentials (certificates) $app.KeyCredentials | Format-Table CustomKeyIdentifier, KeyId, EndDate Verify Certificate Registration linkCheck Thumbprint linkAzure Portal:\nApp registrations → Your app → Certificates \u0026 secrets Find your certificate Note the thumbprint value Compare with local certificate:\n# macOS/Linux openssl pkcs12 -in certificate.pfx \\ -nokeys -passin pass:YourPassword | \\ openssl x509 -noout -fingerprint -sha1 # Windows (PowerShell) $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2(\"certificate.pfx\", \"YourPassword\") $cert.Thumbprint Test Authentication link # Create test profile with certificate entra-auth-cli config create # Name: cert-test # Client ID: # Tenant ID: # Auth method: Certificate # Path: /path/to/certificate.pfx # Password: **** # Test token generation entra-auth-cli get-token -p cert-test # If successful, certificate is properly registered Multiple Certificates linkWhy Use Multiple Certificates? link Rotation: Add new certificate before removing old one Environments: Separate certificates for dev/staging/prod Teams: Different certificates for different teams/services Compliance: Meet audit requirements for key rotation Managing Multiple Certificates linkAdd second certificate without removing first:\n# Azure CLI with --append flag az ad app credential reset \\ --id \\ --cert @new-certificate.cer \\ --append # Note: Without --append, existing credentials are replaced Best practice naming:\nProduction-2024-Q1 Production-2024-Q2-Rotation Development-Team-A Development-Team-B Staging-Environment Certificate Metadata linkWhat Gets Stored in Azure? linkAzure stores these certificate properties:\nProperty Description Example CustomKeyIdentifier Your description “Prod Cert 2024” KeyId Unique identifier (GUID) “abc123…” Type Credential type AsymmetricX509Cert Usage Purpose Verify EndDate Expiration date 2025-12-31 StartDate Valid from date 2024-01-01 Value Public key bytes (binary data) Private Key Security link⚠️ Important:\nOnly the public key is uploaded to Azure The private key never leaves your system Azure cannot access your private key This is a key security feature Permissions Required linkTo Upload Certificates linkApplication Administrator role or:\nApplication.ReadWrite.All Application.ReadWrite.OwnedBy As app owner:\nAutomatic permission if you created the app No additional role needed Grant Permissions link # Grant user Application Administrator role az ad directory-role member add \\ --role \"Application Administrator\" \\ --member-id Troubleshooting link“Insufficient privileges” linkCause: Missing permissions to modify app registration\nSolution:\n# Check your roles az ad signed-in-user list-owned-applications # Or request Application Administrator role “Certificate validation failed” linkCause: Incorrect certificate format or corrupted file\nSolution:\n# Verify certificate is valid openssl x509 -in certificate.cer -text -noout # Re-extract from PFX openssl pkcs12 -in certificate.pfx -clcerts -nokeys -out certificate.cer “Certificate already exists” linkCause: Duplicate certificate (same public key)\nSolution:\nRemove old certificate first, or Use a different certificate Wrong certificate uploaded linkSolution:\n# Remove incorrect certificate az ad app credential delete \\ --id \\ --key-id # Upload correct certificate az ad app credential reset \\ --id \\ --cert @correct-certificate.cer \\ --append Automation linkAutomated Certificate Upload link #!/bin/bash set -euo pipefail APP_ID=\"\" CERT_FILE=\"certificate.pfx\" CERT_PASSWORD=\"YourPassword\" DESCRIPTION=\"Auto-uploaded $(date +%Y-%m-%d)\" # Extract public key openssl pkcs12 -in \"$CERT_FILE\" \\ -clcerts -nokeys \\ -out temp-cert.cer \\ -passin pass:$CERT_PASSWORD # Upload to Azure az ad app credential reset \\ --id \"$APP_ID\" \\ --cert @temp-cert.cer \\ --append # Clean up rm temp-cert.cer echo \"✓ Certificate uploaded successfully\" echo \" App ID: $APP_ID\" echo \" Description: $DESCRIPTION\" # Get thumbprint for verification THUMBPRINT=$(openssl pkcs12 -in \"$CERT_FILE\" \\ -nokeys -passin pass:$CERT_PASSWORD | \\ openssl x509 -noout -fingerprint -sha1 | \\ cut -d= -f2) echo \" Thumbprint: $THUMBPRINT\" Next Steps link Configuring Profiles - Set up certificate authentication Certificate Storage - Secure storage options Using Certificates - Generate tokens Certificate Rotation - Rotate certificates safely "
            }
        );
    index.add(
            {
                id:  9 ,
                href: "\/docs\/recipes\/bash-scripts\/",
                title: "Bash Scripting",
                description: "Shell scripting patterns and best practices",
                content: "Bash Scripting linkLearn how to use Entra Auth Cli in Bash scripts with proper error handling, caching, and best practices.\nToken Caching linkImplement token caching to improve performance and reduce authentication requests.\n#!/bin/bash set -euo pipefail TOKEN_CACHE=\"/tmp/entra-auth-cli-token-cache.txt\" TOKEN_MAX_AGE=3000 # 50 minutes get_token() { local profile=$1 # Check if cached token exists and is valid if [ -f \"$TOKEN_CACHE\" ]; then if entra-auth-cli discover -f \"$TOKEN_CACHE\" \u0026\u003e/dev/null; then cat \"$TOKEN_CACHE\" return 0 fi fi # Get fresh token entra-auth-cli get-token -p \"$profile\" --silent | tee \"$TOKEN_CACHE\" chmod 600 \"$TOKEN_CACHE\" } # Use it TOKEN=$(get_token \"my-profile\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com Error Handling linkImplement robust error handling with retries.\n#!/bin/bash set -euo pipefail get_token_with_retry() { local profile=$1 local max_retries=3 local retry=0 while [ $retry -lt $max_retries ]; do if TOKEN=$(entra-auth-cli get-token -p \"$profile\" --silent 2\u003e\u00261); then echo \"$TOKEN\" return 0 fi echo \"Retry $((retry + 1))/$max_retries...\" \u003e\u00262 retry=$((retry + 1)) sleep 5 done echo \"Failed to get token after $max_retries attempts\" \u003e\u00262 return 1 } # Use it if TOKEN=$(get_token_with_retry \"my-profile\"); then curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com else echo \"Fatal: Could not acquire token\" exit 1 fi Multi-API Script linkWork with multiple APIs using different tokens.\n#!/bin/bash set -euo pipefail # Get tokens for different APIs GRAPH_TOKEN=$(entra-auth-cli get-token -p graph-profile --silent) AZURE_TOKEN=$(entra-auth-cli get-token -p azure-profile --silent) # Use Graph API echo \"Fetching user profile...\" USER=$(curl -s -H \"Authorization: Bearer $GRAPH_TOKEN\" \\ https://graph.microsoft.com/v1.0/me) USER_ID=$(echo \"$USER\" | jq -r .id) echo \"User ID: $USER_ID\" # Use Azure Management API echo \"Fetching subscriptions...\" SUBS=$(curl -s -H \"Authorization: Bearer $AZURE_TOKEN\" \\ 'https://management.azure.com/subscriptions?api-version=2020-01-01') echo \"$SUBS\" | jq -r '.value[].displayName' Conditional Token Refresh linkOnly refresh tokens when necessary.\n#!/bin/bash get_valid_token() { local profile=$1 local token_file=\"/tmp/token-$profile.txt\" local min_validity=300 # 5 minutes # Check if token exists if [ -f \"$token_file\" ]; then # Check expiration exp=$(entra-auth-cli inspect -f \"$token_file\" 2\u003e/dev/null | jq -r .payload.exp) now=$(date +%s) remaining=$(( exp - now )) if [ $remaining -gt $min_validity ]; then # Token still valid cat \"$token_file\" return 0 fi fi # Get fresh token entra-auth-cli get-token -p \"$profile\" --silent | tee \"$token_file\" chmod 600 \"$token_file\" } TOKEN=$(get_valid_token \"my-profile\") Parallel API Calls linkMake multiple API calls concurrently.\n#!/bin/bash # Get token once TOKEN=$(entra-auth-cli get-token -p my-profile --silent) # Parallel API calls { curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me \u003e user.json \u0026 curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me/messages \u003e messages.json \u0026 curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me/calendars \u003e calendars.json \u0026 } # Wait for all to complete wait echo \"All API calls completed\" Secure Token Storage linkUse secure temporary files for token storage.\n#!/bin/bash set -euo pipefail # Use secure temp file TOKEN_FILE=$(mktemp) trap \"rm -f $TOKEN_FILE\" EXIT # Get token with restricted permissions entra-auth-cli get-token -p my-profile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" # Use token TOKEN=$(cat \"$TOKEN_FILE\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com # File automatically deleted on exit API Rate Limiting linkHandle API rate limiting with exponential backoff.\n#!/bin/bash call_api_with_rate_limit() { local url=$1 local token=$2 local max_retries=5 local retry=0 while [ $retry -lt $max_retries ]; do response=$(curl -s -w \"\\n%{http_code}\" \\ -H \"Authorization: Bearer $token\" \\ \"$url\") http_code=$(echo \"$response\" | tail -n1) body=$(echo \"$response\" | sed '$d') if [ \"$http_code\" = \"200\" ]; then echo \"$body\" return 0 elif [ \"$http_code\" = \"429\" ]; then # Rate limited, wait and retry echo \"Rate limited, waiting...\" \u003e\u00262 sleep $(( 2 ** retry )) retry=$((retry + 1)) else echo \"Error: HTTP $http_code\" \u003e\u00262 echo \"$body\" \u003e\u00262 return 1 fi done echo \"Max retries exceeded\" \u003e\u00262 return 1 } TOKEN=$(entra-auth-cli get-token -p my-profile --silent) call_api_with_rate_limit \"https://graph.microsoft.com/v1.0/users\" \"$TOKEN\" Pagination linkHandle paginated API responses.\n#!/bin/bash TOKEN=$(entra-auth-cli get-token -p graph-admin --silent) URL=\"https://graph.microsoft.com/v1.0/users\" while [ -n \"$URL\" ]; do response=$(curl -s -H \"Authorization: Bearer $TOKEN\" \"$URL\") # Process users echo \"$response\" | jq -r '.value[].displayName' # Get next page URL URL=$(echo \"$response\" | jq -r '.[\"@odata.nextLink\"] // empty') done Complete Example Script linkA production-ready script combining multiple patterns.\n#!/bin/bash set -euo pipefail # Configuration PROFILE=\"my-profile\" TOKEN_CACHE=\"/tmp/entra-auth-cli-${PROFILE}.token\" LOG_FILE=\"/var/log/my-script.log\" # Logging function log() { echo \"[$(date +'%Y-%m-%d %H:%M:%S')] $*\" | tee -a \"$LOG_FILE\" } # Get cached or fresh token get_token() { if [ -f \"$TOKEN_CACHE\" ]; then if entra-auth-cli discover -f \"$TOKEN_CACHE\" \u0026\u003e/dev/null; then cat \"$TOKEN_CACHE\" return 0 fi fi entra-auth-cli get-token -p \"$PROFILE\" --silent | tee \"$TOKEN_CACHE\" chmod 600 \"$TOKEN_CACHE\" } # Call API with error handling call_api() { local url=$1 local token=$2 response=$(curl -s -w \"\\n%{http_code}\" \\ -H \"Authorization: Bearer $token\" \\ \"$url\") http_code=$(echo \"$response\" | tail -n1) body=$(echo \"$response\" | sed '$d') if [ \"$http_code\" = \"200\" ]; then echo \"$body\" return 0 else log \"ERROR: API call failed with HTTP $http_code\" return 1 fi } # Main main() { log \"Starting script...\" # Get token if ! TOKEN=$(get_token); then log \"FATAL: Could not get token\" exit 1 fi # Call API if result=$(call_api \"https://graph.microsoft.com/v1.0/me\" \"$TOKEN\"); then log \"SUCCESS: API call completed\" echo \"$result\" | jq else log \"FATAL: API call failed\" exit 1 fi log \"Script completed successfully\" } main \"$@\" Best Practices linkAlways Use set -euo pipefail link #!/bin/bash set -euo pipefail # Exit on error, undefined var, pipe failure Use Silent Mode for Scripts link TOKEN=$(entra-auth-cli get-token -p my-profile --silent) # vs TOKEN=$(entra-auth-cli get-token -p my-profile) # May include extra output Secure Token Storage link # Good: Restricted permissions chmod 600 token.txt # Bad: World readable chmod 644 token.txt Clean Up Temporary Files link # Use trap to ensure cleanup TOKEN_FILE=$(mktemp) trap \"rm -f $TOKEN_FILE\" EXIT Next Steps link PowerShell Scripting Security Hardening Common Patterns "
            }
        );
    index.add(
            {
                id:  10 ,
                href: "\/docs\/recipes\/powershell-scripts\/",
                title: "PowerShell Scripting",
                description: "PowerShell integration patterns for Windows automation",
                content: "PowerShell Scripting linkLearn how to integrate Entra Auth Cli with PowerShell for Windows automation and Azure management.\nBasic Token Retrieval link # Get token $token = entra-auth-cli get-token -p my-profile --silent # Use with Invoke-RestMethod $headers = @{ \"Authorization\" = \"Bearer $token\" \"Content-Type\" = \"application/json\" } $response = Invoke-RestMethod ` -Uri \"https://graph.microsoft.com/v1.0/me\" ` -Headers $headers ` -Method Get $response | ConvertTo-Json Token Caching linkImplement token caching for better performance.\n$tokenCache = \"$env:TEMP\\entra-auth-cli-token.txt\" $tokenMaxAge = 3000 # 50 minutes function Get-CachedToken { param([string]$Profile) # Check if cached token is valid if (Test-Path $tokenCache) { entra-auth-cli discover -f $tokenCache 2\u003e$null if ($LASTEXITCODE -eq 0) { return Get-Content $tokenCache -Raw } } # Get fresh token $token = entra-auth-cli get-token -p $Profile --silent $token | Out-File -FilePath $tokenCache -NoNewline return $token } # Use it $token = Get-CachedToken -Profile \"my-profile\" Error Handling linkImplement robust error handling with retries.\nfunction Get-TokenWithRetry { param( [string]$Profile, [int]$MaxRetries = 3 ) for ($i = 0; $i -lt $MaxRetries; $i++) { try { $token = entra-auth-cli get-token -p $Profile --silent 2\u003e\u00261 if ($LASTEXITCODE -eq 0) { return $token } } catch { Write-Warning \"Retry $($i + 1)/$MaxRetries...\" Start-Sleep -Seconds 5 } } throw \"Failed to get token after $MaxRetries attempts\" } # Use it try { $token = Get-TokenWithRetry -Profile \"my-profile\" # Use token... } catch { Write-Error \"Fatal: Could not acquire token\" exit 1 } Multi-API Script linkWork with multiple APIs using different tokens.\n# Get tokens for different APIs $graphToken = entra-auth-cli get-token -p graph-profile --silent $azureToken = entra-auth-cli get-token -p azure-profile --silent # Use Graph API Write-Host \"Fetching user profile...\" $graphHeaders = @{ \"Authorization\" = \"Bearer $graphToken\" } $user = Invoke-RestMethod ` -Uri \"https://graph.microsoft.com/v1.0/me\" ` -Headers $graphHeaders Write-Host \"User: $($user.displayName)\" # Use Azure Management API Write-Host \"Fetching subscriptions...\" $azureHeaders = @{ \"Authorization\" = \"Bearer $azureToken\" } $subs = Invoke-RestMethod ` -Uri \"https://management.azure.com/subscriptions?api-version=2020-01-01\" ` -Headers $azureHeaders $subs.value | ForEach-Object { Write-Host $_.displayName } Conditional Token Refresh linkOnly refresh tokens when necessary.\nfunction Get-ValidToken { param([string]$Profile) $tokenFile = \"$env:TEMP\\token-$Profile.txt\" $minValidity = 300 # 5 minutes # Check if token exists if (Test-Path $tokenFile) { # Check expiration $tokenJson = entra-auth-cli inspect -f $tokenFile 2\u003e$null | ConvertFrom-Json if ($tokenJson) { $exp = $tokenJson.payload.exp $now = [DateTimeOffset]::Now.ToUnixTimeSeconds() $remaining = $exp - $now if ($remaining -gt $minValidity) { return Get-Content $tokenFile -Raw } } } # Get fresh token $token = entra-auth-cli get-token -p $Profile --silent $token | Out-File -FilePath $tokenFile -NoNewline return $token } $token = Get-ValidToken -Profile \"my-profile\" Parallel API Calls linkMake multiple API calls concurrently using PowerShell jobs.\n# Get token once $token = entra-auth-cli get-token -p my-profile --silent $headers = @{ \"Authorization\" = \"Bearer $token\" } # Start parallel jobs $jobs = @() $jobs += Start-Job -ScriptBlock { param($headers) Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/me\" -Headers $headers } -ArgumentList $headers $jobs += Start-Job -ScriptBlock { param($headers) Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/me/messages\" -Headers $headers } -ArgumentList $headers $jobs += Start-Job -ScriptBlock { param($headers) Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/me/calendars\" -Headers $headers } -ArgumentList $headers # Wait for all jobs and get results $results = $jobs | Wait-Job | Receive-Job $jobs | Remove-Job Write-Host \"All API calls completed\" $results | ForEach-Object { $_ | ConvertTo-Json } API Pagination linkHandle paginated API responses.\n$token = entra-auth-cli get-token -p graph-admin --silent $headers = @{ \"Authorization\" = \"Bearer $token\" } $url = \"https://graph.microsoft.com/v1.0/users\" while ($url) { $response = Invoke-RestMethod -Uri $url -Headers $headers # Process users $response.value | ForEach-Object { Write-Host $_.displayName } # Get next page URL $url = $response.'@odata.nextLink' } Rate Limiting linkHandle API rate limiting with exponential backoff.\nfunction Invoke-ApiWithRateLimit { param( [string]$Uri, [hashtable]$Headers, [int]$MaxRetries = 5 ) for ($retry = 0; $retry -lt $MaxRetries; $retry++) { try { $response = Invoke-WebRequest -Uri $Uri -Headers $Headers -Method Get return $response.Content | ConvertFrom-Json } catch { if ($_.Exception.Response.StatusCode -eq 429) { $waitTime = [Math]::Pow(2, $retry) Write-Warning \"Rate limited, waiting $waitTime seconds...\" Start-Sleep -Seconds $waitTime } else { throw } } } throw \"Max retries exceeded\" } $token = entra-auth-cli get-token -p my-profile --silent $headers = @{ \"Authorization\" = \"Bearer $token\" } $result = Invoke-ApiWithRateLimit -Uri \"https://graph.microsoft.com/v1.0/users\" -Headers $headers Complete Example Script linkProduction-ready script with logging and error handling.\n#Requires -Version 5.1 [CmdletBinding()] param( [Parameter(Mandatory=$true)] [string]$Profile, [Parameter(Mandatory=$false)] [string]$LogFile = \"$env:TEMP\\my-script.log\" ) # Logging function function Write-Log { param([string]$Message) $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\" \"$timestamp - $Message\" | Tee-Object -FilePath $LogFile -Append } # Get cached or fresh token function Get-Token { param([string]$Profile) $tokenCache = \"$env:TEMP\\entra-auth-cli-$Profile.token\" if (Test-Path $tokenCache) { entra-auth-cli discover -f $tokenCache 2\u003e$null if ($LASTEXITCODE -eq 0) { return Get-Content $tokenCache -Raw } } $token = entra-auth-cli get-token -p $Profile --silent $token | Out-File -FilePath $tokenCache -NoNewline return $token } # Call API with error handling function Invoke-Api { param( [string]$Uri, [string]$Token ) $headers = @{ \"Authorization\" = \"Bearer $Token\" } try { $response = Invoke-RestMethod -Uri $Uri -Headers $headers -Method Get return $response } catch { Write-Log \"ERROR: API call failed - $_\" throw } } # Main try { Write-Log \"Starting script...\" # Get token $token = Get-Token -Profile $Profile if (-not $token) { Write-Log \"FATAL: Could not get token\" exit 1 } # Call API $result = Invoke-Api -Uri \"https://graph.microsoft.com/v1.0/me\" -Token $token Write-Log \"SUCCESS: API call completed\" $result | ConvertTo-Json | Write-Host Write-Log \"Script completed successfully\" } catch { Write-Log \"FATAL: $_\" exit 1 } Best Practices linkUse Strict Mode link Set-StrictMode -Version Latest $ErrorActionPreference = \"Stop\" Use Silent Mode link # Good $token = entra-auth-cli get-token -p my-profile --silent # Bad (may include extra output) $token = entra-auth-cli get-token -p my-profile Secure Token Storage link # Restrict file permissions $acl = Get-Acl $tokenFile $acl.SetAccessRuleProtection($true, $false) $rule = New-Object System.Security.AccessControl.FileSystemAccessRule( $env:USERNAME, \"FullControl\", \"Allow\" ) $acl.AddAccessRule($rule) Set-Acl $tokenFile $acl Check Exit Codes link entra-auth-cli get-token -p my-profile --silent if ($LASTEXITCODE -ne 0) { Write-Error \"Token generation failed\" exit 1 } Next Steps link Bash Scripting Security Hardening CI/CD Integration "
            }
        );
    index.add(
            {
                id:  11 ,
                href: "\/docs\/recipes\/security-hardening\/",
                title: "Security Hardening",
                description: "Production security best practices and hardening guidelines",
                content: "Security Hardening linkLearn how to secure your Entra Auth Cli deployments for production environments.\nSecure Token Storage linkUse Temporary Files with Restricted Permissions link #!/bin/bash set -euo pipefail # Use secure temp file TOKEN_FILE=$(mktemp) trap \"rm -f $TOKEN_FILE\" EXIT # Get token with restricted permissions entra-auth-cli get-token -p my-profile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" # Use token TOKEN=$(cat \"$TOKEN_FILE\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com # File automatically deleted on exit Never Log Tokens link # Bad: Token in logs echo \"Token: $TOKEN\" logger \"Using token: $TOKEN\" # Good: Redact sensitive data echo \"Token acquired successfully\" logger \"Authentication completed\" Profile Separation linkEnvironment-Specific Profiles linkCreate separate profiles for each environment:\n# Development entra-auth-cli config create # Name: dev-graph # Client ID: # Tenant ID: # Scope: https://graph.microsoft.com/User.Read # Staging entra-auth-cli config create # Name: staging-graph # Client ID: # Tenant ID: # Scope: https://graph.microsoft.com/User.Read # Production entra-auth-cli config create # Name: prod-graph # Client ID: # Tenant ID: # Scope: https://graph.microsoft.com/.default Never Mix Environments link # Good: Clear environment separation entra-auth-cli get-token -p dev-graph # Development entra-auth-cli get-token -p prod-graph # Production # Bad: Shared profiles across environments entra-auth-cli get-token -p shared-graph # Risk of production data exposure Secret Rotation linkRegular Rotation Schedule link #!/bin/bash rotate_secret() { local profile=$1 local new_secret=$2 echo \"Rotating secret for profile: $profile\" # Update profile with new secret entra-auth-cli config edit -p \"$profile\" \u003c"
            }
        );
    index.add(
            {
                id:  12 ,
                href: "\/docs\/recipes\/common-patterns\/",
                title: "Common Patterns",
                description: "Frequently used patterns and techniques",
                content: "Common Patterns linkFrequently used patterns and techniques for working with Entra Auth Cli.\nPattern: API Rate Limiting linkHandle API rate limiting with exponential backoff.\n#!/bin/bash call_api_with_rate_limit() { local url=$1 local token=$2 local max_retries=5 local retry=0 while [ $retry -lt $max_retries ]; do response=$(curl -s -w \"\\n%{http_code}\" \\ -H \"Authorization: Bearer $token\" \\ \"$url\") http_code=$(echo \"$response\" | tail -n1) body=$(echo \"$response\" | sed '$d') if [ \"$http_code\" = \"200\" ]; then echo \"$body\" return 0 elif [ \"$http_code\" = \"429\" ]; then # Rate limited, wait and retry wait_time=$(( 2 ** retry )) echo \"Rate limited, waiting $wait_time seconds...\" \u003e\u00262 sleep $wait_time retry=$((retry + 1)) else echo \"Error: HTTP $http_code\" \u003e\u00262 echo \"$body\" \u003e\u00262 return 1 fi done echo \"Max retries exceeded\" \u003e\u00262 return 1 } # Usage TOKEN=$(entra-auth-cli get-token -p my-profile --silent) call_api_with_rate_limit \"https://graph.microsoft.com/v1.0/users\" \"$TOKEN\" Pattern: Parallel API Calls linkMake multiple API calls concurrently for better performance.\n#!/bin/bash # Get token once TOKEN=$(entra-auth-cli get-token -p my-profile --silent) # Parallel API calls { curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me \u003e user.json \u0026 curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me/messages \u003e messages.json \u0026 curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me/calendars \u003e calendars.json \u0026 } # Wait for all to complete wait echo \"All API calls completed\" Pattern: Conditional Token Refresh linkOnly refresh tokens when they’re close to expiration.\n#!/bin/bash get_valid_token() { local profile=$1 local token_file=\"/tmp/token-$profile.txt\" local min_validity=300 # 5 minutes # Check if token exists if [ -f \"$token_file\" ]; then # Check expiration exp=$(entra-auth-cli inspect -f \"$token_file\" 2\u003e/dev/null | jq -r .payload.exp) now=$(date +%s) remaining=$(( exp - now )) if [ $remaining -gt $min_validity ]; then # Token still valid cat \"$token_file\" return 0 fi fi # Get fresh token entra-auth-cli get-token -p \"$profile\" --silent | tee \"$token_file\" chmod 600 \"$token_file\" } # Usage TOKEN=$(get_valid_token \"my-profile\") Pattern: Batch API Requests linkProcess items in batches to avoid rate limits.\n#!/bin/bash process_batch() { local items=(\"$@\") local token=$(entra-auth-cli get-token -p my-profile --silent) local batch_size=20 for ((i=0; i\u003c${#items[@]}; i+=batch_size)); do batch=(\"${items[@]:i:batch_size}\") echo \"Processing batch $(( i / batch_size + 1))...\" for item in \"${batch[@]}\"; do curl -s -H \"Authorization: Bearer $token\" \\ \"https://api.example.com/items/$item\" \u0026 done # Wait for batch to complete wait # Rate limit pause between batches sleep 1 done } # Usage items=(item1 item2 item3 ... item100) process_batch \"${items[@]}\" Pattern: Circuit Breaker linkPrevent cascading failures with a circuit breaker pattern.\n#!/bin/bash FAILURE_THRESHOLD=5 TIMEOUT_SECONDS=60 FAILURE_COUNT=0 CIRCUIT_OPEN_UNTIL=0 call_api_with_circuit_breaker() { local url=$1 local token=$2 local now=$(date +%s) # Check if circuit is open if [ $now -lt $CIRCUIT_OPEN_UNTIL ]; then echo \"Circuit breaker open, skipping request\" \u003e\u00262 return 1 fi # Try API call response=$(curl -s -w \"\\n%{http_code}\" \\ -H \"Authorization: Bearer $token\" \\ \"$url\") http_code=$(echo \"$response\" | tail -n1) body=$(echo \"$response\" | sed '$d') if [ \"$http_code\" = \"200\" ]; then # Success: reset failure count FAILURE_COUNT=0 echo \"$body\" return 0 else # Failure: increment counter FAILURE_COUNT=$((FAILURE_COUNT + 1)) if [ $FAILURE_COUNT -ge $FAILURE_THRESHOLD ]; then # Open circuit CIRCUIT_OPEN_UNTIL=$((now + TIMEOUT_SECONDS)) echo \"Circuit breaker opened for $TIMEOUT_SECONDS seconds\" \u003e\u00262 fi return 1 fi } # Usage TOKEN=$(entra-auth-cli get-token -p my-profile --silent) call_api_with_circuit_breaker \"https://api.example.com/data\" \"$TOKEN\" Pattern: Request Deduplication linkPrevent duplicate requests with request hashing.\n#!/bin/bash declare -A REQUEST_CACHE call_api_deduplicated() { local url=$1 local token=$2 local cache_key=$(echo \"$url\" | md5sum | cut -d' ' -f1) # Check if request was recently made if [ -n \"${REQUEST_CACHE[$cache_key]}\" ]; then echo \"Using cached response for $url\" \u003e\u00262 echo \"${REQUEST_CACHE[$cache_key]}\" return 0 fi # Make request response=$(curl -s -H \"Authorization: Bearer $token\" \"$url\") # Cache response (with 5 minute TTL) REQUEST_CACHE[$cache_key]=\"$response\" # Schedule cache cleanup (background) (sleep 300; unset REQUEST_CACHE[$cache_key]) \u0026 echo \"$response\" } # Usage TOKEN=$(entra-auth-cli get-token -p my-profile --silent) call_api_deduplicated \"https://api.example.com/data\" \"$TOKEN\" call_api_deduplicated \"https://api.example.com/data\" \"$TOKEN\" # Uses cache Pattern: Retry with Jitter linkAdd randomness to retry delays to avoid thundering herd.\n#!/bin/bash call_api_with_jitter() { local url=$1 local token=$2 local max_retries=5 local base_delay=1 for retry in $(seq 0 $max_retries); do response=$(curl -s -w \"\\n%{http_code}\" \\ -H \"Authorization: Bearer $token\" \\ \"$url\") http_code=$(echo \"$response\" | tail -n1) body=$(echo \"$response\" | sed '$d') if [ \"$http_code\" = \"200\" ]; then echo \"$body\" return 0 fi if [ $retry -lt $max_retries ]; then # Calculate delay with exponential backoff and jitter delay=$(( base_delay * (2 ** retry) )) jitter=$(( RANDOM % delay )) wait_time=$(( delay + jitter )) echo \"Retry $((retry + 1))/$max_retries, waiting $wait_time seconds...\" \u003e\u00262 sleep $wait_time fi done echo \"Max retries exceeded\" \u003e\u00262 return 1 } # Usage TOKEN=$(entra-auth-cli get-token -p my-profile --silent) call_api_with_jitter \"https://api.example.com/data\" \"$TOKEN\" Pattern: Health Check linkImplement health checks for monitoring.\n#!/bin/bash health_check() { local profile=$1 local check_url=\"https://graph.microsoft.com/v1.0/me\" # Try to get token if ! token=$(entra-auth-cli get-token -p \"$profile\" --silent 2\u003e\u00261); then echo \"FAIL: Could not acquire token\" return 1 fi # Try to call API http_code=$(curl -s -w \"%{http_code}\" -o /dev/null \\ -H \"Authorization: Bearer $token\" \\ \"$check_url\") if [ \"$http_code\" = \"200\" ]; then echo \"OK: Profile $profile is healthy\" return 0 else echo \"FAIL: API call returned HTTP $http_code\" return 1 fi } # Usage if health_check \"my-profile\"; then echo \"System operational\" else echo \"System degraded\" # Send alert fi Pattern: Lazy Initialization linkDefer token acquisition until needed.\n#!/bin/bash TOKEN=\"\" PROFILE=\"my-profile\" get_token_lazy() { if [ -z \"$TOKEN\" ]; then echo \"Acquiring token...\" \u003e\u00262 TOKEN=$(entra-auth-cli get-token -p \"$PROFILE\" --silent) fi echo \"$TOKEN\" } # Token not acquired until first use echo \"Starting script...\" # First API call acquires token curl -H \"Authorization: Bearer $(get_token_lazy)\" \\ https://api.example.com/data1 # Second call reuses token curl -H \"Authorization: Bearer $(get_token_lazy)\" \\ https://api.example.com/data2 Pattern: Multi-Tenant Support linkHandle multiple Azure tenants in one script.\n#!/bin/bash call_multi_tenant_api() { local tenant=$1 local endpoint=$2 # Get token for specific tenant token=$(entra-auth-cli get-token -p \"tenant-$tenant\" --silent) # Call API curl -s -H \"Authorization: Bearer $token\" \"$endpoint\" } # Usage tenants=(\"contoso\" \"fabrikam\" \"adventureworks\") for tenant in \"${tenants[@]}\"; do echo \"Processing tenant: $tenant\" data=$(call_multi_tenant_api \"$tenant\" \"https://graph.microsoft.com/v1.0/users\") echo \"$data\" | jq done Pattern: Graceful Degradation linkProvide fallback behavior when authentication fails.\n#!/bin/bash get_data_with_fallback() { local use_cache=${1:-false} local cache_file=\"/tmp/data-cache.json\" # Try to get fresh data if token=$(entra-auth-cli get-token -p my-profile --silent 2\u003e/dev/null); then data=$(curl -s -H \"Authorization: Bearer $token\" \\ \"https://api.example.com/data\") # Cache successful response echo \"$data\" \u003e \"$cache_file\" echo \"$data\" return 0 fi # Authentication failed, try cache if [ -f \"$cache_file\" ]; then echo \"Using cached data (authentication unavailable)\" \u003e\u00262 cat \"$cache_file\" return 0 fi # No cache available echo \"Data unavailable\" \u003e\u00262 return 1 } # Usage get_data_with_fallback Next Steps link Microsoft Graph API Azure Management API Bash Scripting Security Hardening "
            }
        );
    index.add(
            {
                id:  13 ,
                href: "\/docs\/core-concepts\/profiles\/",
                title: "Authentication Profiles",
                description: "Understanding and managing authentication profiles",
                content: "Authentication Profiles linkProfiles are saved authentication configurations that store everything needed to generate tokens for a specific application or scenario.\nWhat is a Profile? linkA profile contains:\nProfile name: Unique identifier you choose Tenant ID: Your Azure/Entra ID tenant Client ID: Application (client) ID from app registration Scopes: API permissions to request (e.g., https://graph.microsoft.com/.default) Authentication method: How to authenticate (Client Secret, Certificate, or Passwordless Certificate) Credentials: Client secret or certificate path (stored securely) Default OAuth2 flow (optional): Preferred authentication flow Redirect URI (optional): Custom redirect for interactive flows Why Use Profiles? linkConvenience linkStore configuration once, reuse many times. No need to type tenant IDs and secrets repeatedly.\nSecurity linkCredentials are stored using platform-native secure storage, not in plain text files.\nOrganization linkManage multiple applications, environments, or tenants easily. Examples:\nprod-app-client dev-graph-api staging-custom-api Portability linkExport profiles (with encryption) to share with team members or move between machines.\nProfile Anatomy linkRequired Fields link name: myprofile tenantId: contoso.onmicrosoft.com clientId: 12345678-1234-1234-1234-123456789abc scopes: - https://graph.microsoft.com/.default authMethod: ClientSecret Optional Fields link defaultFlow: ClientCredentials # Auto-select flow redirectUri: http://localhost:8080 # For interactive flows certificatePath: /path/to/cert.pfx # For certificate auth cacheCertificatePassword: true # Cache cert password Profile Storage linkProfiles are stored in platform-specific locations:\nWindows: %APPDATA%\\entra-auth-cli\\profiles.json macOS/Linux: ~/.config/entra-auth-cli/profiles.json The profiles.json file contains metadata only - no secrets!\nExample profiles.json:\n{ \"profiles\": [ { \"name\": \"myprofile\", \"tenantId\": \"contoso.onmicrosoft.com\", \"clientId\": \"12345678-...\", \"scopes\": [\"https://graph.microsoft.com/.default\"], \"authMethod\": \"ClientSecret\", \"createdAt\": \"2025-12-26T10:00:00Z\", \"updatedAt\": \"2025-12-26T10:00:00Z\" } ] } Secret Storage linkSecrets (client secrets and certificate passwords) are stored separately using secure storage:\nWindows: Encrypted with DPAPI in %APPDATA%\\entra-auth-cli\\secure\\ macOS: Stored in Keychain (service: entra-auth-cli, account: entra-auth-cli:{profileName}:{secretType}) Linux: XOR-obfuscated in ~/.config/entra-auth-cli/secure/ ⚠️ Security Note: See Secure Storage for details about platform security.\nProfile Lifecycle link1. Create link entra-auth-cli config create Interactive prompts guide you through setup.\n2. Use link entra-auth-cli get-token -p myprofile Reference the profile by name when generating tokens.\n3. Update link entra-auth-cli config edit -p myprofile Modify settings or rotate credentials.\n4. Share link entra-auth-cli config export -p myprofile --include-secrets -o myprofile.enc Export with AES-256 encryption for team sharing.\n5. Delete link entra-auth-cli config delete -p myprofile Remove profile and associated secrets.\nCommon Profile Patterns linkService Principal for Azure Resources link Name: azure-prod-sp Tenant: contoso.onmicrosoft.com Client ID: [service principal client ID] Scopes: https://management.azure.com/.default Auth Method: ClientSecret Microsoft Graph API Access link Name: graph-api-client Tenant: contoso.onmicrosoft.com Client ID: [app registration client ID] Scopes: https://graph.microsoft.com/.default Auth Method: Certificate Certificate Path: /path/to/cert.pfx Custom API Access link Name: myapi-client Tenant: [tenant ID] Client ID: [client app ID] Scopes: api://[api-app-id]/.default Auth Method: ClientSecret Multi-Tenant Application link Name: multitenant-app Tenant: organizations # or 'common' Client ID: [app client ID] Scopes: https://graph.microsoft.com/User.Read Auth Method: InteractiveBrowser Profile Management Commands link Command Purpose config create Create a new profile config list List all profiles config edit -p NAME Edit existing profile config delete -p NAME Delete a profile config export -p NAME Export profile (optionally with secrets) config import -i FILE Import profile from file See detailed profile management guide →\nBest Practices link✅ Do link Use descriptive profile names: prod-graph-api, not profile1 Store one app per profile for clarity Export profiles for backup before major changes Rotate secrets regularly ❌ Don’t link Share profiles with secrets via insecure channels Use the same profile for multiple environments Store production credentials on Linux (XOR obfuscation only) Commit profiles.json to version control Next Steps link Learn about OAuth2 Flows to understand authentication methods Manage Scopes to control API access Profile Management Guide for detailed commands "
            }
        );
    index.add(
            {
                id:  14 ,
                href: "\/docs\/oauth-flows\/client-credentials\/",
                title: "Client Credentials Flow",
                description: "Service-to-service authentication without user interaction",
                content: "Client Credentials Flow linkThe Client Credentials flow is designed for service-to-service authentication where no user interaction is required. This is the most common flow for automation, CI/CD pipelines, and background services.\nOverview linkUse this flow when:\nYour application runs without user interaction You’re authenticating a service, not a user You need application-level permissions Running in CI/CD pipelines or automated scripts Authentication methods:\nClient Secret - Shared secret (less secure, easier setup) Certificate - Public/private key pair (more secure, recommended for production) Quick Start linkUsing Client Secret link # Create profile with client secret entra-auth-cli create-profile # Generate token entra-auth-cli get-token --profile myapp Using Certificate link # Create profile with certificate entra-auth-cli create-profile --use-certificate # Generate token entra-auth-cli get-token --profile myapp-cert Configuration linkProfile Setup linkWhen creating a profile for client credentials flow:\nentra-auth-cli create-profile You’ll be prompted for:\nProfile Name: Identifier for this configuration Tenant ID: Your Microsoft Entra tenant ID Client ID: Application (client) ID from Azure Authentication Method: Client secret or certificate Scopes: Default API permissions Azure App Registration linkRequired Azure configuration:\nCreate App Registration\n# Using Azure CLI az ad app create --display-name \"My Service App\" Configure API Permissions\nAdd application permissions (not delegated) Grant admin consent Common scopes: https://graph.microsoft.com/.default https://management.azure.com/.default Add Credentials\nOption A: Client Secret\naz ad app credential reset --id Option B: Certificate\naz ad app credential reset --id --cert @cert.pem Usage Examples linkBasic Token Request link # Using default profile entra-auth-cli get-token # Using specific profile entra-auth-cli get-token --profile production # Override scopes entra-auth-cli get-token --scope https://graph.microsoft.com/.default With Microsoft Graph link # Get token for Graph API TOKEN=$(entra-auth-cli get-token --scope https://graph.microsoft.com/.default --output json | jq -r .access_token) # Use token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/users With Azure Management link # Get token for Azure Management TOKEN=$(entra-auth-cli get-token --scope https://management.azure.com/.default --output json | jq -r .access_token) # List subscriptions curl -H \"Authorization: Bearer $TOKEN\" \\ https://management.azure.com/subscriptions?api-version=2020-01-01 In Scripts link #!/bin/bash set -euo pipefail # Function to get token with error handling get_token() { local scope=\"${1:-https://graph.microsoft.com/.default}\" local max_retries=3 local retry=0 while [ $retry -lt $max_retries ]; do if TOKEN=$(entra-auth-cli get-token --scope \"$scope\" --output json 2\u003e/dev/null); then echo \"$TOKEN\" | jq -r .access_token return 0 fi retry=$((retry + 1)) sleep $((retry * 2)) done echo \"Failed to get token after $max_retries attempts\" \u003e\u00262 return 1 } # Use the token if TOKEN=$(get_token); then curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me fi CI/CD Integration linkGitHub Actions link name: Deploy with Token on: [push] jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Install Entra Auth Cli run: | wget https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 chmod +x entra-auth-cli-linux-amd64 sudo mv entra-auth-cli-linux-amd64 /usr/local/bin/entra-auth-cli - name: Create Profile env: TENANT_ID: ${{ secrets.AZURE_TENANT_ID }} CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }} CLIENT_SECRET: ${{ secrets.AZURE_CLIENT_SECRET }} run: | entra-auth-cli create-profile \\ --name ci \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --client-secret \"$CLIENT_SECRET\" \\ --scope https://management.azure.com/.default - name: Get Token and Deploy run: | TOKEN=$(entra-auth-cli get-token --profile ci --output json | jq -r .access_token) # Use token for deployment Azure Pipelines link trigger: - main pool: vmImage: 'ubuntu-latest' steps: - task: Bash@3 displayName: 'Install Entra Auth Cli' inputs: targetType: 'inline' script: | wget https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 chmod +x entra-auth-cli-linux-amd64 sudo mv entra-auth-cli-linux-amd64 /usr/local/bin/entra-auth-cli - task: Bash@3 displayName: 'Get Token' env: TENANT_ID: $(AZURE_TENANT_ID) CLIENT_ID: $(AZURE_CLIENT_ID) CLIENT_SECRET: $(AZURE_CLIENT_SECRET) inputs: targetType: 'inline' script: | entra-auth-cli create-profile \\ --name pipeline \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --client-secret \"$CLIENT_SECRET\" TOKEN=$(entra-auth-cli get-token --profile pipeline --output json | jq -r .access_token) echo \"##vso[task.setvariable variable=ACCESS_TOKEN;isSecret=true]$TOKEN\" - task: Bash@3 displayName: 'Deploy Application' inputs: targetType: 'inline' script: | # Use $(ACCESS_TOKEN) in subsequent commands curl -H \"Authorization: Bearer $(ACCESS_TOKEN)\" ... Security Best Practices linkCertificate-Based Authentication linkAlways prefer certificates over client secrets in production:\n# Create certificate openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes # Create profile with certificate entra-auth-cli create-profile \\ --name secure-app \\ --use-certificate \\ --certificate-path cert.pem \\ --private-key-path key.pem Secret Management linkDon’t hardcode secrets:\n# ❌ Bad - hardcoded entra-auth-cli create-profile --client-secret \"my-secret-123\" # ✅ Good - from environment entra-auth-cli create-profile --client-secret \"${CLIENT_SECRET}\" # ✅ Better - from secure vault CLIENT_SECRET=$(az keyvault secret show --vault-name myvault --name client-secret --query value -o tsv) entra-auth-cli create-profile --client-secret \"${CLIENT_SECRET}\" Least Privilege linkOnly request the permissions you need:\n# ❌ Too broad entra-auth-cli get-token --scope https://graph.microsoft.com/.default # ✅ Specific permission entra-auth-cli get-token --scope https://graph.microsoft.com/User.Read.All Troubleshooting link“Unauthorized” Errors linkProblem: 401 Unauthorized when using token\nSolutions:\nVerify application permissions in Azure Portal Ensure admin consent is granted Check token scopes match API requirements Verify application has correct role assignments # Inspect token to verify scopes entra-auth-cli inspect --profile myapp Certificate Not Found linkProblem: Profile created but certificate not accessible\nSolutions:\nVerify certificate path is absolute Check file permissions (readable by user) Ensure certificate format is correct (PEM/PFX) # Verify certificate openssl x509 -in cert.pem -text -noout Token Expired linkProblem: Token works initially but fails later\nSolution: Tokens expire after 1 hour. Implement refresh logic:\n# Check if token is still valid is_token_valid() { local token=\"$1\" local exp=$(echo \"$token\" | jq -R 'split(\".\") | .[1] | @base64d | fromjson | .exp') local now=$(date +%s) [ \"$exp\" -gt \"$now\" ] } # Get new token if expired if ! is_token_valid \"$TOKEN\"; then TOKEN=$(entra-auth-cli get-token --profile myapp --output json | jq -r .access_token) fi Performance Optimization linkToken Caching linkEntra Auth Cli automatically caches tokens. Reuse tokens within their lifetime:\n# First call gets new token entra-auth-cli get-token --profile myapp # ~500ms # Subsequent calls use cached token entra-auth-cli get-token --profile myapp # ~50ms Parallel Requests linkWhen making multiple API calls with the same token:\n# Get token once TOKEN=$(entra-auth-cli get-token --output json | jq -r .access_token) # Use for multiple parallel requests { curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/users \u0026 curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/groups \u0026 curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/applications \u0026 wait } Next Steps link Certificate Authentication - Use certificates instead of secrets CI/CD Integration - Complete CI/CD examples Security Hardening - Production security checklist Microsoft Graph Recipes - Common Graph API patterns "
            }
        );
    index.add(
            {
                id:  15 ,
                href: "\/docs\/reference\/get-token\/",
                title: "get-token",
                description: "Generate access tokens using configured profiles",
                content: "get-token linkGenerate Microsoft Entra ID access tokens using configured authentication profiles.\nSynopsis link entra-auth-cli get-token [flags] Description linkThe get-token command generates access tokens for authenticating with Microsoft APIs. It supports multiple OAuth2 flows and can use profiles configured with different authentication methods.\nTokens are cached and automatically refreshed when needed, making subsequent calls fast and efficient.\nFlags linkCore Options link--profile, -p linkProfile name to use for authentication.\nentra-auth-cli get-token --profile production entra-auth-cli get-token -p dev Default: default\n--scope, -s linkOverride default scopes for this request.\nentra-auth-cli get-token --scope \"https://graph.microsoft.com/User.Read\" entra-auth-cli get-token -s \"User.Read Mail.Read\" Format: Space-separated list of scopes\n--flow, -f linkOAuth2 flow to use for authentication.\nentra-auth-cli get-token --flow interactive entra-auth-cli get-token -f device-code Options:\nclient-credentials - Service-to-service (default for app profiles) interactive - Browser-based user auth device-code - Device code for limited input authorization-code - Web app flow (rarely used in CLI) Output Options link--output, -o linkOutput format for the token.\nentra-auth-cli get-token --output json entra-auth-cli get-token -o yaml Options:\ntoken - Just the access token (default) json - Full token response as JSON yaml - Full token response as YAML --file linkSave token to file instead of stdout.\nentra-auth-cli get-token --file token.txt entra-auth-cli get-token --output json --file token.json --silent, -q linkSuppress all output except the token.\nTOKEN=$(entra-auth-cli get-token --silent) Behavior Options link--force linkForce new token generation (skip cache).\nentra-auth-cli get-token --force --no-cache linkDon’t cache the generated token.\nentra-auth-cli get-token --no-cache --timeout linkMaximum time to wait for token generation.\nentra-auth-cli get-token --timeout 30s entra-auth-cli get-token --timeout 2m Default: 60s\nExamples linkBasic Usage link # Default profile and scopes entra-auth-cli get-token # Specific profile entra-auth-cli get-token --profile production # With custom scope entra-auth-cli get-token --scope \"https://management.azure.com/.default\" Output Formats link # Token only (default) entra-auth-cli get-token # Full JSON response entra-auth-cli get-token --output json # Save to file entra-auth-cli get-token --file access_token.txt Different Flows link # Client credentials (service account) entra-auth-cli get-token --profile service-app # Interactive browser (user auth) entra-auth-cli get-token --flow interactive # Device code (headless/SSH) entra-auth-cli get-token --flow device-code Script Usage link # Get token in variable TOKEN=$(entra-auth-cli get-token --silent) # Use in API call curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me # JSON parsing ACCESS_TOKEN=$(entra-auth-cli get-token --output json | jq -r .access_token) EXPIRES_AT=$(entra-auth-cli get-token --output json | jq -r .expires_at) Force Refresh link # Skip cache and get fresh token entra-auth-cli get-token --force # Useful when token has wrong permissions entra-auth-cli get-token --force --scope \"Mail.Read Mail.Send\" Output linkDefault (Token Only) link eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1yNS1BVW... JSON Format link { \"token_type\": \"Bearer\", \"scope\": \"User.Read Mail.Read\", \"expires_in\": 3599, \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\", \"refresh_token\": \"0.ARoAv4j5cvGGr...\", \"expires_at\": \"2025-12-28T15:30:00Z\" } YAML Format link token_type: Bearer scope: User.Read Mail.Read expires_in: 3599 access_token: eyJ0eXAiOiJKV1QiLCJhbGc... refresh_token: 0.ARoAv4j5cvGGr... expires_at: 2025-12-28T15:30:00Z Exit Codes link Code Description 0 Success 1 General error 2 Profile not found 3 Authentication failed 4 Network error 5 Timeout Token Caching linkTokens are automatically cached for reuse:\nLocation: Platform-specific secure storage Windows: DPAPI encrypted macOS: Keychain Linux: Encrypted file Duration: Until expiration (typically 1 hour) Refresh: Automatic when expired (if refresh token available) Cache Behavior link # First call - generates new token (~500ms) entra-auth-cli get-token --profile prod # Subsequent calls - uses cached token (~50ms) entra-auth-cli get-token --profile prod # After expiration - automatically refreshes entra-auth-cli get-token --profile prod Common Use Cases linkMicrosoft Graph API link # Get token for Graph TOKEN=$(entra-auth-cli get-token \\ --scope \"https://graph.microsoft.com/.default\" \\ --output json | jq -r .access_token) # Call Graph API curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/users Azure Management API link # Get token for Azure TOKEN=$(entra-auth-cli get-token \\ --scope \"https://management.azure.com/.default\" \\ --output json | jq -r .access_token) # List subscriptions curl -H \"Authorization: Bearer $TOKEN\" \\ https://management.azure.com/subscriptions?api-version=2020-01-01 CI/CD Pipeline link #!/bin/bash set -euo pipefail # Get token (exits on failure) TOKEN=$(entra-auth-cli get-token \\ --profile cicd \\ --silent \\ --timeout 30s) # Deploy application ./deploy.sh --token \"$TOKEN\" Multiple Scopes link # Request multiple scopes entra-auth-cli get-token \\ --scope \"User.Read Mail.Read Calendars.Read\" \\ --output json # Verify scopes in token entra-auth-cli get-token --output json | \\ jq -r .scope Error Handling linkScript Example link #!/bin/bash get_token_safe() { local profile=\"${1:-default}\" local max_retries=3 local attempt=0 while [ $attempt -lt $max_retries ]; do if token=$(entra-auth-cli get-token \\ --profile \"$profile\" \\ --silent 2\u003e/dev/null); then echo \"$token\" return 0 fi attempt=$((attempt + 1)) if [ $attempt -lt $max_retries ]; then echo \"Attempt $attempt failed, retrying...\" \u003e\u00262 sleep $((attempt * 2)) fi done echo \"Failed to get token after $max_retries attempts\" \u003e\u00262 return 1 } # Usage if TOKEN=$(get_token_safe production); then echo \"Success: ${TOKEN:0:20}...\" else echo \"Failed to authenticate\" exit 1 fi Tips linkPerformance link # Cache tokens in memory for multiple uses TOKEN=$(entra-auth-cli get-token --silent) for api in users groups applications; do curl -s -H \"Authorization: Bearer $TOKEN\" \\ \"https://graph.microsoft.com/v1.0/$api\" done Debugging link # Verbose output entra-auth-cli get-token --output json | jq . # Force fresh token entra-auth-cli get-token --force --output json # Check what's cached entra-auth-cli inspect --profile myapp Security link # Don't expose token in command history TOKEN=$(entra-auth-cli get-token --silent) # Use token from variable, not command substitution curl -H \"Authorization: Bearer $TOKEN\" ... # Not recommended (token visible in ps output) curl -H \"Authorization: Bearer $(entra-auth-cli get-token)\" ... See Also link refresh - Refresh expired tokens inspect - Decode and inspect tokens Managing Profiles - Profile management Generating Tokens - Token generation guide "
            }
        );
    index.add(
            {
                id:  16 ,
                href: "\/docs\/getting-started\/installation\/",
                title: "Installation",
                description: "How to install Entra Auth Cli on your platform",
                content: "Installation linkEntra Auth Cli can be installed as a .NET global tool or downloaded as a self-contained executable for your platform.\nOption 1: .NET Global Tool (Recommended) linkPrerequisites: .NET Runtime 10.0 or later\nInstall link dotnet tool install -g EntraAuthCli Update link dotnet tool update -g EntraAuthCli Uninstall link dotnet tool uninstall -g EntraAuthCli Verify Installation link entra-auth-cli --version Option 2: Self-Contained Executables linkDownload the latest release for your platform from the Releases page.\nWindows link Download entra-auth-cli-win-x64.exe Place in a directory in your PATH (e.g., C:\\Tools\\) Run from command prompt: entra-auth-cli --version macOS (Apple Silicon) link Download entra-auth-cli-osx-arm64 Make executable and move to PATH: chmod +x entra-auth-cli-osx-arm64 sudo mv entra-auth-cli-osx-arm64 /usr/local/bin/entra-auth-cli Verify: entra-auth-cli --version macOS (Intel) link Download entra-auth-cli-osx-x64 Make executable and move to PATH: chmod +x entra-auth-cli-osx-x64 sudo mv entra-auth-cli-osx-x64 /usr/local/bin/entra-auth-cli Verify: entra-auth-cli --version Linux link Download entra-auth-cli-linux-x64 Make executable and move to PATH: chmod +x entra-auth-cli-linux-x64 sudo mv entra-auth-cli-linux-x64 /usr/local/bin/entra-auth-cli Verify: entra-auth-cli --version ⚠️ Linux Security Note: Linux uses XOR obfuscation for secret storage, not cryptographic encryption. Suitable for development only. See Platform-Specific Guides for production alternatives.\nPlatform Requirements linkWindows link Windows 10+ (build 1607+) Secure storage via DPAPI macOS link macOS 10.15+ (Catalina or later) Secure storage via Keychain Linux link Ubuntu 20.04+, Fedora 35+, or compatible distributions XOR obfuscation (not cryptographically secure) Next Steps link Quick Start Guide → - Generate your first token Complete Tutorial → - Full walkthrough Core Concepts → - Understand how it works "
            }
        );
    index.add(
            {
                id:  17 ,
                href: "\/docs\/user-guide\/managing-profiles\/",
                title: "Managing Profiles",
                description: "Create, edit, and manage authentication profiles",
                content: "Managing Profiles linkAuthentication profiles store your configuration for connecting to Microsoft Entra ID. Learn how to create, view, edit, and delete profiles.\nQuick Reference link Task Command Create new profile entra-auth-cli config create List all profiles entra-auth-cli config list Edit existing profile entra-auth-cli config edit -p NAME Delete profile entra-auth-cli config delete -p NAME Export profile entra-auth-cli config export -p NAME Import profile entra-auth-cli config import -f FILE Creating Profiles linkInteractive Creation linkThe easiest way to create a profile:\nentra-auth-cli config create Prompts:\nProfile name: Unique identifier Client ID: From app registration Tenant ID: Your Azure AD tenant Authentication method: Secret or Certificate Scope: API permissions OAuth2 flow: (Optional) Default flow Example session:\nProfile name: my-graph-app Client ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Authentication method: 1. Client Secret 2. Certificate Select: 1 Client secret: ******************************** Scope: https://graph.microsoft.com/.default Set default OAuth2 flow? (y/n): y OAuth2 flow: 1. ClientCredentials 2. AuthorizationCode 3. DeviceCode 4. InteractiveBrowser Select: 1 ✓ Profile 'my-graph-app' created successfully Detailed guide →\nListing Profiles linkView All Profiles link entra-auth-cli config list Output:\nAvailable profiles: 1. my-graph-app Client ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Scope: https://graph.microsoft.com/.default Flow: ClientCredentials 2. personal-graph Client ID: abcdef12-3456-7890-abcd-ef1234567890 Tenant ID: common Scope: https://graph.microsoft.com/User.Read Flow: InteractiveBrowser JSON Output link entra-auth-cli config list --json Output:\n{ \"profiles\": [ { \"name\": \"my-graph-app\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true } ] } Detailed guide →\nEditing Profiles linkInteractive Edit link entra-auth-cli config edit -p my-graph-app Select what to edit:\nWhat would you like to edit? 1. Client ID 2. Tenant ID 3. Client Secret 4. Scope 5. OAuth2 Flow 6. Authority URL q. Done Select: 4 Current scope: https://graph.microsoft.com/.default New scope: https://graph.microsoft.com/User.Read Mail.Read ✓ Profile 'my-graph-app' updated Common Edits linkRotate client secret:\nentra-auth-cli config edit -p my-graph-app # Select: Client Secret # Enter new secret Change scope:\nentra-auth-cli config edit -p my-graph-app # Select: Scope # Enter: new-scope Switch authentication method:\nentra-auth-cli config edit -p my-graph-app # Select: Authentication Method # Choose: Certificate # Enter certificate path and password Detailed guide →\nDeleting Profiles linkDelete Single Profile link entra-auth-cli config delete -p my-graph-app Confirmation prompt:\nAre you sure you want to delete profile 'my-graph-app'? (y/n): y ✓ Profile deleted successfully What gets deleted:\nProfile configuration from profiles.json Associated secrets from secure storage Delete with Force linkSkip confirmation:\nentra-auth-cli config delete -p my-graph-app --force ⚠️ Warning: This is permanent. Secrets cannot be recovered.\nDetailed guide →\nExporting Profiles linkExport for Backup linkExport profile configuration (without secrets):\nentra-auth-cli config export -p my-graph-app -o my-profile.json Output file:\n{ \"name\": \"my-graph-app\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true // Note: clientSecret is NOT included } Export All Profiles link entra-auth-cli config export -o all-profiles.json Security Note link warning Exported files do NOT include secrets or certificates.\nYou must manually transfer secrets to the new location using secure methods.\nDetailed guide →\nImporting Profiles linkImport Single Profile link entra-auth-cli config import -f my-profile.json Post-import:\n✓ Profile 'my-graph-app' imported successfully ⚠ You must set the client secret: entra-auth-cli config edit -p my-graph-app Import with Merge linkIf a profile with the same name exists:\nProfile 'my-graph-app' already exists. 1. Skip 2. Overwrite 3. Rename (import as 'my-graph-app-2') Select: Batch Import linkImport multiple profiles:\nentra-auth-cli config import -f team-profiles.json team-profiles.json:\n{ \"profiles\": [ { \"name\": \"profile1\", \"clientId\": \"...\", ... }, { \"name\": \"profile2\", \"clientId\": \"...\", ... } ] } Detailed guide →\nProfile Storage linkStorage Location linkFile: ~/.entra-auth-cli/profiles.json\nPlatforms:\nWindows: %USERPROFILE%\\.entra-auth-cli\\profiles.json macOS/Linux: ~/.entra-auth-cli/profiles.json What’s Stored linkIn profiles.json (plaintext):\nProfile name Client ID Tenant ID Scope OAuth2 flow preference Authority URL Certificate path In secure storage (encrypted):\nClient secrets Certificate passwords Manual Editing linkYou can manually edit profiles.json:\n# macOS/Linux nano ~/.entra-auth-cli/profiles.json # Windows notepad %USERPROFILE%\\.entra-auth-cli\\profiles.json Example:\n{ \"profiles\": [ { \"name\": \"my-profile\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true } ] } ⚠️ Be careful: Invalid JSON will break profile loading.\nCommon Workflows linkScenario: Team Onboarding linkShare profiles with new team members:\nExport profiles (without secrets):\nentra-auth-cli config export -o team-profiles.json Share team-profiles.json via secure channel\nTeam member imports:\nentra-auth-cli config import -f team-profiles.json Securely share secrets (use Azure Key Vault or password manager)\nTeam member adds secrets:\nentra-auth-cli config edit -p profile1 # Add client secret Scenario: Environment Migration linkMove profiles from dev to prod machine:\nExport from dev:\nentra-auth-cli config export -p prod-profile -o prod.json Transfer file securely (SCP, encrypted USB, etc.)\nImport on prod:\nentra-auth-cli config import -f prod.json Add production secret:\nentra-auth-cli config edit -p prod-profile Scenario: Secret Rotation linkRotate client secret after compromise:\nGenerate new secret in Azure Portal Update profile: entra-auth-cli config edit -p compromised-profile # Select: Client Secret # Enter: new-secret Test: entra-auth-cli get-token -p compromised-profile Delete old secret from Azure Portal Best Practices link✅ Naming Conventions linkUse descriptive, hierarchical names:\n# Good company-graph-prod company-graph-dev project-api-staging # Avoid profile1 test myprofile ✅ Organize by Environment link # Production prod-graph-api prod-azure-management # Staging staging-graph-api staging-azure-management # Development dev-graph-api dev-azure-management ✅ Separate Concerns linkCreate profiles for different purposes:\n# Read-only operations readonly-graph-profile # Write operations admin-graph-profile # Different APIs profile-graph profile-azure profile-custom-api ✅ Regular Maintenance link Review profiles monthly Delete unused profiles Rotate secrets quarterly Update scopes as needed ❌ Avoid link ❌ Sharing profiles via email ❌ Committing profiles to git ❌ Using the same profile for dev and prod ❌ Storing secrets in plaintext ❌ Reusing secrets across profiles Troubleshooting link“Profile not found” linkCause: Profile name doesn’t exist\nFix:\n# List available profiles entra-auth-cli config list # Use correct name entra-auth-cli get-token -p correct-profile-name “Profile already exists” linkCause: Creating profile with duplicate name\nFix:\n# Option 1: Delete existing entra-auth-cli config delete -p duplicate-name # Option 2: Use different name entra-auth-cli config create # Enter: duplicate-name-2 “Invalid profile configuration” linkCause: Corrupted profiles.json\nFix:\n# Backup current file cp ~/.entra-auth-cli/profiles.json ~/.entra-auth-cli/profiles.json.bak # Validate JSON cat ~/.entra-auth-cli/profiles.json | jq # Fix syntax errors or restore from backup “Cannot access secure storage” linkCause: Platform secure storage unavailable\nFix:\nWindows: Ensure user profile is not corrupted macOS: Unlock Keychain Linux: Check file permissions on ~/.entra-auth-cli/ Next Steps link Creating Profiles (Detailed) Generating Tokens Certificate Authentication Security Best Practices "
            }
        );
    index.add(
            {
                id:  18 ,
                href: "\/docs\/troubleshooting\/profiles\/",
                title: "Profile Issues",
                description: "Troubleshooting profile configuration and access problems",
                content: "Profile Issues linkCommon problems with profile configuration, access, and management.\nProfile Not Found linkProblem link $ entra-auth-cli get-token --profile production Error: profile 'production' not found Solutions link1. List Available Profiles link # See all configured profiles entra-auth-cli list-profiles # Check if profile exists with different name entra-auth-cli list-profiles | grep -i prod 2. Create Missing Profile link # Create the profile entra-auth-cli create-profile --name production # Or use interactive mode entra-auth-cli create-profile 3. Use Default Profile link # If you meant to use default profile entra-auth-cli get-token # Check default profile entra-auth-cli list-profiles | grep default Profile Already Exists linkProblem link $ entra-auth-cli create-profile --name dev Error: profile 'dev' already exists Solutions link1. Use Existing Profile link # View existing profile entra-auth-cli show-profile --name dev # Edit if needed entra-auth-cli edit-profile --name dev 2. Delete and Recreate link # Delete existing profile entra-auth-cli delete-profile --name dev # Create new one entra-auth-cli create-profile --name dev 3. Use Different Name link # Create with different name entra-auth-cli create-profile --name dev-new entra-auth-cli create-profile --name dev-v2 Invalid Profile Configuration linkProblem link $ entra-auth-cli get-token --profile myapp Error: invalid profile configuration: missing tenant_id Solutions link1. Check Profile Configuration link # View profile details entra-auth-cli show-profile --name myapp # Look for missing fields: # - tenant_id # - client_id # - auth_method 2. Edit Profile link # Interactive edit entra-auth-cli edit-profile --name myapp # Or delete and recreate entra-auth-cli delete-profile --name myapp entra-auth-cli create-profile --name myapp 3. Validate Required Fields link # Profile must have: # - Tenant ID (GUID) # - Client ID (GUID) # - Auth method (client_secret or certificate) # - Scopes (optional, has defaults) # Example valid configuration: { \"name\": \"myapp\", \"tenant_id\": \"12345678-1234-1234-1234-123456789012\", \"client_id\": \"87654321-4321-4321-4321-210987654321\", \"auth_method\": \"client_secret\", \"scopes\": [\"https://graph.microsoft.com/.default\"] } Cannot Access Secure Storage linkProblem linkWindows:\nError: failed to access DPAPI encrypted storage macOS:\nError: failed to access Keychain: user canceled Linux:\nError: permission denied accessing /home/user/.entra-auth-cli/profiles/ Solutions linkWindows (DPAPI) link # 1. Check user profile whoami # 2. Verify storage location $env:LOCALAPPDATA\\EntraAuthCli\\profiles # 3. Check permissions Get-Acl \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\" | Format-List # 4. Recreate profile if user changed entra-auth-cli delete-profile --name myapp entra-auth-cli create-profile --name myapp macOS (Keychain) link # 1. Allow Keychain access # Click \"Always Allow\" when prompted # 2. Reset Keychain permissions security delete-generic-password -s \"com.garrardkitchen.entra-auth-cli\" -a \"myapp\" entra-auth-cli create-profile --name myapp # 3. Check Keychain Access app open -a \"Keychain Access\" # Search for: entra-auth-cli # 4. Unlock Keychain if locked security unlock-keychain ~/Library/Keychains/login.keychain-db Linux (File Permissions) link # 1. Check permissions ls -la ~/.entra-auth-cli/profiles/ # 2. Fix permissions chmod 700 ~/.entra-auth-cli/profiles/ chmod 600 ~/.entra-auth-cli/profiles/* # 3. Check ownership ls -la ~/.entra-auth-cli/ chown -R $USER:$USER ~/.entra-auth-cli/ # 4. Recreate if needed rm -rf ~/.entra-auth-cli/profiles/ entra-auth-cli create-profile --name myapp Profile Corruption linkProblem link $ entra-auth-cli get-token --profile prod Error: failed to parse profile: invalid JSON Solutions link1. View Raw Profile link # Windows type %LOCALAPPDATA%\\EntraAuthCli\\profiles\\prod.json # macOS/Linux cat ~/.entra-auth-cli/profiles/prod.json 2. Delete Corrupted Profile link # Delete via CLI entra-auth-cli delete-profile --name prod # Or manually # Windows del %LOCALAPPDATA%\\EntraAuthCli\\profiles\\prod.* # macOS/Linux rm ~/.entra-auth-cli/profiles/prod.* 3. Recreate Profile link entra-auth-cli create-profile --name prod Migration Issues linkProblem link # After moving to new machine $ entra-auth-cli get-token --profile myapp Error: cannot decrypt token Solutions link1. Understand Encryption linkTokens are encrypted per-machine and per-user:\nWindows: DPAPI (machine-specific) macOS: Keychain (can sync via iCloud) Linux: Machine ID + User ID 2. Export and Import Profiles link # On old machine - export (configuration only, not tokens) entra-auth-cli export-profile --name myapp \u003e myapp-profile.json # On new machine - import entra-auth-cli import-profile \u003c myapp-profile.json # Re-authenticate on new machine entra-auth-cli get-token --profile myapp --force 3. Recreate Profiles link # Easiest solution: recreate profiles on new machine entra-auth-cli create-profile --name myapp # Enter same tenant ID, client ID, etc. Permission Denied linkProblem link $ entra-auth-cli create-profile Error: permission denied: cannot write to profiles directory Solutions link1. Check Directory Permissions link # Linux/macOS ls -ld ~/.entra-auth-cli/ mkdir -p ~/.entra-auth-cli/profiles chmod 700 ~/.entra-auth-cli/profiles # Windows (PowerShell) Test-Path \"$env:LOCALAPPDATA\\EntraAuthCli\" New-Item -ItemType Directory -Force -Path \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\" 2. Check Disk Space link # Linux/macOS df -h ~ # Windows Get-PSDrive C 3. Run as User (Not Root) link # Don't use sudo sudo entra-auth-cli create-profile # ❌ Wrong # Run as regular user entra-auth-cli create-profile # ✅ Correct Profile Name Conflicts linkProblem link $ entra-auth-cli create-profile --name \"My Profile\" Error: invalid profile name: spaces not allowed Solutions link1. Use Valid Names link # Valid profile names: entra-auth-cli create-profile --name my-profile entra-auth-cli create-profile --name my_profile entra-auth-cli create-profile --name myProfile entra-auth-cli create-profile --name myprofile # Invalid (will fail): entra-auth-cli create-profile --name \"my profile\" # spaces entra-auth-cli create-profile --name \"my/profile\" # slashes entra-auth-cli create-profile --name \"my@profile\" # special chars 2. Naming Conventions link # Recommended patterns: entra-auth-cli create-profile --name production entra-auth-cli create-profile --name dev entra-auth-cli create-profile --name staging # By purpose: entra-auth-cli create-profile --name graph-reader entra-auth-cli create-profile --name azure-deployer # By environment: entra-auth-cli create-profile --name prod-api entra-auth-cli create-profile --name dev-testing Duplicate Tenant/Client Combinations linkProblem linkMultiple profiles with same tenant/client but different configurations cause confusion.\nSolutions link1. Use Descriptive Names link # Instead of: entra-auth-cli create-profile --name app1 entra-auth-cli create-profile --name app2 # Use descriptive names: entra-auth-cli create-profile --name graph-readonly entra-auth-cli create-profile --name graph-admin 2. List Profiles with Details link # Show all profiles with details entra-auth-cli list-profiles --verbose # Or manually check entra-auth-cli show-profile --name profile1 entra-auth-cli show-profile --name profile2 Diagnostic Steps linkGeneral Troubleshooting link # 1. List all profiles entra-auth-cli list-profiles # 2. Check specific profile entra-auth-cli show-profile --name myapp # 3. Verify token generation works entra-auth-cli get-token --profile myapp --output json # 4. Check profile file exists # Windows dir %LOCALAPPDATA%\\EntraAuthCli\\profiles\\ # macOS/Linux ls -la ~/.entra-auth-cli/profiles/ # 5. Test with default profile entra-auth-cli get-token Verify Azure Configuration link # Check app registration exists az ad app show --id YOUR_CLIENT_ID # Verify credentials az ad app credential list --id YOUR_CLIENT_ID # Check permissions az ad app permission list --id YOUR_CLIENT_ID Prevention linkBest Practices link # 1. Use descriptive profile names entra-auth-cli create-profile --name prod-graph-api # 2. Document your profiles cat \u003e profiles.md \u003c\u003c 'EOF' # Entra Token Profiles - production: Production Graph API access - dev: Development environment - cicd: CI/CD pipeline authentication EOF # 3. Backup profile configurations entra-auth-cli export-profile --name production \u003e backup/production.json # 4. Regular validation entra-auth-cli get-token --profile production --force See Also link Managing Profiles - Profile management guide Authentication Issues - Authentication problems Platform Guides - Platform-specific information "
            }
        );
    index.add(
            {
                id:  19 ,
                href: "\/docs\/platform-guides\/windows\/",
                title: "Windows",
                description: "Windows-specific configuration and token storage",
                content: "Windows Platform Guide linkComplete guide for using Entra Auth Cli on Windows, including DPAPI-based secure storage, PowerShell integration, and Windows-specific features.\nOverview linkEntra Auth Cli leverages Windows security features for optimal token protection:\nDPAPI Encryption: Windows Data Protection API for secure token storage Per-User Isolation: Tokens encrypted per-user, per-machine Native Integration: Works with Windows Credential Manager PowerShell Support: First-class PowerShell scripting support Installation linkUsing Winget link # Install using Windows Package Manager winget install GarrardKitchen.EntraAuthCli Manual Installation link # Download latest release $version = \"1.0.0\" $url = \"https://github.com/garrardkitchen/entra-auth-cli/releases/download/v$version/entra-auth-cli-windows-amd64.exe\" # Download Invoke-WebRequest -Uri $url -OutFile \"$env:TEMP\\entra-auth-cli.exe\" # Move to Program Files Move-Item \"$env:TEMP\\entra-auth-cli.exe\" \"C:\\Program Files\\EntraToken\\entra-auth-cli.exe\" -Force # Add to PATH $path = [Environment]::GetEnvironmentVariable(\"Path\", \"User\") [Environment]::SetEnvironmentVariable(\"Path\", \"$path;C:\\Program Files\\EntraToken\", \"User\") Verify Installation link # Check version entra-auth-cli --version # Test basic functionality entra-auth-cli --help Token Storage linkDPAPI Encryption linkTokens are encrypted using Windows DPAPI:\n# Tokens stored at: $env:LOCALAPPDATA\\EntraAuthCli\\profiles\\ # Each profile has encrypted token file: # - profile-name.json (configuration) # - profile-name.token (encrypted token) Security characteristics:\nEncrypted per-user, per-machine Cannot be decrypted on different machine or by different user Protected by Windows user account Survives password changes View Storage Location link # Check storage path $storagePath = \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\" Get-ChildItem $storagePath # Example output: # Directory: C:\\Users\\jsmith\\AppData\\Local\\EntraAuthCli\\profiles # # Mode LastWriteTime Length Name # ---- ------------- ------ ---- # -a---- 12/28/2025 2:30 PM 456 default.json # -a---- 12/28/2025 2:30 PM 2048 default.token # -a---- 12/28/2025 3:15 PM 512 production.json # -a---- 12/28/2025 3:15 PM 2048 production.token Security Permissions link # Check file permissions Get-Acl \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\\default.token\" | Format-List # Verify only current user has access $acl = Get-Acl \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\\default.token\" $acl.Access | Where-Object { $_.IdentityReference -eq \"$env:USERDOMAIN\\$env:USERNAME\" } PowerShell Integration linkBasic Usage link # Get token $token = entra-auth-cli get-token --output json | ConvertFrom-Json $accessToken = $token.access_token # Use token in API call $headers = @{ Authorization = \"Bearer $accessToken\" } $response = Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/me\" -Headers $headers $response Function Wrapper link function Get-EntraToken { [CmdletBinding()] param( [string]$Profile = \"default\", [string]$Scope, [switch]$Force ) $arguments = @(\"get-token\", \"--profile\", $Profile, \"--output\", \"json\") if ($Scope) { $arguments += @(\"--scope\", $Scope) } if ($Force) { $arguments += \"--force\" } try { $output = \u0026 entra-auth-cli @arguments 2\u003e\u00261 if ($LASTEXITCODE -ne 0) { throw \"Failed to get token: $output\" } $token = $output | ConvertFrom-Json return $token.access_token } catch { Write-Error \"Error getting token: $_\" return $null } } # Usage $token = Get-EntraToken -Profile \"production\" $token = Get-EntraToken -Scope \"https://graph.microsoft.com/User.Read\" Error Handling link function Invoke-EntraTokenCommand { param( [Parameter(Mandatory)] [string[]]$Arguments, [int]$MaxRetries = 3 ) $attempt = 0 while ($attempt -lt $MaxRetries) { try { $output = \u0026 entra-auth-cli @Arguments 2\u003e\u00261 if ($LASTEXITCODE -eq 0) { return $output } $attempt++ if ($attempt -lt $MaxRetries) { Write-Warning \"Attempt $attempt failed. Retrying...\" Start-Sleep -Seconds ($attempt * 2) } } catch { $attempt++ if ($attempt -lt $MaxRetries) { Write-Warning \"Error: $_. Retrying...\" Start-Sleep -Seconds ($attempt * 2) } else { throw } } } throw \"Command failed after $MaxRetries attempts\" } # Usage $result = Invoke-EntraTokenCommand -Arguments @(\"get-token\", \"--output\", \"json\") Microsoft Graph Module Integration link # Install Microsoft Graph PowerShell SDK Install-Module Microsoft.Graph -Scope CurrentUser # Get token from Entra Auth Cli $token = entra-auth-cli get-token --scope https://graph.microsoft.com/.default --output json | ConvertFrom-Json | Select-Object -ExpandProperty access_token # Connect to Microsoft Graph $secureToken = ConvertTo-SecureString $token -AsPlainText -Force Connect-MgGraph -AccessToken $secureToken # Use Graph cmdlets Get-MgUser -Top 10 Get-MgGroup -Top 10 # Disconnect Disconnect-MgGraph Windows-Specific Features linkTask Scheduler Integration link # Create scheduled task for token refresh $action = New-ScheduledTaskAction -Execute \"entra-auth-cli\" -Argument \"refresh --profile production\" $trigger = New-ScheduledTaskTrigger -Daily -At 6:00AM $principal = New-ScheduledTaskPrincipal -UserId \"$env:USERDOMAIN\\$env:USERNAME\" -LogonType S4U $settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries Register-ScheduledTask -TaskName \"RefreshEntraToken\" -Action $action -Trigger $trigger -Principal $principal -Settings $settings # Run task manually Start-ScheduledTask -TaskName \"RefreshEntraToken\" # Check task history Get-ScheduledTaskInfo -TaskName \"RefreshEntraToken\" Windows Service Integration link # Example Windows Service using Entra Auth Cli # Service.ps1 Add-Type -TypeDefinition @\" using System; using System.Diagnostics; using System.ServiceProcess; using System.Timers; public class EntraTokenService : ServiceBase { private Timer timer; public EntraTokenService() { ServiceName = \"EntraTokenRefresh\"; } protected override void OnStart(string[] args) { timer = new Timer(3600000); // 1 hour timer.Elapsed += RefreshToken; timer.Start(); } protected override void OnStop() { timer?.Stop(); timer?.Dispose(); } private void RefreshToken(object sender, ElapsedEventArgs e) { Process.Start(new ProcessStartInfo { FileName = \"entra-auth-cli\", Arguments = \"refresh --profile production\", UseShellExecute = false, RedirectStandardOutput = true }); } } \"@ # Install service $serviceName = \"EntraTokenRefresh\" New-Service -Name $serviceName -BinaryPathName \"C:\\Path\\To\\Service.exe\" -StartupType Automatic Start-Service $serviceName Event Log Integration link # Log Entra Auth Cli operations to Windows Event Log function Write-EntraTokenLog { param( [Parameter(Mandatory)] [string]$Message, [ValidateSet('Information', 'Warning', 'Error')] [string]$EntryType = 'Information' ) $source = \"EntraAuthCli\" $logName = \"Application\" # Create source if it doesn't exist if (-not [System.Diagnostics.EventLog]::SourceExists($source)) { New-EventLog -LogName $logName -Source $source } Write-EventLog -LogName $logName -Source $source -EventId 1000 -EntryType $EntryType -Message $Message } # Usage Write-EntraTokenLog -Message \"Token refreshed successfully for profile: production\" Write-EntraTokenLog -Message \"Failed to refresh token\" -EntryType Error Common Use Cases linkAzure DevOps Integration link # Azure DevOps pipeline task # build.ps1 param( [string]$TenantId = $env:AZURE_TENANT_ID, [string]$ClientId = $env:AZURE_CLIENT_ID, [string]$ClientSecret = $env:AZURE_CLIENT_SECRET ) # Create profile entra-auth-cli create-profile ` --name azdo ` --tenant-id $TenantId ` --client-id $ClientId ` --client-secret $ClientSecret ` --scope \"https://management.azure.com/.default\" # Get token $token = entra-auth-cli get-token --profile azdo --output json | ConvertFrom-Json $accessToken = $token.access_token # Deploy to Azure $headers = @{ Authorization = \"Bearer $accessToken\" \"Content-Type\" = \"application/json\" } $body = @{ location = \"eastus\" properties = @{ template = Get-Content -Path \"template.json\" | ConvertFrom-Json } } | ConvertTo-Json -Depth 10 Invoke-RestMethod -Method Post ` -Uri \"https://management.azure.com/subscriptions/$subscriptionId/resourcegroups/$resourceGroup/providers/Microsoft.Resources/deployments/$deploymentName?api-version=2021-04-01\" ` -Headers $headers ` -Body $body PowerShell Module link # EntraToken.psm1 function Connect-EntraToken { [CmdletBinding()] param( [Parameter(Mandatory)] [string]$ProfileName, [switch]$Force ) $arguments = @(\"get-token\", \"--profile\", $ProfileName, \"--output\", \"json\") if ($Force) { $arguments += \"--force\" } $output = \u0026 entra-auth-cli @arguments 2\u003e\u00261 if ($LASTEXITCODE -ne 0) { throw \"Authentication failed: $output\" } $token = $output | ConvertFrom-Json $script:CurrentToken = $token.access_token $script:CurrentProfile = $ProfileName Write-Verbose \"Connected to profile: $ProfileName\" } function Get-CurrentEntraToken { if (-not $script:CurrentToken) { throw \"Not connected. Run Connect-EntraToken first.\" } return $script:CurrentToken } function Invoke-EntraGraphRequest { [CmdletBinding()] param( [Parameter(Mandatory)] [string]$Uri, [string]$Method = \"GET\", [object]$Body ) $token = Get-CurrentEntraToken $headers = @{ Authorization = \"Bearer $token\" \"Content-Type\" = \"application/json\" } $params = @{ Uri = $Uri Method = $Method Headers = $headers } if ($Body) { $params.Body = $Body | ConvertTo-Json -Depth 10 } Invoke-RestMethod @params } Export-ModuleMember -Function Connect-EntraToken, Get-CurrentEntraToken, Invoke-EntraGraphRequest # Usage: # Import-Module .\\EntraToken.psm1 # Connect-EntraToken -ProfileName \"production\" # Invoke-EntraGraphRequest -Uri \"https://graph.microsoft.com/v1.0/me\" Security Best Practices linkSecure Profile Creation link # Read sensitive data securely $tenantId = Read-Host -Prompt \"Tenant ID\" $clientId = Read-Host -Prompt \"Client ID\" $clientSecret = Read-Host -Prompt \"Client Secret\" -AsSecureString # Convert SecureString to plain text (only for immediate use) $bstr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($clientSecret) $plainSecret = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($bstr) try { entra-auth-cli create-profile ` --name \"secure-profile\" ` --tenant-id $tenantId ` --client-id $clientId ` --client-secret $plainSecret } finally { # Clear sensitive data [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($bstr) $plainSecret = $null } Credential Manager Integration link # Store credentials in Windows Credential Manager cmdkey /generic:EntraAuthCli /user:$clientId /pass:$clientSecret # Retrieve from Credential Manager $credential = Get-StoredCredential -Target \"EntraAuthCli\" $clientSecret = $credential.GetNetworkCredential().Password # Use in profile creation entra-auth-cli create-profile ` --name \"from-credman\" ` --client-secret $clientSecret Troubleshooting linkDPAPI Errors linkProblem: “Unable to decrypt token”\nSolutions:\n# Check user profile whoami echo $env:USERNAME # Verify profile ownership Get-Acl \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\\default.token\" | Select-Object Owner # Recreate profile if ownership changed entra-auth-cli delete-profile --name default entra-auth-cli create-profile --name default Path Issues linkProblem: “entra-auth-cli is not recognized”\nSolutions:\n# Check PATH $env:Path -split ';' | Select-String -Pattern \"EntraToken\" # Add to PATH permanently $path = [Environment]::GetEnvironmentVariable(\"Path\", \"User\") [Environment]::SetEnvironmentVariable(\"Path\", \"$path;C:\\Program Files\\EntraToken\", \"User\") # Add to PATH for current session $env:Path += \";C:\\Program Files\\EntraToken\" # Verify Get-Command entra-auth-cli PowerShell Execution Policy linkProblem: “Cannot run scripts”\nSolutions:\n# Check current policy Get-ExecutionPolicy # Set policy for current user Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser # Or bypass for specific script PowerShell -ExecutionPolicy Bypass -File .\\script.ps1 Performance Optimization linkToken Caching link # Cache token in memory for script duration $script:TokenCache = @{} function Get-CachedToken { param([string]$Profile = \"default\") $now = Get-Date if ($script:TokenCache.ContainsKey($Profile)) { $cached = $script:TokenCache[$Profile] if ($cached.ExpiresAt -gt $now.AddMinutes(5)) { return $cached.Token } } # Get fresh token $tokenJson = entra-auth-cli get-token --profile $Profile --output json | ConvertFrom-Json $token = $tokenJson.access_token $expiresAt = $now.AddSeconds($tokenJson.expires_in) $script:TokenCache[$Profile] = @{ Token = $token ExpiresAt = $expiresAt } return $token } Parallel Execution link # Parallel API calls with same token $token = Get-CachedToken $headers = @{ Authorization = \"Bearer $token\" } $users, $groups, $apps = Invoke-Parallel { Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/users\" -Headers $using:headers Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/groups\" -Headers $using:headers Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/applications\" -Headers $using:headers } Next Steps link macOS Platform Guide - macOS-specific features Linux Platform Guide - Linux-specific features PowerShell Recipes - Advanced PowerShell examples Security Hardening - Security best practices "
            }
        );
    index.add(
            {
                id:  20 ,
                href: "\/docs\/oauth-flows\/authorization-code\/",
                title: "Authorization Code Flow",
                description: "User authentication with browser-based sign-in",
                content: "Authorization Code Flow linkThe Authorization Code flow provides secure user authentication by redirecting to a web browser for sign-in, then exchanging an authorization code for tokens. This flow is used for applications that can securely store client secrets.\nOverview linkUse this flow when:\nYour application needs user authentication You have a web application with a backend server You can securely store client secrets You want the most secure user authentication flow Key characteristics:\nUser signs in via web browser Application receives authorization code Backend exchanges code for tokens Supports refresh tokens for long-lived sessions Note: Entra Auth Cli currently focuses on the Interactive Browser Flow for user authentication in CLI scenarios. The Authorization Code flow is typically used in web applications with backend servers. For CLI tools, use Interactive Browser Flow instead.\nHow It Works linksequenceDiagram participant User participant App participant Browser participant EntraID as Microsoft Entra ID User-\u003e\u003eApp: Start authentication App-\u003e\u003eBrowser: Redirect to Entra login Browser-\u003e\u003eEntraID: User signs in EntraID-\u003e\u003eBrowser: Return auth code Browser-\u003e\u003eApp: Redirect with code App-\u003e\u003eEntraID: Exchange code for tokens EntraID-\u003e\u003eApp: Access + Refresh tokens App-\u003e\u003eUser: Authentication complete Flow Steps link1. Authorization Request linkApplication redirects user to Microsoft Entra ID:\nhttps://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize? client_id={client-id}\u0026 response_type=code\u0026 redirect_uri={redirect-uri}\u0026 scope={scopes}\u0026 state={state}\u0026 code_challenge={challenge}\u0026 code_challenge_method=S256 Parameters:\nclient_id - Your application ID response_type=code - Request authorization code redirect_uri - Where to send user after login scope - Permissions being requested state - Anti-forgery token code_challenge - PKCE challenge (recommended) 2. User Authentication link User sees Microsoft sign-in page User enters credentials User may need MFA (if required) User consents to permissions (if needed) 3. Authorization Code linkAfter successful authentication, user is redirected:\n{redirect-uri}? code={authorization-code}\u0026 state={state} 4. Token Exchange linkApplication exchanges code for tokens:\nPOST https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token client_id={client-id} \u0026scope={scopes} \u0026code={authorization-code} \u0026redirect_uri={redirect-uri} \u0026grant_type=authorization_code \u0026client_secret={client-secret} \u0026code_verifier={verifier} 5. Token Response link { \"token_type\": \"Bearer\", \"scope\": \"user.read mail.read\", \"expires_in\": 3600, \"access_token\": \"eyJ0eXAi...\", \"refresh_token\": \"AwABAAAA...\" } PKCE Extension linkProof Key for Code Exchange (PKCE) enhances security by preventing authorization code interception.\nImplementation link # 1. Generate code verifier (random string) CODE_VERIFIER=$(openssl rand -base64 32 | tr -d \"=+/\" | cut -c1-43) # 2. Create code challenge (SHA256 hash) CODE_CHALLENGE=$(echo -n \"$CODE_VERIFIER\" | shasum -a 256 | cut -d' ' -f1 | xxd -r -p | base64 | tr -d \"=+/\" | cut -c1-43) # 3. Use challenge in authorization request # code_challenge=$CODE_CHALLENGE # code_challenge_method=S256 # 4. Use verifier in token exchange # code_verifier=$CODE_VERIFIER Web Application Example linkNode.js/Express link const express = require('express'); const crypto = require('crypto'); const axios = require('axios'); const app = express(); const sessions = new Map(); const config = { tenantId: process.env.TENANT_ID, clientId: process.env.CLIENT_ID, clientSecret: process.env.CLIENT_SECRET, redirectUri: 'http://localhost:3000/callback', scopes: ['User.Read', 'Mail.Read'] }; // Generate PKCE challenge function generatePKCE() { const verifier = crypto.randomBytes(32).toString('base64url'); const challenge = crypto .createHash('sha256') .update(verifier) .digest('base64url'); return { verifier, challenge }; } // Start authentication app.get('/login', (req, res) =\u003e { const state = crypto.randomBytes(16).toString('hex'); const pkce = generatePKCE(); sessions.set(state, { pkce }); const authUrl = `https://login.microsoftonline.com/${config.tenantId}/oauth2/v2.0/authorize?` + `client_id=${config.clientId}\u0026` + `response_type=code\u0026` + `redirect_uri=${encodeURIComponent(config.redirectUri)}\u0026` + `scope=${encodeURIComponent(config.scopes.join(' '))}\u0026` + `state=${state}\u0026` + `code_challenge=${pkce.challenge}\u0026` + `code_challenge_method=S256`; res.redirect(authUrl); }); // Handle callback app.get('/callback', async (req, res) =\u003e { const { code, state } = req.query; const session = sessions.get(state); if (!session) { return res.status(400).send('Invalid state'); } try { const tokenResponse = await axios.post( `https://login.microsoftonline.com/${config.tenantId}/oauth2/v2.0/token`, new URLSearchParams({ client_id: config.clientId, client_secret: config.clientSecret, scope: config.scopes.join(' '), code: code, redirect_uri: config.redirectUri, grant_type: 'authorization_code', code_verifier: session.pkce.verifier }) ); const { access_token, refresh_token } = tokenResponse.data; // Store tokens securely (use proper session management) sessions.set(state, { access_token, refresh_token }); res.send('Authentication successful!'); } catch (error) { res.status(500).send('Token exchange failed'); } }); app.listen(3000); Python/Flask link from flask import Flask, redirect, request, session from msal import ConfidentialClientApplication import secrets app = Flask(__name__) app.secret_key = secrets.token_hex(32) config = { 'tenant_id': 'your-tenant-id', 'client_id': 'your-client-id', 'client_secret': 'your-client-secret', 'redirect_uri': 'http://localhost:5000/callback', 'scopes': ['User.Read', 'Mail.Read'] } msal_app = ConfidentialClientApplication( config['client_id'], authority=f\"https://login.microsoftonline.com/{config['tenant_id']}\", client_credential=config['client_secret'] ) @app.route('/login') def login(): auth_url = msal_app.get_authorization_request_url( config['scopes'], redirect_uri=config['redirect_uri'], state=secrets.token_urlsafe(16) ) return redirect(auth_url) @app.route('/callback') def callback(): code = request.args.get('code') result = msal_app.acquire_token_by_authorization_code( code, scopes=config['scopes'], redirect_uri=config['redirect_uri'] ) if 'access_token' in result: session['tokens'] = result return 'Authentication successful!' return 'Authentication failed', 400 if __name__ == '__main__': app.run(port=5000) Refresh Tokens linkAuthorization Code flow provides refresh tokens for long-lived sessions:\n# Exchange refresh token for new access token POST https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token client_id={client-id} \u0026scope={scopes} \u0026refresh_token={refresh-token} \u0026grant_type=refresh_token \u0026client_secret={client-secret} Token Refresh Strategy link class TokenManager { constructor(tokens) { this.accessToken = tokens.access_token; this.refreshToken = tokens.refresh_token; this.expiresAt = Date.now() + (tokens.expires_in * 1000); } isExpired() { return Date.now() \u003e= this.expiresAt - 60000; // 1 min buffer } async getValidToken() { if (!this.isExpired()) { return this.accessToken; } return await this.refreshAccessToken(); } async refreshAccessToken() { const response = await fetch(tokenUrl, { method: 'POST', body: new URLSearchParams({ client_id: config.clientId, client_secret: config.clientSecret, refresh_token: this.refreshToken, grant_type: 'refresh_token' }) }); const tokens = await response.json(); this.accessToken = tokens.access_token; this.expiresAt = Date.now() + (tokens.expires_in * 1000); return this.accessToken; } } Security Considerations linkState Parameter linkAlways validate state parameter to prevent CSRF attacks:\n// Generate unique state const state = crypto.randomBytes(16).toString('hex'); session.state = state; // Validate in callback if (req.query.state !== session.state) { throw new Error('Invalid state parameter'); } PKCE linkAlways use PKCE, even with client secret:\nPrevents authorization code interception Required for public clients Recommended for all OAuth clients Secure Storage linkNever expose tokens to client-side JavaScript:\n// ❌ Bad - token in browser localStorage.setItem('token', access_token); // ✅ Good - token in server session session.tokens = { access_token, refresh_token }; Comparison with Other Flows link Feature Authorization Code Interactive Browser Device Code Browser Required Yes Yes No Backend Server Required Optional Optional Client Secret Yes No No Refresh Tokens Yes Yes Yes PKCE Recommended Required Required Best For Web apps Desktop apps Headless devices CLI Alternative linkFor command-line tools, use Interactive Browser Flow instead:\n# Interactive Browser (recommended for CLI) entra-auth-cli get-token --flow interactive # Opens browser, no redirect URI needed # Tokens handled automatically by CLI See Interactive Browser Flow for CLI-friendly user authentication.\nNext Steps link Interactive Browser Flow - CLI-friendly user authentication Device Code Flow - Authentication without local browser Security Best Practices - Secure your implementation "
            }
        );
    index.add(
            {
                id:  21 ,
                href: "\/docs\/user-guide\/generating-tokens\/",
                title: "Generating Tokens",
                description: "Request and obtain access tokens from Microsoft Entra ID",
                content: "Generating Tokens linkLearn how to generate access tokens using different OAuth2 flows and configurations.\nQuick Reference link Task Command Get token with profile entra-auth-cli get-token -p PROFILE Override scope entra-auth-cli get-token -p PROFILE --scope \"SCOPE\" Specify flow entra-auth-cli get-token -p PROFILE -f FLOW Silent mode entra-auth-cli get-token -p PROFILE --silent Save to file entra-auth-cli get-token -p PROFILE -o token.txt Refresh token entra-auth-cli refresh -p PROFILE Basic Token Generation linkUsing a Profile link entra-auth-cli get-token -p my-profile Output:\nAuthenticating with profile 'my-profile'... ✓ Token acquired successfully eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ij... What happens:\nProfile loaded from ~/.entra-auth-cli/profiles.json Secrets retrieved from secure storage Authentication flow executed Access token printed to stdout Specifying a Flow linkOverride the default flow:\nentra-auth-cli get-token -p my-profile -f ClientCredentials Available flows:\nClientCredentials AuthorizationCode DeviceCode InteractiveBrowser Learn about flows →\nClient Credentials Flow linkNon-Interactive Service Authentication link entra-auth-cli get-token -p service-principal -f ClientCredentials Requirements:\nClient secret or certificate configured Application permissions granted Admin consent completed Example:\n# Service principal for Graph API entra-auth-cli get-token -p graph-sp -f ClientCredentials Output:\n✓ Token acquired successfully eyJ0eXAiOiJKV1QiLCJh... Detailed guide →\nInteractive Browser Flow linkUser Authentication with Browser link entra-auth-cli get-token -p user-app -f InteractiveBrowser What happens:\nBrowser opens to Entra ID login page User enters credentials User consents to permissions (if required) Browser redirects to localhost with code Tool exchanges code for token Example:\nentra-auth-cli get-token -p personal-graph -f InteractiveBrowser Output:\nOpening browser for authentication... ✓ Authentication successful ✓ Token acquired eyJ0eXAiOiJKV1QiLCJh... Detailed guide →\nDevice Code Flow linkAuthentication on Limited-Input Devices link entra-auth-cli get-token -p iot-device -f DeviceCode What happens:\nTool displays code and URL User visits URL on another device User enters code User authenticates Tool polls and receives token Example:\nentra-auth-cli get-token -p headless-server -f DeviceCode Output:\nDevice Code Authentication To sign in, use a web browser to open: https://microsoft.com/devicelogin and enter the code: ABCD-1234 Waiting for authentication... ✓ Token acquired successfully Detailed guide →\nAuthorization Code Flow linkWeb Application Authentication link entra-auth-cli get-token -p webapp -f AuthorizationCode Requirements:\nRedirect URI configured in app registration Delegated permissions User credentials Example:\nentra-auth-cli get-token -p web-backend -f AuthorizationCode Output:\nOpening browser for authentication... Redirect URI: http://localhost:8080 ✓ Authorization code received ✓ Token acquired eyJ0eXAiOiJKV1QiLCJh... Detailed guide →\nScope Override linkRuntime Scope Specification linkOverride profile’s default scope:\nentra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read\" Use cases:\nDifferent operations need different permissions Testing with minimal scopes Temporary scope changes Multiple Scopes linkSpace-separated:\nentra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read Calendars.Read\" Comma-separated:\nentra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read,Mail.Read,Calendars.Read\" .default Scope linkRequest all configured permissions:\nentra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/.default\" Learn about scopes →\nCertificate Authentication linkUsing Certificates Instead of Secrets link entra-auth-cli get-token -p cert-profile -f ClientCredentials Profile configuration:\n{ \"name\": \"cert-profile\", \"clientId\": \"...\", \"tenantId\": \"...\", \"certificatePath\": \"/path/to/cert.pfx\", \"useCertificate\": true } Certificate password:\nStored securely in platform-specific storage Prompted once during profile creation Never stored in plaintext Advantages link✅ More secure than secrets\n✅ Longer validity periods\n✅ Better for automation\n✅ Certificate rotation support\nDetailed certificate guide →\nOutput Options linkSilent Mode linkSuppress all output except the token:\nentra-auth-cli get-token -p myprofile --silent Output:\neyJ0eXAiOiJKV1QiLCJh... Use in scripts:\nTOKEN=$(entra-auth-cli get-token -p myprofile --silent) curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/me Save to File link entra-auth-cli get-token -p myprofile -o token.txt Output:\n✓ Token saved to token.txt Use later:\nTOKEN=$(cat token.txt) curl -H \"Authorization: Bearer $TOKEN\" ... JSON Output link entra-auth-cli get-token -p myprofile --json Output:\n{ \"accessToken\": \"eyJ0eXAiOiJKV1QiLCJh...\", \"expiresOn\": \"2024-12-01T12:00:00Z\", \"tokenType\": \"Bearer\", \"scopes\": [\"https://graph.microsoft.com/.default\"] } Token Inspection linkInspect Token Claims link # Generate and inspect in one command entra-auth-cli get-token -p myprofile --silent | entra-auth-cli inspect Or separately:\nTOKEN=$(entra-auth-cli get-token -p myprofile --silent) entra-auth-cli inspect -t \"$TOKEN\" Output:\n{ \"aud\": \"https://graph.microsoft.com\", \"iss\": \"https://sts.windows.net/...\", \"iat\": 1701432000, \"exp\": 1701435600, \"appid\": \"12345678-1234-1234-1234-123456789abc\", \"scp\": \"User.Read Mail.Read\", \"roles\": [] } Learn about token inspection →\nToken Refresh linkRefreshing Expired Tokens linkIf you have a refresh token:\nentra-auth-cli refresh -p myprofile Requirements:\nOriginal token acquired with offline_access scope Refresh token stored in cache Output:\nRefreshing token for profile 'myprofile'... ✓ Token refreshed successfully eyJ0eXAiOiJKV1QiLCJh... Note: Client Credentials flow doesn’t support refresh tokens. Just request a new token instead.\nLearn about token refreshing →\nCommon Patterns linkPattern 1: Script Automation link #!/bin/bash set -e # Get token TOKEN=$(entra-auth-cli get-token -p automation --silent) # Use token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/users \\ | jq Pattern 2: Environment Variable link export ACCESS_TOKEN=$(entra-auth-cli get-token -p myprofile --silent) # Use in multiple commands curl -H \"Authorization: Bearer $ACCESS_TOKEN\" https://api1.example.com curl -H \"Authorization: Bearer $ACCESS_TOKEN\" https://api2.example.com Pattern 3: Token Caching link TOKEN_FILE=~/.cache/entra-auth-cli-token.txt # Check if token exists and is valid if [ ! -f \"$TOKEN_FILE\" ] || ! entra-auth-cli discover -f \"$TOKEN_FILE\" \u0026\u003e/dev/null; then entra-auth-cli get-token -p myprofile --silent \u003e \"$TOKEN_FILE\" fi TOKEN=$(cat \"$TOKEN_FILE\") Pattern 4: Multi-API Access link # Get tokens for different APIs TOKEN_GRAPH=$(entra-auth-cli get-token -p graph-profile --silent) TOKEN_AZURE=$(entra-auth-cli get-token -p azure-profile --silent) # Use with different APIs curl -H \"Authorization: Bearer $TOKEN_GRAPH\" https://graph.microsoft.com/v1.0/me curl -H \"Authorization: Bearer $TOKEN_AZURE\" https://management.azure.com/subscriptions Troubleshooting link“Profile not found” linkCause: Profile name is incorrect\nFix:\n# List profiles entra-auth-cli config list # Use correct name entra-auth-cli get-token -p correct-name “AADSTS70011: Invalid scope” linkCause: Requested scope is not configured in app registration\nFix:\nGo to Azure Portal → App registrations Select your app → API permissions Add the required permission Grant admin consent (if needed) “AADSTS7000215: Invalid client secret” linkCause: Client secret is expired or incorrect\nFix:\n# Rotate secret in Azure Portal # Update profile entra-auth-cli config edit -p myprofile # Select: Client Secret # Enter: new-secret “Insufficient privileges” linkCause: Token has scope but lacks underlying permission\nFix:\nVerify API permissions in Azure Portal Grant admin consent For users: Assign appropriate Azure AD role “Browser did not respond” linkCause: Browser authentication timed out\nFix:\nTry Device Code flow instead: entra-auth-cli get-token -p myprofile -f DeviceCode Check redirect URI configuration Ensure localhost port is not blocked Best Practices link✅ Use Appropriate Flows link Automation: Client Credentials User apps: Interactive Browser Headless/SSH: Device Code Web apps: Authorization Code ✅ Request Minimal Scopes link # ❌ Over-privileged --scope \"https://graph.microsoft.com/.default\" # ✓ Minimal --scope \"https://graph.microsoft.com/User.Read\" ✅ Handle Token Expiration link # Check expiration before use entra-auth-cli discover -f token.txt # Refresh if needed if [ $? -ne 0 ]; then entra-auth-cli get-token -p myprofile --silent \u003e token.txt fi ✅ Secure Token Storage link # Set restrictive permissions TOKEN_FILE=~/.cache/my-token.txt entra-auth-cli get-token -p myprofile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" ❌ Avoid link ❌ Hard-coding tokens ❌ Committing tokens to git ❌ Sharing tokens via email/Slack ❌ Using expired tokens ❌ Requesting excessive scopes Next Steps link Client Credentials Flow (Detailed) Interactive Browser Flow (Detailed) Working with Tokens Token Recipes "
            }
        );
    index.add(
            {
                id:  22 ,
                href: "\/docs\/platform-guides\/macos\/",
                title: "macOS",
                description: "macOS-specific configuration and Keychain integration",
                content: "macOS Platform Guide linkComplete guide for using Entra Auth Cli on macOS, including Keychain integration, Homebrew installation, and macOS-specific features.\nOverview linkEntra Auth Cli integrates seamlessly with macOS security features:\nKeychain Integration: Secure token storage in macOS Keychain Native Security: Leverages macOS security framework Homebrew Support: Easy installation and updates Shell Integration: Works with zsh, bash, and fish Installation linkUsing Homebrew link # Add tap (if not already added) brew tap garrardkitchen/entra-auth-cli # Install brew install entra-auth-cli # Update brew upgrade entra-auth-cli Manual Installation link # Download latest release VERSION=\"1.0.0\" curl -L \"https://github.com/garrardkitchen/entra-auth-cli/releases/download/v${VERSION}/entra-auth-cli-darwin-amd64\" \\ -o /usr/local/bin/entra-auth-cli # Make executable chmod +x /usr/local/bin/entra-auth-cli # Verify installation entra-auth-cli --version Intel vs Apple Silicon link # Apple Silicon (M1/M2/M3) curl -L \"https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-darwin-arm64\" \\ -o /usr/local/bin/entra-auth-cli # Intel (x86_64) curl -L \"https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-darwin-amd64\" \\ -o /usr/local/bin/entra-auth-cli # Universal Binary (works on both) curl -L \"https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-darwin-universal\" \\ -o /usr/local/bin/entra-auth-cli Token Storage linkmacOS Keychain linkTokens are securely stored in macOS Keychain:\n# Tokens stored in Keychain with: # - Service: com.garrardkitchen.entra-auth-cli # - Account: profile-name # - Kind: Application password # View in Keychain Access app open -a \"Keychain Access\" # Search for: entra-auth-cli Security characteristics:\nEncrypted by macOS security framework Protected by user login password Synchronized via iCloud Keychain (optional) Requires user authorization for access Keychain Access Management link # List Entra Auth Cli keychains security find-generic-password -s \"com.garrardkitchen.entra-auth-cli\" # View specific profile security find-generic-password -s \"com.garrardkitchen.entra-auth-cli\" -a \"default\" # Delete keychain entry security delete-generic-password -s \"com.garrardkitchen.entra-auth-cli\" -a \"default\" # Export keychain item (requires authorization) security export -k ~/Library/Keychains/login.keychain-db \\ -t identities -f pkcs12 -o export.p12 iCloud Keychain Sync linkEnable token sync across your Apple devices:\n# Check iCloud Keychain status security show-keychain-info ~/Library/Keychains/login.keychain-db # Tokens automatically sync if: # 1. iCloud Keychain is enabled in System Settings # 2. Same Apple ID on all devices # 3. Two-factor authentication enabled # View synced items # System Settings \u003e Passwords \u003e entra-auth-cli Shell Integration linkZsh (Default on macOS) link # Add to ~/.zshrc # Completion autoload -U compinit \u0026\u0026 compinit complete -o nospace -C entra-auth-cli entra-auth-cli # Aliases alias et='entra-auth-cli' alias etg='entra-auth-cli get-token' alias etp='entra-auth-cli list-profiles' # Function to get token get_token() { local profile=\"${1:-default}\" entra-auth-cli get-token --profile \"$profile\" --output json | jq -r .access_token } # Function to call Microsoft Graph graph_api() { local endpoint=\"$1\" local token=$(get_token) curl -s -H \"Authorization: Bearer $token\" \\ \"https://graph.microsoft.com/v1.0/$endpoint\" | jq . } Bash link # Add to ~/.bash_profile or ~/.bashrc # Completion complete -C entra-auth-cli entra-auth-cli # Aliases alias et='entra-auth-cli' alias etg='entra-auth-cli get-token' # Token helper export_token() { local profile=\"${1:-default}\" export ENTRA_TOKEN=$(entra-auth-cli get-token --profile \"$profile\" --output json | jq -r .access_token) echo \"Token exported to \\$ENTRA_TOKEN\" } Fish Shell link # Add to ~/.config/fish/config.fish # Completion complete -c entra-auth-cli -f # Aliases alias et='entra-auth-cli' alias etg='entra-auth-cli get-token' # Function function get_token set -l profile (test -n \"$argv[1]\"; and echo $argv[1]; or echo \"default\") entra-auth-cli get-token --profile $profile --output json | jq -r .access_token end macOS-Specific Features linkNotification Center link # Show notification on token refresh refresh_with_notification() { if entra-auth-cli refresh --profile \"$1\"; then osascript -e 'display notification \"Token refreshed successfully\" with title \"Entra Auth Cli\"' else osascript -e 'display notification \"Token refresh failed\" with title \"Entra Auth Cli\" sound name \"Basso\"' fi } # Usage refresh_with_notification production Launch Agent linkAutomate token refresh using Launch Agent:\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"\u003e Label com.entra-auth-cli.refresh ProgramArguments /usr/local/bin/entra-auth-cli refresh --profile production StartInterval 3600 RunAtLoad StandardErrorPath /tmp/entra-auth-cli-refresh.err StandardOutPath /tmp/entra-auth-cli-refresh.out # Load Launch Agent launchctl load ~/Library/LaunchAgents/com.entra-auth-cli.refresh.plist # Unload launchctl unload ~/Library/LaunchAgents/com.entra-auth-cli.refresh.plist # Check status launchctl list | grep entra-auth-cli # View logs tail -f /tmp/entra-auth-cli-refresh.out Spotlight Integration link # Add entra-auth-cli to Spotlight search # Create Alfred/Raycast workflow # Example: Alfred Workflow Script cat \u003c\u003c 'EOF' \u003e ~/Library/Application\\ Support/Alfred/Alfred.alfredpreferences/workflows/entra-auth-cli/get-token.sh #!/bin/bash profile=\"${1:-default}\" token=$(entra-auth-cli get-token --profile \"$profile\" --output json | jq -r .access_token) echo -n \"$token\" | pbcopy echo \"Token copied to clipboard!\" EOF chmod +x ~/Library/Application\\ Support/Alfred/Alfred.alfredpreferences/workflows/entra-auth-cli/get-token.sh Touch Bar Support link # Add Entra Auth Cli to Touch Bar using BetterTouchTool # Quick actions: # - Get Token (copies to clipboard) # - Refresh Token # - List Profiles Common Use Cases linkClipboard Integration link # Copy token to clipboard get_token_clipboard() { local profile=\"${1:-default}\" entra-auth-cli get-token --profile \"$profile\" --output json | \\ jq -r .access_token | \\ pbcopy echo \"✓ Token copied to clipboard\" } # Usage get_token_clipboard production # Use in next command curl -H \"Authorization: Bearer $(pbpaste)\" \\ https://graph.microsoft.com/v1.0/me Shortcuts Integration link -- Create macOS Shortcut for token retrieval on run set token to do shell script \"/usr/local/bin/entra-auth-cli get-token --output json | jq -r .access_token\" return token end run Script Menu link # Add to ~/Library/Scripts/ # Appears in Script menu (if enabled) #!/bin/bash # Get Entra Token.scpt osascript \u003c\u003c 'EOF' tell application \"Terminal\" activate do script \"entra-auth-cli get-token --flow interactive\" end tell EOF Automator Workflows link -- Automator Service: Get Entra Token on run {input, parameters} set token to do shell script \"/usr/local/bin/entra-auth-cli get-token --output json | jq -r .access_token\" set the clipboard to token display notification \"Token copied to clipboard\" with title \"Entra Auth Cli\" return input end run Security Best Practices linkFileVault Integration link # Ensure FileVault is enabled for disk encryption sudo fdesetup status # Enable if not active sudo fdesetup enable Keychain Security link # Set Keychain to lock after inactivity security set-keychain-settings -t 3600 ~/Library/Keychains/login.keychain-db # Require password after sleep sudo pmset -a destroyfvkeyonstandby 1 sudo pmset -a hibernatemode 25 sudo pmset -a powernap 0 sudo pmset -a standby 0 sudo pmset -a standbydelay 0 sudo pmset -a autopoweroff 0 Secure Profile Creation link # Use environment variables from secure source export TENANT_ID=$(security find-generic-password -s \"azure-tenant-id\" -w) export CLIENT_ID=$(security find-generic-password -s \"azure-client-id\" -w) export CLIENT_SECRET=$(security find-generic-password -s \"azure-client-secret\" -w) entra-auth-cli create-profile \\ --name secure-profile \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --client-secret \"$CLIENT_SECRET\" # Clear variables unset TENANT_ID CLIENT_ID CLIENT_SECRET Docker Integration linkDocker for Mac link # Use Entra Auth Cli from Docker container docker run -it --rm \\ -v ~/Library/Keychains:/root/Library/Keychains:ro \\ -e HOME=/root \\ ubuntu:22.04 bash # Inside container (Keychain available via volume mount) # Note: This is for illustration; prefer host authentication Docker Compose link version: '3.8' services: app: image: myapp:latest environment: - ENTRA_TOKEN_PROFILE=production volumes: - $HOME/.entra-auth-cli:/root/.entra-auth-cli:ro command: | sh -c \" TOKEN=$$(entra-auth-cli get-token --output json | jq -r .access_token) \u0026\u0026 ./myapp --token $$TOKEN \" Troubleshooting linkKeychain Access Prompt linkProblem: Repeated authorization prompts\nSolutions:\n# Allow entra-auth-cli always # Click \"Always Allow\" in Keychain prompt # Or programmatically: security set-generic-password-partition-list \\ -s com.garrardkitchen.entra-auth-cli \\ -k ~/Library/Keychains/login.keychain-db # Reset Keychain permissions security delete-generic-password -s \"com.garrardkitchen.entra-auth-cli\" entra-auth-cli get-token # Creates new entry Gatekeeper Warnings linkProblem: “entra-auth-cli cannot be opened because the developer cannot be verified”\nSolutions:\n# Remove quarantine attribute xattr -d com.apple.quarantine /usr/local/bin/entra-auth-cli # Or allow in System Settings # System Settings \u003e Privacy \u0026 Security \u003e Security # Click \"Allow Anyway\" next to blocked message # Verify removal xattr -l /usr/local/bin/entra-auth-cli Path Issues linkProblem: Command not found\nSolutions:\n# Check if installed which entra-auth-cli # Add to PATH in shell config echo 'export PATH=\"/usr/local/bin:$PATH\"' \u003e\u003e ~/.zshrc source ~/.zshrc # Or use Homebrew path echo 'export PATH=\"/opt/homebrew/bin:$PATH\"' \u003e\u003e ~/.zshrc # Apple Silicon echo 'export PATH=\"/usr/local/bin:$PATH\"' \u003e\u003e ~/.zshrc # Intel # Verify entra-auth-cli --version Architecture Mismatch linkProblem: “Bad CPU type in executable”\nSolutions:\n# Check system architecture uname -m # arm64 = Apple Silicon # x86_64 = Intel # Download correct version # Apple Silicon curl -L \".../entra-auth-cli-darwin-arm64\" -o /usr/local/bin/entra-auth-cli # Intel curl -L \".../entra-auth-cli-darwin-amd64\" -o /usr/local/bin/entra-auth-cli # Use Rosetta 2 (temporary workaround) arch -x86_64 /usr/local/bin/entra-auth-cli Performance Optimization linkToken Caching link # Cache token in memory for session export ENTRA_TOKEN_CACHE=$(entra-auth-cli get-token --output json) # Use cached token echo \"$ENTRA_TOKEN_CACHE\" | jq -r .access_token # Clear cache unset ENTRA_TOKEN_CACHE Parallel Requests link # Parallel API calls with GNU parallel TOKEN=$(entra-auth-cli get-token --output json | jq -r .access_token) parallel -j 4 \"curl -s -H 'Authorization: Bearer $TOKEN' {}\" ::: \\ \"https://graph.microsoft.com/v1.0/users\" \\ \"https://graph.microsoft.com/v1.0/groups\" \\ \"https://graph.microsoft.com/v1.0/applications\" \\ \"https://graph.microsoft.com/v1.0/servicePrincipals\" \\ | jq -s . Keychain Optimization link # Reduce Keychain search time # Create separate keychain for entra-auth-cli security create-keychain -p \"\" entra-auth-cli.keychain security set-keychain-settings entra-auth-cli.keychain security unlock-keychain entra-auth-cli.keychain # Add to search list security list-keychains -s entra-auth-cli.keychain login.keychain # Move tokens to dedicated keychain # (Requires manual reconfiguration) Advanced Features linkMenu Bar App link // SwiftUI Menu Bar App wrapper import SwiftUI import AppKit @main struct EntraTokenApp: App { @NSApplicationDelegateAdaptor(AppDelegate.self) var appDelegate var body: some Scene { Settings { EmptyView() } } } class AppDelegate: NSObject, NSApplicationDelegate { var statusItem: NSStatusItem! var menu: NSMenu! func applicationDidFinishLaunching(_ notification: Notification) { statusItem = NSStatusBar.system.statusItem(withLength: NSStatusItem.variableLength) statusItem.button?.title = \"🔑\" menu = NSMenu() menu.addItem(NSMenuItem(title: \"Get Token\", action: #selector(getToken), keyEquivalent: \"t\")) menu.addItem(NSMenuItem(title: \"Refresh\", action: #selector(refresh), keyEquivalent: \"r\")) menu.addItem(NSMenuItem.separator()) menu.addItem(NSMenuItem(title: \"Quit\", action: #selector(quit), keyEquivalent: \"q\")) statusItem.menu = menu } @objc func getToken() { let task = Process() task.launchPath = \"/usr/local/bin/entra-auth-cli\" task.arguments = [\"get-token\", \"--output\", \"json\"] let pipe = Pipe() task.standardOutput = pipe task.launch() let data = pipe.fileHandleForReading.readDataToEndOfFile() if let output = String(data: data, encoding: .utf8), let token = try? JSONDecoder().decode([String: String].self, from: output.data(using: .utf8)!)[\"access_token\"] { NSPasteboard.general.clearContents() NSPasteboard.general.setString(token, forType: .string) let notification = NSUserNotification() notification.title = \"Entra Token\" notification.informativeText = \"Token copied to clipboard\" NSUserNotificationCenter.default.deliver(notification) } } @objc func refresh() { // Implement refresh logic } @objc func quit() { NSApplication.shared.terminate(nil) } } Next Steps link Windows Platform Guide - Windows-specific features Linux Platform Guide - Linux-specific features Bash Scripts - Shell scripting examples Security Hardening - Security best practices "
            }
        );
    index.add(
            {
                id:  23 ,
                href: "\/docs\/core-concepts\/oauth2-flows\/",
                title: "OAuth2 Flows",
                description: "Understanding the four OAuth2 authentication flows",
                content: "OAuth2 Flows linkEntra Auth Cli supports four OAuth2 authentication flows. Each flow is designed for specific scenarios and security requirements.\nFlow Overview link Flow Use Case User Interaction Token Type Client Credentials Service-to-service None Application Authorization Code Web apps Required User + Application Device Code Limited-input devices Required (on another device) User Interactive Browser Desktop apps Required User Client Credentials Flow linkWhen to Use link Automated services and daemons CI/CD pipelines Background jobs without user context Service-to-service authentication How It Works link Application authenticates with client ID + secret (or certificate) Entra ID validates credentials Returns application-only access token Requirements link App registration with Application permissions (not Delegated) Admin consent granted Client secret or certificate Example link entra-auth-cli get-token -p service-principal -f ClientCredentials Full guide →\nAuthorization Code Flow linkWhen to Use link Web applications with user sign-in Apps requiring user context Multi-user scenarios Secure applications with confidential client How It Works link User is redirected to Entra ID sign-in page User authenticates and consents to permissions Entra ID returns authorization code Application exchanges code for access token Requirements link Redirect URI configured in app registration Delegated permissions User account credentials Example link entra-auth-cli get-token -p webapp -f AuthorizationCode Full guide →\nDevice Code Flow linkWhen to Use link Headless devices (IoT, servers) Limited-input devices (smart TVs, printers) SSH sessions Scenarios without browser access How It Works link Application requests device code User visits URL on another device and enters code Application polls Entra ID for token Token issued after user completes authentication Requirements link Device code flow enabled in app registration User account credentials Access to another device with browser Example link entra-auth-cli get-token -p iot-device -f DeviceCode Output:\nDevice Code Authentication To sign in, use a web browser to open https://microsoft.com/devicelogin and enter the code: ABCD-1234 Code: ABCD-1234 URL: https://microsoft.com/devicelogin Full guide →\nInteractive Browser Flow linkWhen to Use link Desktop applications Command-line tools with user authentication Personal productivity apps Interactive sessions How It Works link Application launches system browser User authenticates in browser Browser redirects to localhost with authorization code Application exchanges code for token Requirements link Redirect URI: http://localhost:{port} configured Delegated permissions User account credentials Browser availability Example link entra-auth-cli get-token -p desktop-app -f InteractiveBrowser Full guide →\nFlow Selection linkAutomatic Inference linkIf you don’t specify a flow with -f, the tool automatically infers based on your profile’s authentication method:\nClient Secret or Certificate → Client Credentials Other methods → Interactive Browser You can override this by setting a default flow in your profile or using the -f flag.\nSetting Default Flow linkWhen creating or editing a profile:\nentra-auth-cli config create # ... other prompts ... Set default OAuth2 flow? y Default OAuth2 flow: ClientCredentials Or specify at runtime:\nentra-auth-cli get-token -p myprofile -f DeviceCode Comparison Matrix linkUser Experience link Flow User Action Complexity Client Credentials None Simple Authorization Code Sign in + consent Moderate Device Code Sign in on another device Moderate Interactive Browser Sign in in browser Simple Security link Flow Security Level Best For Client Credentials High (with certificate) Automation Authorization Code High Web apps Device Code Medium Constrained devices Interactive Browser Medium-High User apps Token Properties link Flow Token Scope User Context Client Credentials Application No Authorization Code User + Application Yes Device Code User Yes Interactive Browser User Yes Common Scenarios linkScenario: Automated Azure Resource Management linkFlow: Client Credentials\nAuth: Certificate (recommended)\nScopes: https://management.azure.com/.default\nentra-auth-cli get-token -p azure-automation -f ClientCredentials Scenario: Personal Microsoft Graph Access linkFlow: Interactive Browser or Device Code\nAuth: No client secret needed (public client)\nScopes: https://graph.microsoft.com/User.Read\nentra-auth-cli get-token -p personal-graph -f InteractiveBrowser Scenario: CI/CD Pipeline linkFlow: Client Credentials\nAuth: Client Secret (stored in CI/CD secrets)\nScopes: API-specific scope\nentra-auth-cli get-token -p cicd-deployer -f ClientCredentials Troubleshooting link“This application requires user consent” link Flow: Use Authorization Code or Interactive Browser Permissions: Configure Delegated permissions, not Application permissions “Client credentials flow not supported” link Fix: Enable Application permissions and grant admin consent Alternative: Use user-interactive flow instead “Redirect URI mismatch” link Fix: Add exact redirect URI to app registration Format: http://localhost:8080 (include port) Next Steps link Detailed Client Credentials Guide Detailed Authorization Code Guide Detailed Device Code Guide Detailed Interactive Browser Guide Understand Scopes "
            }
        );
    index.add(
            {
                id:  24 ,
                href: "\/docs\/getting-started\/quickstart\/",
                title: "Quick Start",
                description: "Generate your first token in 5 minutes",
                content: "Quick Start linkGenerate your first Entra ID access token in just a few minutes!\nStep 1: Install the Tool link dotnet tool install -g EntraAuthCli See all installation options →\nStep 2: Create Your First Profile linkRun the interactive profile creation:\nentra-auth-cli config create You’ll be prompted for:\nProfile name: myprofile (or any name you choose) Tenant ID: Your Azure tenant ID (e.g., contoso.onmicrosoft.com or GUID) Client ID: Your app registration client ID Scopes: https://graph.microsoft.com/.default (default for Microsoft Graph) Auth method: Choose ClientSecret for this quick start Client secret: Your app’s client secret (securely stored) Example:\nProfile name: myprofile Tenant ID: contoso.onmicrosoft.com Client ID: 12345678-1234-1234-1234-123456789abc Scopes (comma-separated): https://graph.microsoft.com/.default Authentication method: ClientSecret Client secret: **** 💡 Tip: Don’t have an app registration? See the Complete Tutorial for step-by-step setup.\nStep 3: Generate a Token link entra-auth-cli get-token -p myprofile The tool will:\nAuthenticate using your profile credentials Request a token from Entra ID Display the token details Copy the token to your clipboard (if available) Expected output:\n✓ Token retrieved successfully Expires: 2025-12-26 15:30:00 UTC (59 minutes) Scopes: https://graph.microsoft.com/.default Token copied to clipboard! Step 4: Use Your Token linkThe token is now in your clipboard. Use it to call APIs:\n# Example: Get current user info from Microsoft Graph curl -H \"Authorization: Bearer YOUR_TOKEN_HERE\" \\ https://graph.microsoft.com/v1.0/me Or read from the token file in headless environments:\nTOKEN=$(cat ~/.config/entra-auth-cli/last-token.txt) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Step 5: Inspect the Token (Optional) linkWant to see what’s inside your token?\nentra-auth-cli inspect $(cat ~/.config/entra-auth-cli/last-token.txt) This decodes the JWT and displays claims like:\nAudience (aud) Issuer (iss) Subject (sub) Expiration (exp) Scopes (scp/roles) What’s Next? linkLearn the basics:\nAuthentication Profiles - Understand profiles OAuth2 Flows - Learn about different flows Scopes - Manage API permissions Explore features:\nManaging Profiles - Create, edit, export profiles Certificate Authentication - Use certificates instead of secrets Scope Overrides - Get tokens for different APIs Try recipes:\nService Principal Authentication Calling Microsoft Graph Custom APIs Troubleshooting linkToken generation fails?\nVerify your client ID and secret are correct Check app registration permissions in Azure Ensure tenant ID is correct Token not copied to clipboard?\nIn headless environments, use the file output Use --no-clipboard flag to suppress clipboard operations See full troubleshooting guide →\n"
            }
        );
    index.add(
            {
                id:  25 ,
                href: "\/docs\/reference\/refresh\/",
                title: "refresh",
                description: "Refresh expired access tokens using refresh tokens",
                content: "refresh linkRefresh expired or expiring access tokens using refresh tokens.\nSynopsis link entra-auth-cli refresh [flags] Description linkThe refresh command obtains a new access token using a previously acquired refresh token. This is useful when you have a long-running process that needs to maintain valid tokens without user interaction.\nRefresh tokens are only available when using delegated permissions (user authentication flows like interactive or device code).\nFlags linkCore Options link--profile, -p linkProfile name to refresh tokens for.\nentra-auth-cli refresh --profile production entra-auth-cli refresh -p dev Default: default\n--output, -o linkOutput format for the new token.\nentra-auth-cli refresh --output json entra-auth-cli refresh -o yaml Options:\ntoken - Just the access token (default) json - Full token response as JSON yaml - Full token response as YAML --silent, -q linkSuppress all output except the token.\nTOKEN=$(entra-auth-cli refresh --silent) Examples linkBasic Usage link # Refresh default profile entra-auth-cli refresh # Refresh specific profile entra-auth-cli refresh --profile production Output Formats link # Token only entra-auth-cli refresh # Full JSON response entra-auth-cli refresh --output json # Get new access token in variable TOKEN=$(entra-auth-cli refresh --silent) Script Usage link #!/bin/bash # Check if token needs refresh if ! entra-auth-cli inspect --profile myapp 2\u003e/dev/null; then echo \"Token expired, refreshing...\" entra-auth-cli refresh --profile myapp fi # Use refreshed token TOKEN=$(entra-auth-cli get-token --profile myapp --silent) Requirements linkRefresh Token Availability linkRefresh tokens are only available with:\nInteractive Browser Flow Device Code Flow Authorization Code Flow (web apps) Refresh tokens are NOT available with:\nClient Credentials Flow (service-to-service) Offline Access Scope linkFor refresh tokens to work, the offline_access scope must be included:\n# When creating profile entra-auth-cli config create --scope \"User.Read offline_access\" # When getting initial token entra-auth-cli get-token --scope \"User.Read offline_access\" How It Works link CLI retrieves stored refresh token for profile Sends refresh token to Microsoft Entra ID Receives new access token (and possibly new refresh token) Updates cached tokens Returns new access token Output linkSame formats as get-token:\nDefault (Token Only) link eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1yNS1BVW... JSON Format link { \"token_type\": \"Bearer\", \"scope\": \"User.Read Mail.Read\", \"expires_in\": 3599, \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\", \"refresh_token\": \"0.ARoAv4j5cvGGr...\", \"expires_at\": \"2025-12-28T16:30:00Z\" } Exit Codes link Code Description 0 Success 1 General error 2 Profile not found 3 No refresh token available 4 Refresh token expired/invalid 5 Network error Common Use Cases linkLong-Running Process link #!/bin/bash set -euo pipefail # Initial authentication entra-auth-cli get-token --profile daemon --flow interactive # Main loop while true; do # Get token (uses cache if valid) TOKEN=$(entra-auth-cli get-token --profile daemon --silent) # Do work with token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me # Check if token expires soon EXPIRES=$(entra-auth-cli inspect --profile daemon --output json | jq -r .exp) NOW=$(date +%s) # Refresh if expiring within 5 minutes if [ $((EXPIRES - NOW)) -lt 300 ]; then echo \"Token expiring soon, refreshing...\" entra-auth-cli refresh --profile daemon fi sleep 60 done Proactive Refresh link #!/bin/bash # Refresh before token expires refresh_if_needed() { local profile=\"${1:-default}\" if entra-auth-cli inspect --profile \"$profile\" \u0026\u003e/dev/null; then local expires=$(entra-auth-cli inspect --profile \"$profile\" --output json | jq -r .exp) local now=$(date +%s) local remaining=$((expires - now)) # Refresh if less than 10 minutes remaining if [ $remaining -lt 600 ]; then echo \"Refreshing token (expires in ${remaining}s)...\" entra-auth-cli refresh --profile \"$profile\" fi else echo \"Token invalid or expired, refreshing...\" entra-auth-cli refresh --profile \"$profile\" fi } # Usage refresh_if_needed production TOKEN=$(entra-auth-cli get-token --profile production --silent) Scheduled Refresh link # Cron job to refresh tokens periodically # Add to crontab: crontab -e # Refresh every 30 minutes */30 * * * * /usr/local/bin/entra-auth-cli refresh --profile background-job # Refresh at specific times 0 8,12,17 * * * /usr/local/bin/entra-auth-cli refresh --profile work-hours Troubleshooting linkNo Refresh Token Available linkProblem:\n$ entra-auth-cli refresh --profile myapp Error: no refresh token available for profile 'myapp' Cause: Profile uses client credentials flow (no refresh tokens)\nSolution:\n# Client credentials profiles don't need refresh # Just get a new token instead entra-auth-cli get-token --profile myapp Refresh Token Expired linkProblem:\n$ entra-auth-cli refresh --profile user-app Error: refresh token expired or invalid Solutions:\n# 1. Re-authenticate with user flow entra-auth-cli get-token --profile user-app --flow interactive --force # 2. Or recreate profile entra-auth-cli config delete --name user-app entra-auth-cli config create --name user-app entra-auth-cli get-token --profile user-app --flow interactive Missing offline_access Scope linkProblem: Refresh token not provided by Entra ID\nSolution:\n# Include offline_access scope entra-auth-cli get-token --profile myapp \\ --scope \"User.Read offline_access\" \\ --flow interactive # Or update profile default scopes entra-auth-cli config edit --name myapp # Add \"offline_access\" to scopes Automatic Refresh linkThe CLI automatically refreshes tokens when calling get-token if:\nAccess token is expired or expiring soon Refresh token is available Profile was authenticated with user flow # First call - token expired, automatically refreshes entra-auth-cli get-token --profile myapp # You usually don't need to call refresh manually # The get-token command handles it automatically When to Use refresh Explicitly linkExplicit refresh is useful when:\nProactive refresh before expiration\n# Refresh before starting long operation entra-auth-cli refresh --profile myapp ./long-running-task.sh Testing refresh token validity\nif entra-auth-cli refresh --profile myapp; then echo \"Refresh token is valid\" else echo \"Need to re-authenticate\" fi Background refresh jobs\n# Keep tokens fresh in background while true; do entra-auth-cli refresh --profile daemon sleep 1800 # Every 30 minutes done Refresh Token Lifetime linkRefresh token lifetimes vary based on configuration:\nType Typical Lifetime Public Client 90 days inactive / 24 hours active Web App 90 days inactive / Until revoked Conditional Access May require re-auth periodically Note: Refresh tokens can be revoked by:\nUser password change Admin action Security policies Conditional Access policies Security Considerations linkRefresh Token Security link # Refresh tokens are sensitive credentials # - Never log or expose them # - Store securely (CLI handles this) # - Don't share across systems # ✅ Good - CLI manages storage entra-auth-cli refresh --profile myapp # ❌ Bad - exposing refresh token export REFRESH_TOKEN=$(...) # Don't do this Token Rotation link # Some configurations rotate refresh tokens # Old refresh token becomes invalid after use # CLI handles this automatically entra-auth-cli refresh --profile myapp # CLI stores new refresh token automatically See Also link get-token - Generate access tokens inspect - Decode and inspect tokens OAuth Flows - Authentication flow details Generating Tokens - Token generation guide "
            }
        );
    index.add(
            {
                id:  26 ,
                href: "\/docs\/user-guide\/",
                title: "User Guide",
                description: "Complete guide to using Entra Auth Cli",
                content: "User Guide linkComprehensive guides for day-to-day usage of Entra Auth Cli.\nGetting Started linkIf you’re new to Entra Auth Cli, start here:\nInstallation - Install the tool on your platform Quick Start - Generate your first token in 5 minutes First Token Tutorial - Step-by-step from Azure to token Core Tasks linkManaging Profiles linkAuthentication profiles store your configuration for connecting to Microsoft Entra ID.\nManaging Profiles →\nLearn how to:\nCreate new profiles with interactive prompts List and view all configured profiles Edit existing profile settings Delete profiles and associated secrets Export profiles for backup Import profiles from files Organize profiles by environment Generating Tokens linkRequest access tokens using different OAuth2 flows and configurations.\nGenerating Tokens →\nLearn how to:\nGenerate tokens with client credentials flow Authenticate users with interactive browser Use device code for limited-input devices Override scopes at runtime Work with certificate authentication Handle different OAuth2 flows Automate token generation Working with Tokens linkInspect, validate, refresh, and use tokens effectively.\nWorking with Tokens →\nLearn how to:\nInspect JWT token claims Discover token information quickly Validate token expiration Refresh expired tokens Use tokens with Microsoft Graph Use tokens with Azure Management API Handle token expiration in scripts Store tokens securely By Scenario linkFor Developers linkBuilding applications:\nInteractive user authentication Inspecting token claims Testing different scopes API integration:\nMicrosoft Graph API access Azure Management API Custom API integration For DevOps Engineers linkAutomation:\nService principal setup Client credentials flow CI/CD integration Certificates:\nCertificate authentication Certificate rotation Secure certificate storage For System Administrators linkMulti-environment management:\nOrganizing profiles Profile export/import Secret rotation Security:\nSecure storage Security hardening Production deployment Common Workflows linkDaily Development link # Morning: Get fresh token entra-auth-cli get-token -p dev-graph --silent \u003e ~/.cache/token.txt # Use throughout the day TOKEN=$(cat ~/.cache/token.txt) curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/me Multi-Environment Testing link # Test in dev entra-auth-cli get-token -p dev-api -f ClientCredentials # Test in staging entra-auth-cli get-token -p staging-api -f ClientCredentials # Deploy to prod entra-auth-cli get-token -p prod-api -f ClientCredentials Secret Rotation link # 1. Generate new secret in Azure Portal # 2. Update profile entra-auth-cli config edit -p my-service-principal # Select: Client Secret # Enter: new-secret-from-portal # 3. Test entra-auth-cli get-token -p my-service-principal # 4. Delete old secret in Azure Portal Team Onboarding link # Team lead: Export profiles (without secrets) entra-auth-cli config export -o team-profiles.json # Share team-profiles.json via secure channel # Share secrets via Azure Key Vault or password manager # New team member: Import entra-auth-cli config import -f team-profiles.json # Add secrets entra-auth-cli config edit -p profile1 # Add client secret from Key Vault Quick Command Reference link Task Command Profiles Create profile entra-auth-cli config create List profiles entra-auth-cli config list Edit profile entra-auth-cli config edit -p NAME Delete profile entra-auth-cli config delete -p NAME Export profile entra-auth-cli config export -p NAME -o FILE Import profile entra-auth-cli config import -f FILE Tokens Get token entra-auth-cli get-token -p PROFILE Override scope entra-auth-cli get-token -p PROFILE --scope \"SCOPE\" Specify flow entra-auth-cli get-token -p PROFILE -f FLOW Silent output entra-auth-cli get-token -p PROFILE --silent Save to file entra-auth-cli get-token -p PROFILE -o token.txt Refresh token entra-auth-cli refresh -p PROFILE Token Info Inspect token entra-auth-cli inspect -t TOKEN Discover info entra-auth-cli discover -t TOKEN Check expiration entra-auth-cli discover -t TOKEN Advanced Topics linkOAuth2 Flows linkUnderstanding when to use each flow:\nClient Credentials - Service-to-service Authorization Code - Web applications Device Code - Limited-input devices Interactive Browser - Desktop apps Certificate Authentication linkUsing certificates for enhanced security:\nGetting Started with Certificates Creating Certificates Certificate Storage Certificate Rotation Platform-Specific Guides linkPlatform considerations and best practices:\nWindows Guide macOS Guide Linux Guide - ⚠️ Security warnings Troubleshooting linkCommon issues and solutions:\nProfile Issues Authentication Failures Token Problems Permission Errors Certificate Issues Next Steps linkLearn Core Concepts link Authentication Profiles OAuth2 Flows Scopes \u0026 Permissions Secure Storage Explore Recipes link Microsoft Graph Integration Azure Management CI/CD Integration Security Hardening Reference link Command Reference Configuration Reference API Reference "
            }
        );
    index.add(
            {
                id:  27 ,
                href: "\/docs\/oauth-flows\/device-code\/",
                title: "Device Code Flow",
                description: "Authentication for devices without browsers or limited input",
                content: "Device Code Flow linkThe Device Code flow enables authentication on devices that lack a web browser or have limited input capabilities. Users sign in on a separate device (like their phone or computer) while the original device polls for authentication completion.\nOverview linkUse this flow when:\nDevice doesn’t have a web browser Limited input capabilities (e.g., smart TV, IoT device) Working in SSH/remote terminal sessions Browser-based authentication isn’t practical How it works:\nDevice requests a user code User visits URL on another device User enters code and signs in Original device receives tokens Quick Start link # Start device code authentication entra-auth-cli get-token --flow device-code --profile myapp Output:\nTo sign in, use a web browser to open the page: https://microsoft.com/devicelogin And enter the code: ABCD-EFGH Waiting for authentication... Configuration linkProfile Setup linkCreate a profile for device code flow:\nentra-auth-cli create-profile --name device-app Profile configuration:\nTenant ID: Your Microsoft Entra tenant Client ID: Public client application Default Flow: device-code (optional) Scopes: Delegated permissions Azure App Registration linkConfigure your app registration for device code flow:\nApplication Type: Public client Platform Configuration: Enable “Mobile and desktop applications” No redirect URI needed API Permissions: Add delegated permissions (not application permissions) Example: User.Read, Mail.Read # Create public client app az ad app create \\ --display-name \"Device Code App\" \\ --sign-in-audience AzureADMyOrg \\ --enable-access-token-issuance true # Configure as public client az ad app update \\ --id \\ --is-fallback-public-client true Usage Examples linkBasic Authentication link # Using default profile entra-auth-cli get-token --flow device-code # Using specific profile entra-auth-cli get-token --flow device-code --profile production # With custom scopes entra-auth-cli get-token --flow device-code \\ --scope https://graph.microsoft.com/User.Read In Scripts link #!/bin/bash set -euo pipefail echo \"Authenticating with Microsoft Entra ID...\" echo \"Please complete the sign-in process on another device.\" echo # Start device code flow if ! TOKEN=$(entra-auth-cli get-token --flow device-code --output json); then echo \"Authentication failed\" \u003e\u00262 exit 1 fi # Extract access token ACCESS_TOKEN=$(echo \"$TOKEN\" | jq -r .access_token) # Use the token echo \"Authentication successful!\" echo \"Fetching user profile...\" curl -s -H \"Authorization: Bearer $ACCESS_TOKEN\" \\ https://graph.microsoft.com/v1.0/me \\ | jq . SSH Sessions linkPerfect for remote terminal sessions:\n# On remote server via SSH ssh user@server # Authenticate using device code entra-auth-cli get-token --flow device-code # Complete sign-in on your local computer/phone # Remote session receives token automatically User Experience linkAuthentication Flow link User runs command: $ entra-auth-cli get-token --flow device-code CLI displays: ┌─────────────────────────────────────────────────────┐ │ Device Code Authentication │ ├─────────────────────────────────────────────────────┤ │ 1. Visit: https://microsoft.com/devicelogin │ │ 2. Enter code: ABCD-EFGH │ │ 3. Sign in with your credentials │ ├─────────────────────────────────────────────────────┤ │ Waiting for authentication... (expires in 15 min) │ │ Press Ctrl+C to cancel │ └─────────────────────────────────────────────────────┘ [Polling dots animation...] ✓ Authentication successful! Token saved to profile 'default' On Separate Device linkUser navigates to https://microsoft.com/devicelogin:\nEnter Code: ABCD-EFGH Sign In: Microsoft credentials MFA (if required): Complete additional verification Consent: Approve permissions (first time only) Confirmation: “You have signed in to the application on your device” Advanced Usage linkCustom Timeout linkDevice codes expire after 15 minutes by default:\n# Check token expiry entra-auth-cli get-token --flow device-code --output json \\ | jq '.expires_at' # The CLI handles timeout automatically # User sees: \"Device code expired. Please try again.\" Polling Interval linkThe CLI polls Microsoft Entra ID while waiting for user authentication:\nDefault: 5-second intervals Respects Microsoft’s rate limits Shows progress indicators Cancellation linkUser can cancel at any time:\n# Press Ctrl+C during polling ^C Authentication cancelled by user Integration Examples linkDocker Containers link FROM ubuntu:22.04 RUN apt-get update \u0026\u0026 apt-get install -y curl jq # Install Entra Auth Cli RUN curl -L https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 \\ -o /usr/local/bin/entra-auth-cli \u0026\u0026 \\ chmod +x /usr/local/bin/entra-auth-cli COPY entrypoint.sh /entrypoint.sh RUN chmod +x /entrypoint.sh ENTRYPOINT [\"/entrypoint.sh\"] #!/bin/bash # entrypoint.sh echo \"Authenticating container...\" entra-auth-cli get-token --flow device-code --profile container # Run application with token exec \"$@\" IoT Devices link import subprocess import json def authenticate_device(): \"\"\"Authenticate IoT device using device code flow.\"\"\" print(\"Starting device authentication...\") # Start device code flow result = subprocess.run( [\"entra-auth-cli\", \"get-token\", \"--flow\", \"device-code\", \"--output\", \"json\"], capture_output=True, text=True ) if result.returncode != 0: raise Exception(\"Authentication failed\") token_data = json.loads(result.stdout) return token_data['access_token'] def send_telemetry(token, data): \"\"\"Send telemetry data to Azure.\"\"\" import requests response = requests.post( \"https://api.example.com/telemetry\", headers={\"Authorization\": f\"Bearer {token}\"}, json=data ) return response.status_code == 200 # Main IoT application if __name__ == \"__main__\": # Authenticate once access_token = authenticate_device() # Send data while True: data = collect_sensor_data() send_telemetry(access_token, data) time.sleep(60) Raspberry Pi link #!/bin/bash # raspberry-pi-auth.sh PROFILE=\"raspberry-pi\" TOKEN_FILE=\"/home/pi/.entra-auth-cli-cache\" # Create profile if it doesn't exist if ! entra-auth-cli list-profiles | grep -q \"$PROFILE\"; then echo \"Creating profile for Raspberry Pi...\" entra-auth-cli create-profile \\ --name \"$PROFILE\" \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --scope \"https://graph.microsoft.com/User.Read\" fi # Authenticate using device code echo \"Please sign in using another device...\" entra-auth-cli get-token --flow device-code --profile \"$PROFILE\" # Cache token for application entra-auth-cli get-token --profile \"$PROFILE\" --output json \u003e \"$TOKEN_FILE\" echo \"Authentication complete! Starting application...\" python3 /home/pi/app/main.py Security Considerations linkPublic Client linkDevice code flow uses public client apps:\nNo client secret required Cannot securely store secrets Uses only client ID for authentication User Consent linkUsers must consent to permissions:\n# First-time authentication requires consent entra-auth-cli get-token --flow device-code # Subsequent authentications (same user): # - No consent required if permissions unchanged # - Cached credentials may be reused Token Security linkProtect access tokens after authentication:\n# ❌ Bad - token exposed in command curl -H \"Authorization: Bearer $(entra-auth-cli get-token --output json | jq -r .access_token)\" ... # ✅ Good - token in variable TOKEN=$(entra-auth-cli get-token --output json | jq -r .access_token) # Use $TOKEN in scripts, not exposed in process list Timeout Security link Codes expire after 15 minutes Prevents old codes from being used Forces fresh authentication for security Troubleshooting linkCode Expired linkProblem: “Device code has expired”\nSolution: Run the command again to get a new code:\n# Code expires after 15 minutes entra-auth-cli get-token --flow device-code Wrong Code Entered linkProblem: “Invalid device code”\nSolution:\nDouble-check the code (case-sensitive) Ensure no extra spaces Request new code if needed Cancelled Authentication linkProblem: Polling stopped but didn’t complete sign-in\nSolution:\n# Start over with fresh code entra-auth-cli get-token --flow device-code Permissions Denied linkProblem: “User does not have permission”\nSolution:\nCheck Azure app registration permissions Ensure delegated permissions (not application) User must have required role/permissions in Entra ID # Verify required permissions in Azure az ad app permission list --id Comparison with Other Flows link Feature Device Code Interactive Browser Client Credentials Browser Required On separate device Yes, local No User Interaction Sign in on another device Sign in locally None Input Limitations Works with limited input Requires keyboard N/A Auth Type Delegated Delegated Application Refresh Tokens Yes Yes No (always valid) Best For Headless devices, SSH Desktop apps Automation, services Best Practices linkClear Instructions linkProvide clear guidance to users:\ncat \u003c\u003c 'EOF' ╔════════════════════════════════════════════════════╗ ║ DEVICE AUTHENTICATION ║ ╠════════════════════════════════════════════════════╣ ║ This application needs permission to access your ║ ║ Microsoft account. ║ ║ ║ ║ Steps: ║ ║ 1. Grab your phone or another computer ║ ║ 2. Open a web browser ║ ║ 3. Follow the instructions below ║ ╚════════════════════════════════════════════════════╝ EOF entra-auth-cli get-token --flow device-code Error Handling link authenticate_with_retry() { local max_attempts=3 local attempt=1 while [ $attempt -le $max_attempts ]; do echo \"Authentication attempt $attempt of $max_attempts...\" if entra-auth-cli get-token --flow device-code --profile \"$1\"; then echo \"✓ Authentication successful\" return 0 fi if [ $attempt -lt $max_attempts ]; then echo \"Authentication failed. Retrying...\" sleep 5 fi attempt=$((attempt + 1)) done echo \"✗ Authentication failed after $max_attempts attempts\" \u003e\u00262 return 1 } authenticate_with_retry \"myapp\" Progress Feedback linkKeep users informed during polling:\n# CLI provides automatic progress indicators # Example output: Waiting for authentication... ⠋ # Updates every second with spinner animation Next Steps link Interactive Browser Flow - Alternative user authentication Client Credentials Flow - Service authentication Platform Guides - Platform-specific authentication Troubleshooting - Common authentication issues "
            }
        );
    index.add(
            {
                id:  28 ,
                href: "\/docs\/getting-started\/first-token\/",
                title: "First Token Tutorial",
                description: "Complete end-to-end guide from Azure setup to token generation",
                content: "Your First Token - Complete Tutorial linkThis tutorial walks you through the complete process from setting up an app registration in Azure to generating your first token.\nPrerequisites link Azure subscription with access to create app registrations Entra Auth Cli installed (Installation Guide) Basic understanding of Azure and authentication concepts Step 1: Create an App Registration link1.1 Navigate to Azure Portal link Go to Azure Portal Navigate to Azure Active Directory (or Microsoft Entra ID) Select App registrations from the left menu Click New registration 1.2 Register Your Application linkFill in the registration form:\nName: entra-auth-cli-demo (or your preferred name) Supported account types: Select “Accounts in this organizational directory only” for single tenant Or choose multi-tenant if needed Redirect URI: Leave blank for now (we’ll add later if needed) Click Register\n1.3 Note Your IDs linkAfter registration, save these values:\nApplication (client) ID: Found on the Overview page Directory (tenant) ID: Also on the Overview page Step 2: Create a Client Secret link2.1 Generate Secret link In your app registration, go to Certificates \u0026 secrets Click New client secret Add a description: entra-auth-cli-demo-secret Choose expiration: 6 months for testing 24 months for longer-term use Click Add 2.2 Copy the Secret link⚠️ Important: Copy the secret Value immediately - it won’t be shown again!\nStep 3: Configure API Permissions link3.1 Add Permissions link Go to API permissions in your app registration Click Add a permission Select Microsoft Graph Choose Application permissions (for service-to-service) Search for and add these permissions: User.Read.All (to read user information) Or any other permissions your application needs 3.2 Grant Admin Consent link Click Grant admin consent for [Your Organization] Confirm by clicking Yes 💡 Note: Admin consent is required for application permissions\nStep 4: Create Your Profile linkNow that your Azure app is configured, create a profile in entra-auth-cli:\nentra-auth-cli config create Enter the following when prompted:\nProfile name: demo-profile Tenant ID: YOUR-TENANT-ID Client ID: YOUR-CLIENT-ID Scopes (comma-separated): https://graph.microsoft.com/.default Authentication method: ClientSecret Client secret: YOUR-CLIENT-SECRET Set default OAuth2 flow? n Configure custom redirect URI? n Success! Your profile is created and the secret is securely stored.\nStep 5: Generate Your First Token link entra-auth-cli get-token -p demo-profile You should see output like:\n✓ Token retrieved successfully Expires: 2025-12-26 15:30:00 UTC (59 minutes) Scopes: https://graph.microsoft.com/.default Token Type: Bearer Token copied to clipboard! Step 6: Verify Your Token link6.1 Inspect the Token link entra-auth-cli inspect $(cat ~/.config/entra-auth-cli/last-token.txt) This shows the decoded JWT claims, including:\naud: Audience (should be https://graph.microsoft.com) iss: Issuer (your Azure tenant) app_displayname: Your app name roles: Assigned application permissions exp: Expiration timestamp 6.2 Use the Token linkTest your token with Microsoft Graph:\nTOKEN=$(cat ~/.config/entra-auth-cli/last-token.txt) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/users?$top=5 You should receive a JSON response with user data!\nTroubleshooting link“Invalid client secret” link Verify you copied the secret value (not the secret ID) Check if the secret has expired Regenerate the secret if needed “Insufficient privileges” link Ensure you granted admin consent for the permissions Verify the permissions are Application permissions, not Delegated permissions Wait a few minutes for changes to propagate “Token request failed” link Double-check tenant ID and client ID Ensure network connectivity to Azure Check if your Azure subscription is active What’s Next? linkExplore different flows:\nAuthorization Code Flow - For user authentication Device Code Flow - For limited-input devices Interactive Browser - For desktop applications Learn about features:\nScope Management - Using tokens for different APIs Certificate Authentication - Using certificates instead of secrets Profile Management - Managing multiple profiles Try recipes:\nCalling Microsoft Graph - Common Graph API scenarios Custom APIs - Access your own APIs CI/CD Integration - Use in automated pipelines "
            }
        );
    index.add(
            {
                id:  29 ,
                href: "\/docs\/reference\/inspect\/",
                title: "inspect",
                description: "Decode and inspect JWT access tokens",
                content: "inspect linkDecode and inspect JWT (JSON Web Token) access tokens to view claims, expiration, and other metadata.\nSynopsis link entra-auth-cli inspect [flags] Description linkThe inspect command decodes JWT tokens and displays their contents in a human-readable format. This is useful for debugging authentication issues, verifying token claims, and checking expiration times.\nThe command can inspect:\nTokens from profiles (cached tokens) Tokens from stdin Tokens from files Tokens passed as arguments Flags linkInput Options link--profile, -p linkInspect token from a profile.\nentra-auth-cli inspect --profile production entra-auth-cli inspect -p dev --token, -t linkInspect a specific token string.\nentra-auth-cli inspect --token \"eyJ0eXAiOiJKV1QiLCJh...\" --file, -f linkRead token from a file.\nentra-auth-cli inspect --file token.txt Output Options link--output, -o linkOutput format.\nentra-auth-cli inspect --output json entra-auth-cli inspect -o yaml Options:\npretty - Human-readable format (default) json - JSON format yaml - YAML format --claims linkShow only the claims (payload).\nentra-auth-cli inspect --claims --header linkShow only the token header.\nentra-auth-cli inspect --header Examples linkBasic Usage link # Inspect token from profile entra-auth-cli inspect --profile myapp # Inspect specific token entra-auth-cli inspect --token \"eyJ0eXAiOiJKV1Qi...\" # Inspect token from file entra-auth-cli inspect --file access_token.txt # Inspect token from stdin entra-auth-cli get-token | entra-auth-cli inspect Output Formats link # Human-readable (default) entra-auth-cli inspect --profile myapp # JSON format entra-auth-cli inspect --profile myapp --output json # YAML format entra-auth-cli inspect --profile myapp --output yaml # Only claims entra-auth-cli inspect --profile myapp --claims # Only header entra-auth-cli inspect --profile myapp --header Script Usage link # Check token expiration EXPIRY=$(entra-auth-cli inspect --profile myapp --output json | jq -r .exp) NOW=$(date +%s) if [ $EXPIRY -lt $NOW ]; then echo \"Token expired!\" exit 1 fi # Get specific claim TENANT=$(entra-auth-cli inspect --profile myapp --output json | jq -r .tid) echo \"Tenant ID: $TENANT\" # Check if token has required scope SCOPES=$(entra-auth-cli inspect --profile myapp --output json | jq -r '.scp // .roles | join(\" \")') if [[ \"$SCOPES\" =~ \"User.Read\" ]]; then echo \"Token has User.Read permission\" fi Output linkPretty Format (Default) link Token Type: Bearer Algorithm: RS256 Header: typ: JWT alg: RS256 kid: M5-AUWRy... Claims: aud: https://graph.microsoft.com iss: https://sts.windows.net/12345678-1234-1234-1234-123456789012/ iat: 1703779200 nbf: 1703779200 exp: 1703782800 sub: AAAAAAAAAAAAAAAAAAAAAArQICAg tid: 12345678-1234-1234-1234-123456789012 oid: 87654321-4321-4321-4321-210987654321 upn: user@contoso.com name: John Doe scp: User.Read Mail.Read Expiration: Issued At: 2025-12-28 14:00:00 UTC Not Before: 2025-12-28 14:00:00 UTC Expires At: 2025-12-28 15:00:00 UTC Valid For: 42 minutes JSON Format link { \"header\": { \"typ\": \"JWT\", \"alg\": \"RS256\", \"kid\": \"M5-AUWRy...\" }, \"claims\": { \"aud\": \"https://graph.microsoft.com\", \"iss\": \"https://sts.windows.net/12345678-1234-1234-1234-123456789012/\", \"iat\": 1703779200, \"nbf\": 1703779200, \"exp\": 1703782800, \"sub\": \"AAAAAAAAAAAAAAAAAAAAAArQICAg\", \"tid\": \"12345678-1234-1234-1234-123456789012\", \"oid\": \"87654321-4321-4321-4321-210987654321\", \"upn\": \"user@contoso.com\", \"name\": \"John Doe\", \"scp\": \"User.Read Mail.Read\" }, \"signature\": \"FMh3r8...\", \"expires_in\": 2520 } Common Claims linkStandard JWT Claims link Claim Description iss Issuer (Microsoft Entra ID) aud Audience (target API) sub Subject (user/app identifier) exp Expiration time (Unix timestamp) nbf Not before time (Unix timestamp) iat Issued at time (Unix timestamp) Microsoft-Specific Claims link Claim Description tid Tenant ID oid Object ID (user/app) upn User Principal Name name Display name scp Scopes (delegated permissions) roles Roles (application permissions) appid Application ID ver Token version Use Cases linkVerify Token Expiration link #!/bin/bash check_token_valid() { local profile=\"$1\" if ! output=$(entra-auth-cli inspect --profile \"$profile\" --output json 2\u003e\u00261); then echo \"No valid token for $profile\" return 1 fi local exp=$(echo \"$output\" | jq -r .exp) local now=$(date +%s) if [ $exp -le $now ]; then echo \"Token expired\" return 1 fi local remaining=$((exp - now)) echo \"Token valid for $remaining seconds\" return 0 } # Usage if check_token_valid production; then echo \"Proceeding with API call\" else echo \"Need to refresh token\" entra-auth-cli refresh --profile production fi Extract Specific Claims link # Get tenant ID TENANT_ID=$(entra-auth-cli inspect --profile myapp --output json | jq -r .tid) # Get user email USER_EMAIL=$(entra-auth-cli inspect --profile myapp --output json | jq -r .upn) # Get scopes SCOPES=$(entra-auth-cli inspect --profile myapp --output json | jq -r .scp) # Get expiration EXPIRES=$(entra-auth-cli inspect --profile myapp --output json | jq -r .exp) EXPIRES_HR=$(date -r $EXPIRES) echo \"Token expires: $EXPIRES_HR\" Validate Required Permissions link #!/bin/bash has_permission() { local profile=\"$1\" local required=\"$2\" local perms=$(entra-auth-cli inspect --profile \"$profile\" --output json | \\ jq -r '.scp // .roles // empty') if [[ \"$perms\" =~ $required ]]; then return 0 else return 1 fi } # Usage if has_permission production \"User.Read\"; then echo \"Has User.Read permission\" else echo \"Missing User.Read permission\" exit 1 fi Debug Authentication Issues link # Full token inspection for debugging entra-auth-cli inspect --profile problematic-app # Check what API the token is for entra-auth-cli inspect --profile myapp --output json | jq -r .aud # Verify tenant entra-auth-cli inspect --profile myapp --output json | jq -r .tid # Check token age entra-auth-cli inspect --profile myapp --output json | \\ jq -r '\"\\(.iat) issued, \\(.exp) expires\"' Compare Tokens link # Compare tokens from different profiles echo \"Production token:\" entra-auth-cli inspect --profile production --claims echo -e \"\\nDevelopment token:\" entra-auth-cli inspect --profile dev --claims # Compare scopes diff \\ \u003c(entra-auth-cli inspect --profile production --output json | jq -r .scp) \\ \u003c(entra-auth-cli inspect --profile dev --output json | jq -r .scp) Troubleshooting linkInvalid Token Format linkProblem:\n$ entra-auth-cli inspect --token \"invalid-token\" Error: invalid token format Solution:\n# Verify token is a JWT (three parts separated by dots) echo \"$TOKEN\" | grep -E '^[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+$' # Check for extra whitespace TOKEN=$(echo \"$TOKEN\" | tr -d '[:space:]') entra-auth-cli inspect --token \"$TOKEN\" Token Not Found linkProblem:\n$ entra-auth-cli inspect --profile myapp Error: no token found for profile 'myapp' Solution:\n# Generate token first entra-auth-cli get-token --profile myapp # Then inspect entra-auth-cli inspect --profile myapp Expired Token linkProblem: Token shows as expired\nSolution:\n# Get fresh token entra-auth-cli get-token --profile myapp --force # Verify new token entra-auth-cli inspect --profile myapp Exit Codes link Code Description 0 Success 1 General error 2 Profile not found 3 No token available 4 Invalid token format Token Structure linkJWT tokens consist of three parts separated by dots (.):\nheader.payload.signature Header linkContains token type and signing algorithm:\n{ \"typ\": \"JWT\", \"alg\": \"RS256\", \"kid\": \"key-id\" } Payload (Claims) linkContains token data and metadata:\n{ \"aud\": \"https://graph.microsoft.com\", \"iss\": \"https://login.microsoftonline.com/...\", \"exp\": 1703782800, \"scp\": \"User.Read Mail.Read\" } Signature linkCryptographic signature to verify token integrity (not decoded).\nSecurity Notes linkToken Inspection is Local:\nNo network calls made Token is only decoded, not validated Signature verification not performed Use only for debugging and informational purposes Token Security:\n# ✅ Good - inspect cached token entra-auth-cli inspect --profile myapp # ⚠️ Caution - token visible in command history entra-auth-cli inspect --token \"eyJ0...\" # ✅ Better - use file or stdin cat token.txt | entra-auth-cli inspect See Also link get-token - Generate access tokens refresh - Refresh expired tokens JWT.io - Online JWT decoder (use with caution) Generating Tokens - Token generation guide "
            }
        );
    index.add(
            {
                id:  30 ,
                href: "\/docs\/platform-guides\/linux\/",
                title: "Linux",
                description: "Linux-specific configuration and secure storage",
                content: "Linux Platform Guide linkComplete guide for using Entra Auth Cli on Linux, including secure token storage, distribution-specific installation, and Linux-specific features.\nOverview linkEntra Auth Cli provides secure token storage and management on Linux:\nEncrypted Storage: XOR-based encryption with user-specific keys Distribution Support: Works on Ubuntu, Debian, RHEL, Fedora, Arch, and more Container Ready: Optimized for Docker and Kubernetes Shell Integration: Compatible with bash, zsh, fish, and more Installation linkDebian/Ubuntu (APT) link # Download .deb package wget https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli_amd64.deb # Install sudo dpkg -i entra-auth-cli_amd64.deb # Or install directly curl -L https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli_amd64.deb \\ -o /tmp/entra-auth-cli.deb \u0026\u0026 \\ sudo dpkg -i /tmp/entra-auth-cli.deb # Verify entra-auth-cli --version RHEL/CentOS/Fedora (RPM) link # Download .rpm package wget https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-1.0.0-1.x86_64.rpm # Install sudo rpm -ivh entra-auth-cli-1.0.0-1.x86_64.rpm # Or use dnf sudo dnf install https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-1.0.0-1.x86_64.rpm # Verify entra-auth-cli --version Arch Linux (AUR) link # Using yay yay -S entra-auth-cli # Using paru paru -S entra-auth-cli # Manual from AUR git clone https://aur.archlinux.org/entra-auth-cli.git cd entra-auth-cli makepkg -si Universal Binary link # Download binary curl -L https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 \\ -o /usr/local/bin/entra-auth-cli # Make executable chmod +x /usr/local/bin/entra-auth-cli # Verify entra-auth-cli --version From Source link # Prerequisites sudo apt-get install golang-go # Debian/Ubuntu sudo dnf install golang # Fedora/RHEL sudo pacman -S go # Arch # Clone and build git clone https://github.com/garrardkitchen/entra-auth-cli.git cd entra-auth-cli go build -o entra-auth-cli ./cmd/entra-auth-cli # Install sudo mv entra-auth-cli /usr/local/bin/ Token Storage linkStorage Location link # Tokens stored in user's home directory ~/.entra-auth-cli/ ├── profiles/ │ ├── default.json # Profile configuration │ ├── default.token # Encrypted token │ ├── production.json │ └── production.token └── config.json # Global configuration # Check storage ls -la ~/.entra-auth-cli/profiles/ Encryption linkTokens are encrypted using XOR with a user-specific key:\n# Key derived from: # - User ID (UID) # - Machine ID (/etc/machine-id) # - Home directory path # View machine ID cat /etc/machine-id # View user ID id -u # Tokens cannot be decrypted: # - On different machine # - By different user # - If machine-id changes File Permissions link # Verify secure permissions ls -la ~/.entra-auth-cli/profiles/ # Should show: # -rw------- (600) - Only owner can read/write # drwx------ (700) - Only owner can access directory # Fix permissions if needed chmod 700 ~/.entra-auth-cli/profiles/ chmod 600 ~/.entra-auth-cli/profiles/* SELinux Context link # For SELinux-enabled systems (RHEL/CentOS/Fedora) # Check context ls -Z ~/.entra-auth-cli/ # Set correct context chcon -R -t user_home_t ~/.entra-auth-cli/ # Make permanent semanage fcontext -a -t user_home_t \"~/.entra-auth-cli(/.*)?\" restorecon -R ~/.entra-auth-cli/ Shell Integration linkBash link # Add to ~/.bashrc # Completion complete -C entra-auth-cli entra-auth-cli # Aliases alias et='entra-auth-cli' alias etg='entra-auth-cli get-token' alias etp='entra-auth-cli list-profiles' # Function to get token get_token() { local profile=\"${1:-default}\" entra-auth-cli get-token --profile \"$profile\" --output json | jq -r .access_token } # Function to export token export_token() { local profile=\"${1:-default}\" export ENTRA_TOKEN=$(get_token \"$profile\") echo \"Token exported to \\$ENTRA_TOKEN\" } # Graph API helper graph() { local endpoint=\"$1\" local token=$(get_token) curl -s -H \"Authorization: Bearer $token\" \\ \"https://graph.microsoft.com/v1.0/$endpoint\" | jq . } Zsh link # Add to ~/.zshrc # Completion autoload -U compinit \u0026\u0026 compinit complete -o nospace -C entra-auth-cli entra-auth-cli # Aliases alias et='entra-auth-cli' alias etg='entra-auth-cli get-token' # Functions get_token() { entra-auth-cli get-token --profile \"${1:-default}\" --output json | jq -r .access_token } # Prompt integration (show if token is valid) precmd() { if entra-auth-cli inspect \u0026\u003e/dev/null; then RPROMPT=\"%F{green}🔑%f\" else RPROMPT=\"%F{red}🔑%f\" fi } Fish link # Add to ~/.config/fish/config.fish # Completion complete -c entra-auth-cli -f # Aliases alias et='entra-auth-cli' alias etg='entra-auth-cli get-token' # Function function get_token set -l profile (test -n \"$argv[1]\"; and echo $argv[1]; or echo \"default\") entra-auth-cli get-token --profile $profile --output json | jq -r .access_token end # Export function function export_token set -l profile (test -n \"$argv[1]\"; and echo $argv[1]; or echo \"default\") set -gx ENTRA_TOKEN (get_token $profile) echo \"Token exported to \\$ENTRA_TOKEN\" end Linux-Specific Features linkSystemd Service link # /etc/systemd/system/entra-auth-cli-refresh.service [Unit] Description=Entra Auth Cli Token Refresh After=network.target [Service] Type=oneshot User=%i ExecStart=/usr/local/bin/entra-auth-cli refresh --profile production StandardOutput=journal StandardError=journal [Install] WantedBy=multi-user.target # /etc/systemd/system/entra-auth-cli-refresh.timer [Unit] Description=Refresh Entra tokens hourly Requires=entra-auth-cli-refresh.service [Timer] OnBootSec=5min OnUnitActiveSec=1h Unit=entra-auth-cli-refresh.service [Install] WantedBy=timers.target # Enable and start sudo systemctl daemon-reload sudo systemctl enable entra-auth-cli-refresh@$USER.timer sudo systemctl start entra-auth-cli-refresh@$USER.timer # Check status systemctl status entra-auth-cli-refresh@$USER.timer systemctl list-timers --all | grep entra-auth-cli # View logs journalctl -u entra-auth-cli-refresh@$USER.service Cron Jobs link # Add to crontab crontab -e # Refresh token every hour 0 * * * * /usr/local/bin/entra-auth-cli refresh --profile production \u003e\u003e /var/log/entra-auth-cli-refresh.log 2\u003e\u00261 # Refresh at specific times 0 8,12,17 * * * /usr/local/bin/entra-auth-cli refresh --profile work # With environment 0 * * * * . $HOME/.profile; /usr/local/bin/entra-auth-cli refresh --profile production Environment Modules link # For HPC/cluster environments with environment modules # /opt/modulefiles/entra-auth-cli/1.0 #%Module1.0 proc ModulesHelp { } { puts stderr \"Entra Auth Cli - Microsoft Entra ID token management\" } module-whatis \"Microsoft Entra ID token management tool\" prepend-path PATH /opt/entra-auth-cli/bin setenv ENTRA_TOKEN_HOME /opt/entra-auth-cli # Load module module load entra-auth-cli Container Integration linkDocker link FROM ubuntu:22.04 # Install dependencies RUN apt-get update \u0026\u0026 \\ apt-get install -y curl jq \u0026\u0026 \\ rm -rf /var/lib/apt/lists/* # Install Entra Auth Cli RUN curl -L https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 \\ -o /usr/local/bin/entra-auth-cli \u0026\u0026 \\ chmod +x /usr/local/bin/entra-auth-cli # Create non-root user RUN useradd -m -s /bin/bash appuser USER appuser # Set up profiles directory RUN mkdir -p /home/appuser/.entra-auth-cli/profiles # Copy entrypoint COPY entrypoint.sh /entrypoint.sh ENTRYPOINT [\"/entrypoint.sh\"] #!/bin/bash # entrypoint.sh # Create profile from environment variables if [ -n \"$TENANT_ID\" ] \u0026\u0026 [ -n \"$CLIENT_ID\" ] \u0026\u0026 [ -n \"$CLIENT_SECRET\" ]; then entra-auth-cli create-profile \\ --name container \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --client-secret \"$CLIENT_SECRET\" \\ --scope \"${SCOPE:-https://graph.microsoft.com/.default}\" fi # Get token export TOKEN=$(entra-auth-cli get-token --profile container --output json | jq -r .access_token) # Execute main command exec \"$@\" Kubernetes link apiVersion: v1 kind: ConfigMap metadata: name: entra-auth-cli-config data: create-profile.sh: | #!/bin/bash entra-auth-cli create-profile \\ --name k8s \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --client-secret \"$CLIENT_SECRET\" --- apiVersion: v1 kind: Secret metadata: name: azure-credentials type: Opaque stringData: tenant-id: \"your-tenant-id\" client-id: \"your-client-id\" client-secret: \"your-client-secret\" --- apiVersion: apps/v1 kind: Deployment metadata: name: app-with-entra-auth-cli spec: replicas: 1 selector: matchLabels: app: myapp template: metadata: labels: app: myapp spec: containers: - name: app image: myapp:latest env: - name: TENANT_ID valueFrom: secretKeyRef: name: azure-credentials key: tenant-id - name: CLIENT_ID valueFrom: secretKeyRef: name: azure-credentials key: client-id - name: CLIENT_SECRET valueFrom: secretKeyRef: name: azure-credentials key: client-secret volumeMounts: - name: entra-auth-cli-config mountPath: /config command: - /bin/bash - -c - | /config/create-profile.sh TOKEN=$(entra-auth-cli get-token --output json | jq -r .access_token) export AUTH_TOKEN=$TOKEN exec /app/start.sh volumes: - name: entra-auth-cli-config configMap: name: entra-auth-cli-config defaultMode: 0755 Common Use Cases linkCI/CD Integration linkGitLab CI link # .gitlab-ci.yml stages: - deploy deploy: stage: deploy image: ubuntu:22.04 before_script: - apt-get update \u0026\u0026 apt-get install -y curl jq - curl -L https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 -o /usr/local/bin/entra-auth-cli - chmod +x /usr/local/bin/entra-auth-cli - | entra-auth-cli create-profile \\ --name ci \\ --tenant-id \"$AZURE_TENANT_ID\" \\ --client-id \"$AZURE_CLIENT_ID\" \\ --client-secret \"$AZURE_CLIENT_SECRET\" script: - TOKEN=$(entra-auth-cli get-token --profile ci --output json | jq -r .access_token) - echo \"Deploying with token...\" - curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com/deploy only: - main Jenkins link // Jenkinsfile pipeline { agent any environment { TENANT_ID = credentials('azure-tenant-id') CLIENT_ID = credentials('azure-client-id') CLIENT_SECRET = credentials('azure-client-secret') } stages { stage('Setup') { steps { sh ''' curl -L https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 \\ -o /tmp/entra-auth-cli chmod +x /tmp/entra-auth-cli sudo mv /tmp/entra-auth-cli /usr/local/bin/ ''' } } stage('Authenticate') { steps { sh ''' entra-auth-cli create-profile \\ --name jenkins \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --client-secret \"$CLIENT_SECRET\" ''' } } stage('Deploy') { steps { sh ''' TOKEN=$(entra-auth-cli get-token --profile jenkins --output json | jq -r .access_token) curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com/deploy ''' } } } } SSH Remote Execution link # Execute on remote server with token ssh user@server \"$(cat \u003c\u003c'EOF' TOKEN=$(entra-auth-cli get-token --profile production --output json | jq -r .access_token) curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/me EOF )\" # Deploy profile to remote server scp ~/.entra-auth-cli/profiles/production.* user@server:~/.entra-auth-cli/profiles/ # Execute script remotely ssh user@server 'bash -s' \u003c local-script.sh Ansible Playbook link # playbook.yml --- - name: Deploy application with Entra Token hosts: webservers tasks: - name: Install Entra Auth Cli get_url: url: https://github.com/garrardkitchen/entra-auth-cli/releases/latest/download/entra-auth-cli-linux-amd64 dest: /usr/local/bin/entra-auth-cli mode: '0755' become: yes - name: Create profile shell: | entra-auth-cli create-profile \\ --name ansible \\ --tenant-id \"{{ azure_tenant_id }}\" \\ --client-id \"{{ azure_client_id }}\" \\ --client-secret \"{{ azure_client_secret }}\" no_log: true - name: Get token shell: entra-auth-cli get-token --profile ansible --output json register: token_output - name: Deploy application uri: url: https://api.example.com/deploy method: POST headers: Authorization: \"Bearer {{ (token_output.stdout | from_json).access_token }}\" body_format: json Security Best Practices linkFile System Permissions link # Secure home directory chmod 700 ~ # Secure entra-auth-cli directory chmod 700 ~/.entra-auth-cli chmod 700 ~/.entra-auth-cli/profiles chmod 600 ~/.entra-auth-cli/profiles/* # Verify ls -la ~/.entra-auth-cli/profiles/ AppArmor Profile link # /etc/apparmor.d/usr.local.bin.entra-auth-cli #include /usr/local/bin/entra-auth-cli { #include #include #include /usr/local/bin/entra-auth-cli mr, owner @{HOME}/.entra-auth-cli/ rw, owner @{HOME}/.entra-auth-cli/** rw, /etc/machine-id r, /proc/sys/kernel/random/uuid r, network inet stream, network inet6 stream, } # Load profile sudo apparmor_parser -r /etc/apparmor.d/usr.local.bin.entra-auth-cli Firewall Rules link # Allow outbound HTTPS to Microsoft Entra ID sudo ufw allow out 443/tcp # Restrict to Microsoft IPs (optional) sudo iptables -A OUTPUT -p tcp -d login.microsoftonline.com --dport 443 -j ACCEPT sudo iptables -A OUTPUT -p tcp --dport 443 -j DROP Troubleshooting linkPermission Denied linkProblem: Cannot read/write token files\nSolutions:\n# Check ownership ls -la ~/.entra-auth-cli/profiles/ # Fix ownership chown -R $USER:$USER ~/.entra-auth-cli/ # Fix permissions chmod 700 ~/.entra-auth-cli/profiles/ chmod 600 ~/.entra-auth-cli/profiles/* Machine ID Changed linkProblem: “Cannot decrypt token” after system reinstall\nSolution:\n# Machine ID changed, tokens are invalid # Delete old tokens and re-authenticate rm ~/.entra-auth-cli/profiles/*.token # Get new token entra-auth-cli get-token --flow interactive SELinux Denial linkProblem: SELinux blocks token access\nSolutions:\n# Check denials sudo ausearch -m avc -ts recent | grep entra-auth-cli # Allow access sudo audit2allow -a -M entra-auth-cli sudo semodule -i entra-auth-cli.pp # Or set correct context sudo chcon -R -t user_home_t ~/.entra-auth-cli/ Missing Dependencies linkProblem: “jq: command not found”\nSolutions:\n# Ubuntu/Debian sudo apt-get install jq # RHEL/CentOS/Fedora sudo dnf install jq # Arch sudo pacman -S jq Performance Optimization linkToken Caching link # Cache token in tmpfs (RAM disk) CACHE_DIR=\"/dev/shm/entra-auth-cli-$$\" mkdir -p \"$CACHE_DIR\" chmod 700 \"$CACHE_DIR\" # Get and cache token entra-auth-cli get-token --output json \u003e \"$CACHE_DIR/token.json\" # Use cached token TOKEN=$(jq -r .access_token \"$CACHE_DIR/token.json\") # Cleanup on exit trap \"rm -rf $CACHE_DIR\" EXIT Parallel Processing link # Parallel API calls with GNU parallel TOKEN=$(entra-auth-cli get-token --output json | jq -r .access_token) parallel -j 10 \"curl -s -H 'Authorization: Bearer $TOKEN' {}\" ::: \\ https://graph.microsoft.com/v1.0/users \\ https://graph.microsoft.com/v1.0/groups \\ https://graph.microsoft.com/v1.0/applications \\ | jq -s . Next Steps link Windows Platform Guide - Windows-specific features macOS Platform Guide - macOS-specific features Bash Scripts - Advanced shell scripting CI/CD Integration - Complete CI/CD examples "
            }
        );
    index.add(
            {
                id:  31 ,
                href: "\/docs\/core-concepts\/scopes\/",
                title: "Scopes \u0026 Permissions",
                description: "Understanding API scopes and permission requests",
                content: "Scopes \u0026 Permissions linkScopes define what your application can access using an access token. Understanding scopes is critical for requesting the right permissions and troubleshooting authorization issues.\nWhat Are Scopes? linkA scope is a permission that grants access to specific resources or operations in an API.\nFormat link https://api.example.com/.default https://graph.microsoft.com/User.Read https://management.azure.com/user_impersonation Parts:\nResource URI: The API you’re accessing (https://graph.microsoft.com) Permission: The specific capability (User.Read, .default) Common Scope Patterns linkMicrosoft Graph API link # Read user profile https://graph.microsoft.com/User.Read # Read user profile and email https://graph.microsoft.com/User.Read https://graph.microsoft.com/Mail.Read # All configured permissions https://graph.microsoft.com/.default Azure Management API link # Azure Resource Manager access https://management.azure.com/.default # With user impersonation https://management.azure.com/user_impersonation Custom APIs link # Your custom API https://api.contoso.com/.default # Specific scopes api://12345678-1234-1234-1234-123456789abc/access_as_user Azure Key Vault link https://vault.azure.net/.default Azure Storage link https://storage.azure.com/.default The .default Scope linkWhat It Means linkThe .default suffix requests all permissions configured in your app registration.\nExample: If your app is configured with:\nUser.Read Mail.Read Calendars.Read Then requesting https://graph.microsoft.com/.default includes all three.\nWhen to Use link✅ Use .default when:\nWorking with service principals (Client Credentials flow) You want all configured permissions Building automation scripts ⚠️ Avoid .default when:\nRequesting minimal permissions Building user-facing apps (use explicit scopes) Different operations need different scopes Example link # Request all configured Graph permissions entra-auth-cli get-token -p service-principal \\ --scope \"https://graph.microsoft.com/.default\" Profile Scopes vs Runtime Scopes linkProfile Scopes linkScopes stored in your profile configuration:\n{ \"name\": \"my-profile\", \"scope\": \"https://graph.microsoft.com/User.Read Mail.Read\" } Used by default when running:\nentra-auth-cli get-token -p my-profile Runtime Scope Override linkOverride profile scopes with --scope or -s:\n# Override to request different scope entra-auth-cli get-token -p my-profile \\ --scope \"https://graph.microsoft.com/Calendar.Read\" Use cases:\nDifferent operations need different permissions Testing with minimal scopes Temporary scope changes without editing profile Multiple Scopes linkSpace-Separated Format link entra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read Calendars.Read\" Comma-Separated Format link entra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read,Mail.Read,Calendars.Read\" The tool normalizes both formats automatically.\nScope Requirements by Flow linkClient Credentials Flow linkRequires: Application permissions configured in Azure Portal\n# App registration → API permissions → Add permission # Select: Application permissions (not Delegated) # Grant admin consent ✓ Example scopes:\nhttps://graph.microsoft.com/.default https://management.azure.com/.default User-Interactive Flows linkRequires: Delegated permissions configured in Azure Portal\n# App registration → API permissions → Add permission # Select: Delegated permissions # User consent required (or admin consent) Example scopes:\nhttps://graph.microsoft.com/User.Read https://graph.microsoft.com/Mail.Read Inspecting Token Scopes linkUse inspect to see what scopes are included in your token:\nentra-auth-cli inspect -t \"eyJ0eXAiOiJKV1QiLCJhbGci...\" Output:\n{ \"scp\": \"User.Read Mail.Read\", \"roles\": [\"User.Read.All\"] } Fields:\nscp: Delegated permissions (user context) roles: Application permissions (app context) Common Scope Patterns linkReading User Data link # Microsoft Graph https://graph.microsoft.com/User.Read # Basic profile https://graph.microsoft.com/User.Read.All # All users (admin) https://graph.microsoft.com/User.ReadWrite # Modify profile Email Access link https://graph.microsoft.com/Mail.Read # Read email https://graph.microsoft.com/Mail.Send # Send email https://graph.microsoft.com/Mail.ReadWrite # Full email access Calendar Access link https://graph.microsoft.com/Calendars.Read https://graph.microsoft.com/Calendars.ReadWrite Azure Resource Management link https://management.azure.com/.default https://management.azure.com/user_impersonation SharePoint link https://graph.microsoft.com/Sites.Read.All https://graph.microsoft.com/Files.ReadWrite.All Scope Configuration linkSetting Scopes in Profile linkDuring Creation link entra-auth-cli config create # ... prompts ... Scope: https://graph.microsoft.com/.default During Edit link entra-auth-cli config edit -p myprofile # Select: Scope # Enter new: https://management.azure.com/.default Manual JSON Edit linkEdit ~/.entra-auth-cli/profiles.json:\n{ \"profiles\": [ { \"name\": \"myprofile\", \"scope\": \"https://graph.microsoft.com/User.Read Mail.Read\" } ] } Scope Troubleshooting link“Invalid scope” linkCause: Scope format is incorrect\nFix:\n# ❌ Wrong --scope \"User.Read\" # ✓ Correct --scope \"https://graph.microsoft.com/User.Read\" “AADSTS65001: User consent required” linkCause: User hasn’t consented to delegated permissions\nFix:\nUse interactive flow (Authorization Code or Interactive Browser) User will be prompted to consent Or: Admin grants consent in Azure Portal “AADSTS70011: Invalid scopes” linkCause: Scope not configured in app registration\nFix:\nGo to Azure Portal → App registrations Select your app → API permissions Add the required permission Grant admin consent (if Application permission) “Insufficient privileges” linkCause: Token has scope but user/app lacks underlying permission\nFix:\nFor users: Assign appropriate role (e.g., Global Reader) For apps: Grant admin consent for Application permissions Verify permission configuration in Azure Portal Best Practices link✅ Principle of Least Privilege linkRequest only the scopes you need:\n# ❌ Over-privileged --scope \"https://graph.microsoft.com/.default\" # ✓ Minimal scopes --scope \"https://graph.microsoft.com/User.Read Mail.Read\" ✅ Use Explicit Scopes for User Apps linkFor user-facing applications, request specific scopes:\nentra-auth-cli get-token -p user-app \\ --scope \"https://graph.microsoft.com/User.Read\" ✅ Use .default for Service Principals linkFor automation and service accounts:\nentra-auth-cli get-token -p automation \\ --scope \"https://graph.microsoft.com/.default\" ✅ Separate Profiles for Different Scopes linkCreate profiles for different scenarios:\n# Profile: graph-readonly scope: https://graph.microsoft.com/User.Read # Profile: graph-admin scope: https://graph.microsoft.com/.default ❌ Don’t Hard-Code Tokens linkAlways request fresh tokens with appropriate scopes:\n# ✓ Request token per operation TOKEN=$(entra-auth-cli get-token -p myprofile --scope \"...\") curl -H \"Authorization: Bearer $TOKEN\" ... Scope Discovery linkFinding Available Scopes link Azure Portal:\nApp registrations → API permissions → Add permission Browse Microsoft APIs or your custom APIs View available Delegated and Application permissions Microsoft Graph Explorer:\nVisit: https://developer.microsoft.com/graph/graph-explorer Explore API endpoints and required scopes API Documentation:\nMicrosoft Graph: https://docs.microsoft.com/graph/permissions-reference Azure Management: https://docs.microsoft.com/rest/api/azure/ Using discover Command link entra-auth-cli discover -t \"eyJ0eXAiOiJKV1Qi...\" Output shows:\nToken audience Issued scopes Roles Expiration time Scope Combinations linkCommon Combinations linkGraph API Read-Only Access link --scope \"https://graph.microsoft.com/User.Read Mail.Read Calendars.Read\" Graph API Admin Access link --scope \"https://graph.microsoft.com/.default\" Azure Management + Graph link # Request separately (different audiences) TOKEN_GRAPH=$(entra-auth-cli get-token -p graph --scope \"https://graph.microsoft.com/.default\") TOKEN_AZURE=$(entra-auth-cli get-token -p azure --scope \"https://management.azure.com/.default\") Next Steps link Learn about OAuth2 Flows Understand Authentication Profiles Inspect Tokens Scope Troubleshooting Guide "
            }
        );
    index.add(
            {
                id:  32 ,
                href: "\/docs\/user-guide\/working-with-tokens\/",
                title: "Working with Tokens",
                description: "Inspect, validate, and use access tokens effectively",
                content: "Working with Tokens linkOnce you have an access token, learn how to inspect, validate, refresh, and use it effectively with APIs.\nQuick Reference link Task Command Inspect token entra-auth-cli inspect -t TOKEN Inspect from file entra-auth-cli inspect -f token.txt Discover token info entra-auth-cli discover -t TOKEN Refresh token entra-auth-cli refresh -p PROFILE Check expiration entra-auth-cli discover -t TOKEN | jq .exp Token Inspection linkDecode JWT Claims link entra-auth-cli inspect -t \"eyJ0eXAiOiJKV1QiLCJh...\" Output:\n{ \"header\": { \"typ\": \"JWT\", \"alg\": \"RS256\", \"kid\": \"abc123...\" }, \"payload\": { \"aud\": \"https://graph.microsoft.com\", \"iss\": \"https://sts.windows.net/12345678-1234-1234-1234-123456789abc/\", \"iat\": 1701432000, \"nbf\": 1701432000, \"exp\": 1701435600, \"appid\": \"12345678-1234-1234-1234-123456789abc\", \"appidacr\": \"1\", \"idp\": \"https://sts.windows.net/...\", \"oid\": \"87654321-4321-4321-4321-cba987654321\", \"rh\": \"...\", \"sub\": \"...\", \"tid\": \"12345678-1234-1234-1234-123456789abc\", \"uti\": \"...\", \"ver\": \"1.0\", \"scp\": \"User.Read Mail.Read\", \"roles\": [] }, \"signature\": \"...\" } Inspect from File link entra-auth-cli get-token -p myprofile --silent \u003e token.txt entra-auth-cli inspect -f token.txt Inspect from Pipeline link entra-auth-cli get-token -p myprofile --silent | entra-auth-cli inspect Detailed inspection guide →\nUnderstanding Token Claims linkEssential Claims link Claim Description Example aud Audience (API) https://graph.microsoft.com iss Issuer (Entra ID) https://sts.windows.net/... iat Issued at (Unix timestamp) 1701432000 exp Expiration (Unix timestamp) 1701435600 appid Application ID 12345678-... tid Tenant ID 87654321-... Permission Claims linkDelegated permissions (user context):\n{ \"scp\": \"User.Read Mail.Read Calendars.Read\" } Application permissions (app context):\n{ \"roles\": [\"User.Read.All\", \"Mail.Send\"] } User Claims link { \"unique_name\": \"user@contoso.com\", \"upn\": \"user@contoso.com\", \"name\": \"John Doe\", \"oid\": \"87654321-4321-4321-4321-cba987654321\" } Token Discovery linkQuick Token Info link entra-auth-cli discover -t \"eyJ0eXAiOiJKV1QiLCJh...\" Output:\nToken Information: Audience: https://graph.microsoft.com Issued: 2024-12-01 10:00:00 UTC Expires: 2024-12-01 11:00:00 UTC Time remaining: 45 minutes Scopes: User.Read Mail.Read Application ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Check if Token is Valid link entra-auth-cli discover -t \"eyJ0eXAiOiJKV1QiLCJh...\" \u0026\u0026 echo \"Valid\" || echo \"Expired\" Exit codes:\n0: Token is valid 1: Token is expired or invalid Expiration Check link # Get expiration timestamp EXP=$(entra-auth-cli inspect -t \"$TOKEN\" | jq -r .payload.exp) # Convert to readable date date -r $EXP # macOS date -d @$EXP # Linux Detailed discovery guide →\nToken Refresh linkWhen to Refresh linkRefresh token when:\nToken is expired or about to expire You need a fresh token with updated permissions Check expiration:\nentra-auth-cli discover -t \"$TOKEN\" Refresh Command link entra-auth-cli refresh -p myprofile Requirements:\nOriginal token acquired with offline_access scope Refresh token available in cache Output:\nRefreshing token for profile 'myprofile'... ✓ Token refreshed successfully eyJ0eXAiOiJKV1QiLCJh... Refresh vs New Token link Operation Refresh New Token Speed Faster Slower User interaction None May require Requirements Refresh token Profile + credentials Use case Token expired First request or refresh unavailable When refresh isn’t available:\nClient Credentials flow (no refresh tokens) Refresh token expired (\u003e90 days of inactivity) Detailed refresh guide →\nUsing Tokens with APIs linkMicrosoft Graph API link TOKEN=$(entra-auth-cli get-token -p graph-profile --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Example response:\n{ \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#users/$entity\", \"id\": \"87654321-4321-4321-4321-cba987654321\", \"displayName\": \"John Doe\", \"mail\": \"john.doe@contoso.com\", \"userPrincipalName\": \"john.doe@contoso.com\" } Azure Resource Manager link TOKEN=$(entra-auth-cli get-token -p azure-profile --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ \"https://management.azure.com/subscriptions?api-version=2020-01-01\" Custom APIs link TOKEN=$(entra-auth-cli get-token -p custom-api --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d '{\"key\": \"value\"}' \\ https://api.contoso.com/v1/resources Token Validation linkClient-Side Validation linkCheck expiration:\n# Extract exp claim EXP=$(entra-auth-cli inspect -t \"$TOKEN\" | jq -r .payload.exp) # Compare with current time NOW=$(date +%s) if [ $EXP -lt $NOW ]; then echo \"Token expired\" else echo \"Token valid for $(( ($EXP - $NOW) / 60 )) minutes\" fi Verify audience:\nAUD=$(entra-auth-cli inspect -t \"$TOKEN\" | jq -r .payload.aud) if [ \"$AUD\" = \"https://graph.microsoft.com\" ]; then echo \"Valid for Graph API\" else echo \"Wrong audience: $AUD\" fi Server-Side Validation linkAPIs validate tokens by:\nVerifying signature using Microsoft’s public keys Checking expiration (exp claim) Validating audience (aud claim) Checking issuer (iss claim) Microsoft Graph validates:\nToken signature Expiration time Audience = https://graph.microsoft.com Issuer from trusted Entra ID tenant Token Expiration linkTypical Lifetimes link Token Type Lifetime Access token 1 hour Refresh token 90 days (or until revoked) ID token 1 hour Handling Expiration linkPattern 1: Check before use\nif entra-auth-cli discover -f token.txt \u0026\u003e/dev/null; then TOKEN=$(cat token.txt) else TOKEN=$(entra-auth-cli get-token -p myprofile --silent) echo \"$TOKEN\" \u003e token.txt fi Pattern 2: Catch API errors\nTOKEN=$(cat token.txt) RESPONSE=$(curl -s -w \"%{http_code}\" \\ -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me) if [[ \"$RESPONSE\" == *\"401\"* ]]; then # Token expired, get new one TOKEN=$(entra-auth-cli get-token -p myprofile --silent) echo \"$TOKEN\" \u003e token.txt # Retry request curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me fi Pattern 3: Preemptive refresh\n# Refresh if less than 5 minutes remaining EXP=$(entra-auth-cli inspect -f token.txt | jq -r .payload.exp) NOW=$(date +%s) REMAINING=$(( ($EXP - $NOW) / 60 )) if [ $REMAINING -lt 5 ]; then entra-auth-cli get-token -p myprofile --silent \u003e token.txt fi Detailed expiration guide →\nToken Storage linkTemporary Storage link # In-memory (session only) export TOKEN=$(entra-auth-cli get-token -p myprofile --silent) # File (with restricted permissions) entra-auth-cli get-token -p myprofile --silent \u003e /tmp/token.txt chmod 600 /tmp/token.txt Cache Location linkMSAL token cache:\nWindows: %LOCALAPPDATA%\\.msal\\cache macOS/Linux: ~/.msal/cache Contains:\nAccess tokens Refresh tokens ID tokens Account information Security:\nEncrypted on Windows (DPAPI) Encrypted on macOS (Keychain) ⚠️ Obfuscated on Linux (not secure) Clearing Cache link # Delete cache directory rm -rf ~/.msal/cache # Next token request will require re-authentication entra-auth-cli get-token -p myprofile Token Security link✅ Best Practices linkDo:\n✅ Request tokens on-demand ✅ Use HTTPS for all API requests ✅ Check token expiration before use ✅ Store tokens with restrictive permissions (600) ✅ Clear tokens after use ✅ Use environment variables for temporary storage ✅ Rotate credentials regularly Don’t:\n❌ Hard-code tokens in source code ❌ Commit tokens to git repositories ❌ Share tokens via email/chat ❌ Log tokens in plaintext ❌ Store tokens long-term ❌ Use tokens across environments (dev/prod) Secure Token Handling link #!/bin/bash set -e # Secure temp file TOKEN_FILE=$(mktemp) trap \"rm -f $TOKEN_FILE\" EXIT # Get token entra-auth-cli get-token -p myprofile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" # Use token TOKEN=$(cat \"$TOKEN_FILE\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com # File automatically deleted on exit Common Patterns linkPattern 1: Token in Script link #!/bin/bash set -euo pipefail get_token() { entra-auth-cli get-token -p \"$1\" --silent } TOKEN=$(get_token \"myprofile\") # Use token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Pattern 2: Cached Token link #!/bin/bash TOKEN_CACHE=\"/tmp/my-token-cache.txt\" TOKEN_MAX_AGE=3000 # 50 minutes get_fresh_token() { entra-auth-cli get-token -p myprofile --silent \u003e \"$TOKEN_CACHE\" chmod 600 \"$TOKEN_CACHE\" } # Check if cache exists and is fresh if [ -f \"$TOKEN_CACHE\" ]; then FILE_AGE=$(( $(date +%s) - $(stat -f %m \"$TOKEN_CACHE\") )) # macOS # FILE_AGE=$(( $(date +%s) - $(stat -c %Y \"$TOKEN_CACHE\") )) # Linux if [ $FILE_AGE -gt $TOKEN_MAX_AGE ]; then get_fresh_token fi else get_fresh_token fi TOKEN=$(cat \"$TOKEN_CACHE\") Pattern 3: Token Rotation link #!/bin/bash # Function to get valid token get_valid_token() { local profile=$1 local token_file=\"/tmp/token-$profile.txt\" # Check if token exists and is valid if [ -f \"$token_file\" ] \u0026\u0026 entra-auth-cli discover -f \"$token_file\" \u0026\u003e/dev/null; then cat \"$token_file\" else # Get fresh token entra-auth-cli get-token -p \"$profile\" --silent | tee \"$token_file\" chmod 600 \"$token_file\" fi } # Use it TOKEN=$(get_valid_token \"myprofile\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com Pattern 4: Multi-Profile Management link #!/bin/bash declare -A TOKENS get_token_for_profile() { local profile=$1 if [ -z \"${TOKENS[$profile]}\" ]; then TOKENS[$profile]=$(entra-auth-cli get-token -p \"$profile\" --silent) fi echo \"${TOKENS[$profile]}\" } # Use different profiles GRAPH_TOKEN=$(get_token_for_profile \"graph-profile\") AZURE_TOKEN=$(get_token_for_profile \"azure-profile\") curl -H \"Authorization: Bearer $GRAPH_TOKEN\" https://graph.microsoft.com/v1.0/me curl -H \"Authorization: Bearer $AZURE_TOKEN\" https://management.azure.com/subscriptions Troubleshooting link“Invalid token” linkCause: Token is malformed or corrupted\nFix:\n# Validate token format entra-auth-cli inspect -t \"$TOKEN\" # If invalid, get fresh token TOKEN=$(entra-auth-cli get-token -p myprofile --silent) “Token expired” linkCause: Token lifetime exceeded\nFix:\n# Get new token TOKEN=$(entra-auth-cli get-token -p myprofile --silent) “Insufficient privileges” linkCause: Token lacks required permissions\nFix:\nCheck token scopes: entra-auth-cli inspect -t \"$TOKEN\" | jq .payload.scp Request token with correct scopes: entra-auth-cli get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Send\" “Invalid audience” linkCause: Token issued for different API\nFix:\n# Check audience entra-auth-cli inspect -t \"$TOKEN\" | jq .payload.aud # Get token for correct API entra-auth-cli get-token -p myprofile \\ --scope \"https://correct-api.com/.default\" Next Steps link Token Inspection (Detailed) Token Refresh (Detailed) Token Expiration Handling API Integration Recipes "
            }
        );
    index.add(
            {
                id:  33 ,
                href: "\/docs\/reference\/discover\/",
                title: "discover",
                description: "Quick token validation and information",
                content: "discover linkQuickly validate tokens and display essential information without full decoding.\nSynopsis link entra-auth-cli discover [flags] Description linkThe discover command provides a fast way to validate token format and get basic information about tokens without performing full JWT decoding. It’s useful for quick checks and validation in scripts.\nThis command is lighter than inspect and focuses on:\nToken format validation Basic validity checks Quick metadata extraction Fast status reporting Flags linkInput Options link--profile, -p linkCheck token from a profile.\nentra-auth-cli discover --profile production entra-auth-cli discover -p dev --token, -t linkCheck a specific token string.\nentra-auth-cli discover --token \"eyJ0eXAiOiJKV1QiLCJh...\" --file, -f linkRead token from a file.\nentra-auth-cli discover --file token.txt Output Options link--output, -o linkOutput format.\nentra-auth-cli discover --output json entra-auth-cli discover -o yaml Options:\ntext - Human-readable text (default) json - JSON format yaml - YAML format --quiet, -q linkOnly output validation result (exit code only).\nif entra-auth-cli discover --profile myapp --quiet; then echo \"Token is valid\" fi Examples linkBasic Usage link # Check token from profile entra-auth-cli discover --profile myapp # Check specific token entra-auth-cli discover --token \"eyJ0eXAiOiJKV1Qi...\" # Check token from file entra-auth-cli discover --file access_token.txt # Check token from stdin entra-auth-cli get-token | entra-auth-cli discover Output Formats link # Text output (default) entra-auth-cli discover --profile myapp # JSON output entra-auth-cli discover --profile myapp --output json # Quiet mode (exit code only) entra-auth-cli discover --profile myapp --quiet echo $? # 0 = valid, 1 = invalid Script Usage link # Quick validation check if entra-auth-cli discover --profile production --quiet; then echo \"Token valid, proceeding...\" ./deploy.sh else echo \"Token invalid, refreshing...\" entra-auth-cli refresh --profile production fi # Check before API call validate_token() { local profile=\"$1\" if ! entra-auth-cli discover --profile \"$profile\" --quiet 2\u003e/dev/null; then echo \"Invalid token for $profile\" \u003e\u00262 return 1 fi return 0 } # Usage validate_token production \u0026\u0026 api_call Output linkText Format (Default) link Token Status: Valid Format: JWT Type: Bearer Expires: 2025-12-28 15:30:00 UTC Remaining: 42 minutes Profile: production JSON Format link { \"valid\": true, \"format\": \"JWT\", \"type\": \"Bearer\", \"expires_at\": \"2025-12-28T15:30:00Z\", \"expires_in\": 2520, \"expired\": false, \"profile\": \"production\" } YAML Format link valid: true format: JWT type: Bearer expires_at: 2025-12-28T15:30:00Z expires_in: 2520 expired: false profile: production Quiet Mode linkNo output, only exit code:\n0 = Token is valid 1 = Token is invalid or expired Validation Checks linkThe discover command validates:\nFormat: Token is a valid JWT structure (three base64 parts) Expiration: Token has not expired Structure: Token can be parsed Type: Token is a Bearer token Not validated:\nSignature (no cryptographic verification) Issuer Audience Claims content Use Cases linkPre-Flight Validation link #!/bin/bash # Validate before expensive operation if ! entra-auth-cli discover --profile prod --quiet; then echo \"Getting fresh token...\" entra-auth-cli get-token --profile prod --force fi # Proceed with validated token TOKEN=$(entra-auth-cli get-token --profile prod --silent) ./expensive-operation.sh \"$TOKEN\" Health Check Script link #!/bin/bash profiles=(\"production\" \"staging\" \"development\") echo \"Token Health Check\" echo \"====================\" for profile in \"${profiles[@]}\"; do if entra-auth-cli discover --profile \"$profile\" --quiet 2\u003e/dev/null; then status=\"✓ Valid\" expiry=$(entra-auth-cli discover --profile \"$profile\" --output json | jq -r .expires_at) else status=\"✗ Invalid\" expiry=\"N/A\" fi printf \"%-15s %s (expires: %s)\\n\" \"$profile\" \"$status\" \"$expiry\" done Monitoring Integration link #!/bin/bash # Prometheus metrics format check_token_validity() { local profile=\"$1\" if output=$(entra-auth-cli discover --profile \"$profile\" --output json 2\u003e/dev/null); then local expires_in=$(echo \"$output\" | jq -r .expires_in) local expired=$(echo \"$output\" | jq -r .expired) echo \"token_valid{profile=\\\"$profile\\\"} 1\" echo \"token_expires_in_seconds{profile=\\\"$profile\\\"} $expires_in\" echo \"token_expired{profile=\\\"$profile\\\"} $([[ \"$expired\" == \"true\" ]] \u0026\u0026 echo 1 || echo 0)\" else echo \"token_valid{profile=\\\"$profile\\\"} 0\" fi } # Export metrics for profile in production staging dev; do check_token_validity \"$profile\" done CI/CD Pipeline Check link #!/bin/bash set -euo pipefail echo \"Validating authentication tokens...\" profiles=(\"cicd-deploy\" \"cicd-test\" \"cicd-prod\") failed=0 for profile in \"${profiles[@]}\"; do if entra-auth-cli discover --profile \"$profile\" --quiet; then echo \"✓ $profile: Valid\" else echo \"✗ $profile: Invalid or expired\" failed=1 fi done if [ $failed -eq 1 ]; then echo \"Some tokens are invalid. Please re-authenticate.\" exit 1 fi echo \"All tokens valid. Proceeding with deployment.\" Quick Expiration Check link # Get time until expiration get_ttl() { local profile=\"$1\" local ttl=$(entra-auth-cli discover --profile \"$profile\" --output json 2\u003e/dev/null | jq -r .expires_in) if [ \"$ttl\" != \"null\" ] \u0026\u0026 [ -n \"$ttl\" ]; then echo \"$ttl\" return 0 else return 1 fi } # Usage if ttl=$(get_ttl production); then echo \"Token expires in $ttl seconds\" if [ $ttl -lt 300 ]; then echo \"Token expiring soon, refreshing...\" entra-auth-cli refresh --profile production fi fi Comparison with inspect link Feature discover inspect Speed Fast Slower Output Basic info Full token details Claims Not shown All claims shown Use Case Quick validation Debugging Exit Code Validity status Always 0 (unless error) Use discover for:\nQuick validation checks Script conditionals Monitoring/health checks Fast status reporting Use inspect for:\nDebugging authentication issues Viewing all token claims Detailed token analysis Exit Codes link Code Description 0 Token is valid 1 Token is invalid or expired 2 Profile not found 3 No token available 4 Invalid token format Performance linkdiscover is optimized for speed:\n# Benchmark comparison time entra-auth-cli discover --profile prod --quiet # ~10ms time entra-auth-cli inspect --profile prod \u003e /dev/null # ~50ms # In tight loops, discover is significantly faster for i in {1..100}; do entra-auth-cli discover --profile prod --quiet done # ~1 second for i in {1..100}; do entra-auth-cli inspect --profile prod \u003e /dev/null done # ~5 seconds Error Handling link #!/bin/bash discover_token() { local profile=\"$1\" local max_retries=3 local attempt=0 while [ $attempt -lt $max_retries ]; do if entra-auth-cli discover --profile \"$profile\" --quiet 2\u003e/dev/null; then return 0 fi attempt=$((attempt + 1)) if [ $attempt -lt $max_retries ]; then echo \"Token invalid, attempt $attempt of $max_retries\" \u003e\u00262 entra-auth-cli refresh --profile \"$profile\" 2\u003e/dev/null || entra-auth-cli get-token --profile \"$profile\" --force sleep 2 fi done return 1 } # Usage if discover_token production; then echo \"Token ready\" else echo \"Failed to get valid token\" exit 1 fi Automation Examples linkCron Job Validation link #!/bin/bash # /etc/cron.hourly/check-tokens PROFILES=(\"app1\" \"app2\" \"app3\") LOG_FILE=\"/var/log/token-check.log\" { echo \"=== Token Check: $(date) ===\" for profile in \"${PROFILES[@]}\"; do if entra-auth-cli discover --profile \"$profile\" --quiet; then echo \"$profile: OK\" else echo \"$profile: INVALID - Attempting refresh\" if entra-auth-cli refresh --profile \"$profile\" 2\u003e\u00261; then echo \"$profile: Refreshed successfully\" else echo \"$profile: FAILED to refresh - Manual intervention needed\" fi fi done echo \"\" } \u003e\u003e \"$LOG_FILE\" Docker Healthcheck link FROM ubuntu:22.04 # Install entra-auth-cli RUN curl -L https://github.com/garrardkitchen/entra-token-cli/releases/latest/download/entra-auth-cli-linux-amd64 \\ -o /usr/local/bin/entra-auth-cli \u0026\u0026 chmod +x /usr/local/bin/entra-auth-cli # Healthcheck using discover HEALTHCHECK --interval=60s --timeout=10s --start-period=30s --retries=3 \\ CMD entra-auth-cli discover --profile app --quiet || exit 1 CMD [\"/app/start.sh\"] Kubernetes Liveness Probe link apiVersion: v1 kind: Pod metadata: name: app-with-token-check spec: containers: - name: app image: myapp:latest livenessProbe: exec: command: - /usr/local/bin/entra-auth-cli - discover - --profile - k8s-app - --quiet initialDelaySeconds: 30 periodSeconds: 60 timeoutSeconds: 10 failureThreshold: 3 Tips linkCombine with Other Commands link # Discover + get-token (with automatic refresh) if ! entra-auth-cli discover --profile prod --quiet; then entra-auth-cli get-token --profile prod --force fi # Discover + inspect (conditional detailed check) if ! entra-auth-cli discover --profile prod --quiet; then echo \"Token invalid. Details:\" entra-auth-cli inspect --profile prod fi # Pipeline: discover → refresh → use entra-auth-cli discover --profile prod --quiet || entra-auth-cli refresh --profile prod TOKEN=$(entra-auth-cli get-token --profile prod --silent) Batch Checking link # Check all profiles for profile in $(entra-auth-cli config list); do if entra-auth-cli discover --profile \"$profile\" --quiet; then echo \"✓ $profile\" else echo \"✗ $profile\" fi done JSON Processing link # Extract specific fields EXPIRES_IN=$(entra-auth-cli discover --profile prod --output json | jq -r .expires_in) EXPIRED=$(entra-auth-cli discover --profile prod --output json | jq -r .expired) # Conditional logic based on fields if [ \"$(entra-auth-cli discover --profile prod --output json | jq -r .expired)\" == \"true\" ]; then entra-auth-cli refresh --profile prod fi See Also link inspect - Full token decoding and inspection get-token - Generate access tokens refresh - Refresh expired tokens Generating Tokens - Token generation guide "
            }
        );
    index.add(
            {
                id:  34 ,
                href: "\/docs\/oauth-flows\/interactive-browser\/",
                title: "Interactive Browser Flow",
                description: "User authentication with local browser sign-in",
                content: "Interactive Browser Flow linkThe Interactive Browser flow provides seamless user authentication by opening your system’s default web browser for sign-in, then automatically returning tokens to the CLI. This is the recommended flow for desktop applications and CLI tools that need user authentication.\nOverview linkUse this flow when:\nYou need user authentication in a CLI or desktop app User has access to a local web browser You want the best user experience for interactive authentication Working with delegated permissions (on behalf of a user) Key benefits:\nSeamless browser integration Supports all Entra ID features (MFA, Conditional Access) Automatic token handling No redirect URI configuration needed Quick Start link # Authenticate with interactive browser entra-auth-cli get-token --flow interactive # With specific profile entra-auth-cli get-token --flow interactive --profile myapp # With custom scopes entra-auth-cli get-token --flow interactive \\ --scope https://graph.microsoft.com/User.Read How It Works linksequenceDiagram participant CLI as Entra Auth Cli participant Browser participant EntraID as Microsoft Entra ID participant User User-\u003e\u003eCLI: get-token --flow interactive CLI-\u003e\u003eCLI: Start local HTTP server CLI-\u003e\u003eBrowser: Open system browser Browser-\u003e\u003eEntraID: Navigate to login page User-\u003e\u003eBrowser: Enter credentials EntraID-\u003e\u003eBrowser: Redirect with auth code Browser-\u003e\u003eCLI: Send code to local server CLI-\u003e\u003eEntraID: Exchange code for tokens EntraID-\u003e\u003eCLI: Return tokens CLI-\u003e\u003eUser: Display success, save tokens Flow Steps link CLI starts local server - Listens on localhost for callback Browser opens - System default browser launches User signs in - Microsoft Entra ID login page Callback - Browser redirects to local server with auth code Token exchange - CLI exchanges code for tokens Complete - Tokens saved and displayed Configuration linkProfile Setup linkCreate a profile for interactive browser flow:\nentra-auth-cli create-profile --name interactive-app When prompted:\nProfile Name: Identifier for this configuration Tenant ID: Your Microsoft Entra tenant ID Client ID: Public client application ID Flow: interactive (optional default) Scopes: Delegated permissions Azure App Registration linkConfigure app registration for interactive browser flow:\n# Create public client application az ad app create \\ --display-name \"CLI Interactive App\" \\ --sign-in-audience AzureADMyOrg \\ --enable-access-token-issuance true # Get the application ID APP_ID=$(az ad app list --display-name \"CLI Interactive App\" --query '[0].appId' -o tsv) # Configure as public client az ad app update \\ --id $APP_ID \\ --is-fallback-public-client true # Add redirect URI for local loopback az ad app update \\ --id $APP_ID \\ --web-redirect-uris \"http://localhost\" Required settings:\nApplication type: Public client Redirect URI: http://localhost (any port) Platform: Mobile and desktop applications Permissions: Delegated permissions only Usage Examples linkBasic Authentication link # Default profile, default scopes entra-auth-cli get-token --flow interactive # Specific profile entra-auth-cli get-token --flow interactive --profile production # Override scopes entra-auth-cli get-token --flow interactive \\ --scope \"https://graph.microsoft.com/User.Read https://graph.microsoft.com/Mail.Read\" With Microsoft Graph link # Get token for Graph API TOKEN=$(entra-auth-cli get-token --flow interactive \\ --scope https://graph.microsoft.com/User.Read \\ --output json | jq -r .access_token) # Read user profile curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me | jq . In Scripts link #!/bin/bash set -euo pipefail # Function to get token with interactive flow get_user_token() { local scopes=\"${1:-https://graph.microsoft.com/User.Read}\" echo \"Authenticating... Browser will open shortly.\" \u003e\u00262 if ! token_json=$(entra-auth-cli get-token \\ --flow interactive \\ --scope \"$scopes\" \\ --output json 2\u003e/dev/null); then echo \"Authentication failed\" \u003e\u00262 return 1 fi echo \"$token_json\" | jq -r .access_token } # Use the token echo \"Getting your profile...\" TOKEN=$(get_user_token) curl -s -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me \\ | jq '{name: .displayName, email: .mail, jobTitle: .jobTitle}' Silent Authentication linkAfter initial sign-in, tokens are cached:\n# First run - browser opens entra-auth-cli get-token --flow interactive --profile myapp # Subsequent runs - uses cached token (no browser) entra-auth-cli get-token --profile myapp # Token automatically refreshed when expired User Experience linkFirst-Time Authentication link $ entra-auth-cli get-token --flow interactive Opening browser for authentication... ✓ Browser opened ⏳ Waiting for sign-in... [Browser opens to Microsoft login page] ✓ Authentication successful! Token expires: 2025-12-28 15:30:00 Token saved to profile 'default' Cached Token (Subsequent Runs) link $ entra-auth-cli get-token ✓ Using cached token Token expires: 2025-12-28 15:30:00 Token Refresh (Auto) link $ entra-auth-cli get-token ⟳ Refreshing expired token... ✓ Token refreshed Token expires: 2025-12-28 16:30:00 Browser Behavior linkSystem Default Browser linkThe CLI automatically detects and opens your system’s default browser:\n# macOS - opens Safari/Chrome/Firefox (whatever is default) open https://login.microsoftonline.com/... # Windows - opens Edge/Chrome/Firefox start https://login.microsoftonline.com/... # Linux - opens default browser xdg-open https://login.microsoftonline.com/... Custom Browser linkSet environment variable to use specific browser:\n# Use Chrome BROWSER=google-chrome entra-auth-cli get-token --flow interactive # Use Firefox BROWSER=firefox entra-auth-cli get-token --flow interactive # Use specific browser path BROWSER=\"/Applications/Firefox.app/Contents/MacOS/firefox\" \\ entra-auth-cli get-token --flow interactive Headless Environments linkIf browser cannot open (e.g., SSH session without X11):\n# CLI detects no display and falls back to device code entra-auth-cli get-token --flow interactive Output: No display detected. Falling back to device code flow. To sign in, use a web browser to open: https://microsoft.com/devicelogin And enter code: ABCD-EFGH Local Server Port linkThe CLI starts a temporary HTTP server for the OAuth callback:\n# Random available port (default) entra-auth-cli get-token --flow interactive # Specific port entra-auth-cli get-token --flow interactive --port 8080 # Port range entra-auth-cli get-token --flow interactive --port-range 8000-8100 Port selection:\nDefault: Random available port between 49152-65535 Automatically finds available port Server stops after receiving callback No persistent server process Security Features linkPKCE (Proof Key for Code Exchange) linkAlways enabled for maximum security:\n1. CLI generates random code verifier 2. Creates SHA256 hash (code challenge) 3. Sends challenge in auth request 4. Sends verifier in token exchange 5. Entra ID validates match State Parameter linkPrevents CSRF attacks:\n1. CLI generates random state token 2. Includes in authorization request 3. Validates match in callback 4. Rejects mismatched state HTTPS Enforcement link Authorization requests use HTTPS Token exchanges use HTTPS Only callback uses HTTP localhost (secure by design) Token Storage linkTokens stored securely per platform:\nWindows: DPAPI encrypted storage macOS: Keychain Linux: Encrypted file with user-only permissions Advanced Features linkMultiple Accounts linkSwitch between user accounts:\n# Create profiles for different users entra-auth-cli create-profile --name work entra-auth-cli create-profile --name personal # Authenticate with work account entra-auth-cli get-token --flow interactive --profile work # Authenticate with personal account entra-auth-cli get-token --flow interactive --profile personal # Switch accounts entra-auth-cli get-token --profile work entra-auth-cli get-token --profile personal Conditional Access linkSupports all Conditional Access policies:\nMFA: Automatically prompts for additional verification Device Compliance: Works with compliant device policies Location-Based: Respects IP/location restrictions Terms of Use: Shows ToU prompts when required Session Persistence link # Check token expiry entra-auth-cli inspect --profile myapp # Force refresh entra-auth-cli refresh --profile myapp # Clear cached token entra-auth-cli clear-cache --profile myapp # Re-authenticate entra-auth-cli get-token --flow interactive --profile myapp Troubleshooting linkBrowser Doesn’t Open linkProblem: Browser fails to open automatically\nSolutions:\n# 1. Check default browser setting # macOS defaults read com.apple.LaunchServices/com.apple.launchservices.secure | grep -A 2 browser # 2. Manually copy URL entra-auth-cli get-token --flow interactive --show-url # 3. Use specific browser BROWSER=firefox entra-auth-cli get-token --flow interactive # 4. Fall back to device code entra-auth-cli get-token --flow device-code Port Already in Use linkProblem: “Port 8080 is already in use”\nSolutions:\n# Use different port entra-auth-cli get-token --flow interactive --port 8081 # Use random available port (default) entra-auth-cli get-token --flow interactive # Check what's using the port lsof -i :8080 Timeout Waiting for Callback linkProblem: “Timeout waiting for authentication callback”\nSolutions:\n# 1. Verify redirect URI in Azure Portal # Must include: http://localhost # 2. Check firewall isn't blocking localhost # Temporarily disable firewall for testing # 3. Try specific port entra-auth-cli get-token --flow interactive --port 8080 # 4. Check browser console for errors # Look for CORS or redirect issues Cached Token Won’t Refresh linkProblem: Getting old/expired token\nSolutions:\n# Clear token cache entra-auth-cli clear-cache --profile myapp # Force re-authentication entra-auth-cli get-token --flow interactive --profile myapp --force # Delete and recreate profile entra-auth-cli delete-profile --name myapp entra-auth-cli create-profile --name myapp Platform-Specific Notes linkmacOS link # Default browser (Safari/Chrome/Firefox) entra-auth-cli get-token --flow interactive # Token storage: macOS Keychain # View tokens: security find-generic-password -s \"entra-auth-cli\" Windows link # Default browser (Edge/Chrome/Firefox) entra-auth-cli.exe get-token --flow interactive # Token storage: DPAPI # Encrypted per-user, per-machine Linux link # Default browser (Firefox/Chrome/Chromium) entra-auth-cli get-token --flow interactive # Token storage: Encrypted file # Location: ~/.entra-auth-cli/tokens.enc # Permissions: 600 (user-only) # Headless systems export DISPLAY=:0 # If X11 available entra-auth-cli get-token --flow interactive Best Practices linkProfile Organization link # Separate profiles by purpose entra-auth-cli create-profile --name graph-reader entra-auth-cli create-profile --name azure-admin entra-auth-cli create-profile --name mail-sender # Use descriptive names entra-auth-cli create-profile --name \"production-api\" entra-auth-cli create-profile --name \"dev-testing\" Scope Management link # Minimum required scopes entra-auth-cli get-token --flow interactive \\ --scope \"https://graph.microsoft.com/User.Read\" # Multiple scopes entra-auth-cli get-token --flow interactive \\ --scope \"User.Read Mail.Read Calendars.Read\" # Avoid .default with interactive flow # Be specific about delegated permissions needed Error Handling link get_token_safe() { local profile=\"${1:-default}\" local max_retries=2 local attempt=0 while [ $attempt -lt $max_retries ]; do if token=$(entra-auth-cli get-token \\ --flow interactive \\ --profile \"$profile\" \\ --output json 2\u003e/dev/null); then echo \"$token\" | jq -r .access_token return 0 fi attempt=$((attempt + 1)) if [ $attempt -lt $max_retries ]; then echo \"Retrying authentication...\" \u003e\u00262 sleep 2 fi done echo \"Authentication failed after $max_retries attempts\" \u003e\u00262 return 1 } Comparison with Other Flows link Feature Interactive Browser Device Code Client Credentials User Interaction Browser on same device Browser on any device None Browser Required Yes, local Yes, separate device No Auth Type Delegated Delegated Application MFA Support Full Full N/A Conditional Access Full Full Limited Best For Desktop apps, CLI Headless devices Services, automation User Experience Seamless Extra steps N/A Refresh Tokens Yes Yes No (always valid) Next Steps link Device Code Flow - Alternative for headless devices Client Credentials Flow - Service authentication Managing Profiles - Profile management guide Troubleshooting - Common authentication issues "
            }
        );
    index.add(
            {
                id:  35 ,
                href: "\/docs\/recipes\/",
                title: "Recipes \u0026 Examples",
                description: "Practical examples and common integration patterns",
                content: "Recipes \u0026 Examples linkReal-world examples and patterns for integrating Entra Auth Cli into your workflows.\nAPI Integration linkIntegrate with Microsoft APIs and your own services.\nMicrosoft Graph API →\nLearn how to:\nRead user profiles and directory data Send emails via Graph API Manage calendars and events Work with OneDrive and SharePoint List users and groups Azure Management API →\nLearn how to:\nList subscriptions and resource groups Create and manage virtual machines Deploy infrastructure resources Monitor Azure services Automate resource provisioning Automation linkBuild automated workflows and CI/CD pipelines.\nCI/CD Integration →\nLearn how to:\nIntegrate with GitHub Actions Configure Azure Pipelines Automate token generation Secure secrets in CI/CD Deploy with authentication Bash Scripting →\nLearn how to:\nCache tokens for performance Implement error handling with retries Create multi-API scripts Handle token expiration Build robust automation PowerShell Integration →\nLearn how to:\nRetrieve tokens in PowerShell Cache tokens in scripts Handle errors gracefully Integrate with Windows automation Use with Azure cmdlets Security linkImplement security best practices and patterns.\nSecurity Hardening →\nLearn how to:\nSecure token storage Separate development and production Implement secret rotation Use environment-specific profiles Follow least privilege principles Advanced Patterns linkAdvanced techniques for complex scenarios.\nCommon Patterns →\nLearn how to:\nHandle API rate limiting Make parallel API calls Implement conditional token refresh Build resilient integrations Optimize performance Quick Examples linkMicrosoft Graph API link # Read user profile TOKEN=$(entra-auth-cli get-token -p graph-readonly --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me | jq Azure Management API link # List subscriptions TOKEN=$(entra-auth-cli get-token -p azure-mgmt --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://management.azure.com/subscriptions?api-version=2020-01-01' | jq Shell Scripting link # Token caching get_token() { local cache=\"/tmp/token-cache.txt\" if [ -f \"$cache\" ] \u0026\u0026 entra-auth-cli discover -f \"$cache\" \u0026\u003e/dev/null; then cat \"$cache\" else entra-auth-cli get-token -p my-profile --silent | tee \"$cache\" fi } Next Steps link Core Concepts - Understand OAuth2 flows and scopes User Guide - Day-to-day usage patterns Command Reference - Complete CLI documentation "
            }
        );
    index.add(
            {
                id:  36 ,
                href: "\/docs\/core-concepts\/secure-storage\/",
                title: "Secure Storage",
                description: "How secrets and certificates are stored securely",
                content: "Secure Storage linkEntra Auth Cli uses platform-specific secure storage mechanisms to protect sensitive authentication data. Understanding how secrets are stored helps you make informed security decisions.\nPlatform Security Overview link Platform Mechanism Security Level Notes Windows DPAPI 🔒 Strong User-account encryption macOS Keychain 🔒 Strong System-level encryption Linux XOR Obfuscation ⚠️ Weak Not secure for production What Gets Stored linkProfile Configuration (Plaintext) linkLocation: ~/.entra-auth-cli/profiles.json\nStored in plaintext:\nProfile name Client ID Tenant ID Scope Authority URL OAuth2 flow preference Example:\n{ \"profiles\": [ { \"name\": \"my-service-principal\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\" } ] } Secrets (Encrypted) linkWhat’s encrypted:\nClient secrets Certificate passwords Private key data Storage location:\nWindows: DPAPI-encrypted data macOS: Keychain access Linux: XOR-obfuscated file Windows Security (DPAPI) linkHow It Works linkData Protection API (DPAPI):\nBuilt into Windows Uses user account credentials to encrypt data Data is automatically tied to user profile Security Properties:\n✅ Strong encryption (AES-256) ✅ Automatic key management ✅ Per-user encryption ✅ OS-level protection Storage Location linkEncrypted data is stored in user-specific Windows data stores. The exact location is managed by Windows.\nAccess Control link Only the same user account on the same machine can decrypt Administrator accounts cannot decrypt another user’s DPAPI data Backing up and restoring requires user profile migration Security Considerations link✅ Safe for:\nDevelopment workstations Single-user systems Corporate managed devices ⚠️ Be aware:\nData is tied to user profile Lost password = lost data (unless backed up properly) Malware running under your account can access macOS Security (Keychain) linkHow It Works linkmacOS Keychain:\nSystem-level secure storage Encrypted with user’s login password Managed by macOS Security framework Security Properties:\n✅ Strong encryption (AES-256) ✅ Integration with Touch ID / Face ID ✅ Per-item access control ✅ Audit logging Storage Location link ~/Library/Keychains/login.keychain-db Note: Keychain is encrypted; you cannot read it directly.\nViewing Secrets linkOpen Keychain Access app:\nLaunch: /Applications/Utilities/Keychain Access.app Search for: entra-auth-cli Double-click item → “Show password” Authenticate with your login password Screenshot:\nAccess Control link Requires user authentication to access Can be protected by Touch ID Can set per-item access policies Exporting Keychain linkYou can export secrets for backup:\nsecurity export -k login.keychain-db -t identities -o backup.p12 ⚠️ Warning: Exported files contain unencrypted secrets. Protect them carefully.\nSecurity Considerations link✅ Safe for:\nDevelopment workstations Personal Macs Production automation (with proper access controls) ⚠️ Be aware:\nMalware with keychain access can extract secrets User password compromise = keychain compromise Backup keychain securely Linux Security (XOR Obfuscation) link⚠️ Security Warning link report Linux storage is NOT secure for production use.\nSecrets are obfuscated using XOR encoding, which provides no real security. Anyone with access to the file can easily reverse the obfuscation.\nHow It Works linkXOR Obfuscation:\nSimple XOR cipher with fixed key Not encryption — just encoding Prevents casual viewing in text editors Security Properties:\n❌ No real protection ❌ Easily reversible ❌ Fixed obfuscation key in source code Storage Location link ~/.entra-auth-cli/secrets.dat Warning: This file contains your secrets in an easily decodable format.\nWhy XOR? linkLinux lacks a universal, secure secret storage mechanism:\nKeyring services vary by distribution (GNOME Keyring, KWallet, etc.) Not always available on servers or minimal installs Inconsistent APIs across distributions XOR obfuscation is a lowest common denominator approach that works everywhere but provides minimal security.\nLinux Alternatives link1. Environment Variables linkStore secrets in environment variables:\nexport AZURE_CLIENT_SECRET=\"your-secret\" entra-auth-cli get-token -p myprofile Profile without stored secret:\n{ \"name\": \"myprofile\", \"clientId\": \"...\", \"useClientSecret\": true // No \"clientSecret\" field } The tool will read from AZURE_CLIENT_SECRET if available.\n2. Azure Key Vault linkStore secrets in Azure Key Vault and retrieve at runtime:\nSECRET=$(az keyvault secret show --vault-name MyVault --name ClientSecret --query value -o tsv) entra-auth-cli get-token -p myprofile --client-secret \"$SECRET\" 3. HashiCorp Vault link SECRET=$(vault kv get -field=client_secret secret/entra-auth-cli) entra-auth-cli get-token -p myprofile --client-secret \"$SECRET\" 4. Certificate Authentication linkUse certificates instead of secrets (more secure):\nentra-auth-cli config create # Select: Certificate # Provide: /path/to/cert.pfx Certificates can be stored with restricted file permissions:\nchmod 600 /path/to/cert.pfx chown myuser:myuser /path/to/cert.pfx 5. Managed Identity (Azure VMs) linkOn Azure VMs, use Managed Identity (no secrets needed):\n# Configure VM with Managed Identity # No secrets stored locally entra-auth-cli get-token -p managed-identity-profile Security Recommendations link warning For production Linux workloads:\nUse certificate authentication instead of client secrets Store certificates with strict file permissions (600) Use external secret managers (Azure Key Vault, Vault) Use Managed Identity on Azure VMs Rotate secrets frequently Monitor secret access DO NOT rely on ~/.entra-auth-cli/secrets.dat for production security.\nCertificate Storage linkHow Certificates Are Stored linkCertificates are not stored by the tool. You provide the certificate path:\n{ \"name\": \"cert-profile\", \"certificatePath\": \"/path/to/certificate.pfx\" } Certificate Security linkSecurity depends on:\nFile permissions on certificate file Password protection of PFX/PKCS12 file Storage location security Best Practices link1. Restrict File Permissions link # Linux/macOS chmod 600 /path/to/cert.pfx chown myuser:myuser /path/to/cert.pfx # Windows icacls cert.pfx /inheritance:r /grant:r \"%USERNAME%:F\" 2. Password-Protect Certificates linkAlways use password-protected PFX files:\n# Convert to password-protected PFX openssl pkcs12 -export -in cert.pem -inkey key.pem \\ -out cert.pfx -password pass:YourStrongPassword 3. Store in Secure Locations linkmacOS:\n# Store in user-protected directory ~/Library/Application Support/entra-auth-cli/certs/ Windows:\n# Store in user profile %USERPROFILE%\\.entra-auth-cli\\certs\\ Linux:\n# Store with restricted permissions ~/.entra-auth-cli/certs/ chmod 700 ~/.entra-auth-cli/certs/ 4. Use Certificate Stores linkWindows Certificate Store:\n# Import certificate to Windows store certutil -user -p YourPassword -importPFX cert.pfx # Reference by thumbprint in profile \"certificateThumbprint\": \"ABC123...\" macOS Keychain:\n# Import to Keychain security import cert.pfx -k login.keychain -P YourPassword # Reference by name \"certificateName\": \"My Certificate\" Secret Lifecycle link1. Secret Creation linkClient Secret:\nentra-auth-cli config create # Select: Client Secret # Enter: your-secret-here # ✓ Encrypted and stored securely Certificate:\nentra-auth-cli config create # Select: Certificate # Enter: /path/to/cert.pfx # Enter password: **** # ✓ Password encrypted and stored # ✓ Certificate path stored (plaintext) 2. Secret Usage linkWhen generating tokens:\nProfile is read from profiles.json Secrets are decrypted from secure storage Used for authentication Never written to logs or disk unencrypted 3. Secret Rotation linkUpdate secrets regularly:\n# Edit profile and update secret entra-auth-cli config edit -p myprofile # Select: Client Secret or Certificate # Enter new secret # ✓ Old secret overwritten 4. Secret Deletion linkWhen deleting a profile:\nentra-auth-cli config delete -p myprofile # ✓ Profile removed from profiles.json # ✓ Associated secrets removed from secure storage Security Audit linkChecking What’s Stored linkList Profiles link entra-auth-cli config list View Profile Details link # View non-sensitive profile data cat ~/.entra-auth-cli/profiles.json | jq Check Keychain (macOS) link security find-generic-password -s entra-auth-cli -g DPAPI Inventory (Windows) linkUse specialized tools like dpapick to audit DPAPI-protected data.\nBest Practices link✅ Development link Use platform secure storage (DPAPI on Windows, Keychain on macOS) Separate profiles for dev/test/prod Short-lived secrets Regular rotation ✅ Production linkWindows/macOS:\nPlatform secure storage is acceptable Certificates preferred over secrets Regular audits Linux:\n⚠️ Do not use built-in storage Use external secret manager (Key Vault, Vault) Or use certificate authentication with restricted file permissions Or use Managed Identity ✅ CI/CD link Store secrets in CI/CD secret manager (GitHub Secrets, Azure Pipelines) Inject at runtime Never commit secrets to git Use short-lived tokens ❌ Never link ❌ Commit profiles.json to git ❌ Share secrets via email/Slack ❌ Store secrets in plaintext files ❌ Use the same secret across environments ❌ Trust Linux XOR storage for production Troubleshooting link“Access to secure storage denied” linkWindows:\nUser profile may be corrupted Try running as the correct user macOS:\nKeychain may be locked Open Keychain Access and unlock “Cannot decrypt secret” linkCause: Secret was encrypted on different machine or user account\nFix:\nDelete profile: entra-auth-cli config delete -p myprofile Recreate profile: entra-auth-cli config create Re-enter secret Migrating Secrets linkSecrets are tied to user accounts and machines. To migrate:\nExport profile configuration (plaintext):\ncat ~/.entra-auth-cli/profiles.json On new machine, recreate profile:\nentra-auth-cli config create # Re-enter all secrets Note: Secrets cannot be exported/imported directly due to encryption.\nNext Steps link Creating Profiles Certificate Authentication Guide Production Deployment Security Best Practices "
            }
        );
    index.add(
            {
                id:  37 ,
                href: "\/docs\/reference\/config\/",
                title: "config",
                description: "Manage authentication profiles",
                content: "config linkManage authentication profiles for storing connection settings and credentials.\nSynopsis link entra-auth-cli config [flags] Description linkThe config command manages authentication profiles, which store tenant information, client credentials, and authentication settings. Profiles allow you to easily switch between different applications, environments, or authentication methods.\nEach profile contains:\nTenant ID Client ID Authentication method (client secret or certificate) Default scopes Other configuration options Subcommands linkcreate linkCreate a new authentication profile.\nentra-auth-cli config create [flags] Flags:\n--name, -n - Profile name --tenant-id - Azure tenant ID --client-id - Application client ID --client-secret - Client secret (interactive prompt if not provided) --certificate - Path to certificate file (PFX/PEM) --certificate-password - Certificate password --scope - Default scopes (space-separated) --interactive - Use interactive prompts for all fields Examples:\n# Interactive creation (recommended) entra-auth-cli config create # With flags entra-auth-cli config create \\ --name production \\ --tenant-id \"12345678-1234-1234-1234-123456789012\" \\ --client-id \"87654321-4321-4321-4321-210987654321\" \\ --client-secret \"your-secret\" # With certificate entra-auth-cli config create \\ --name secure-app \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --certificate \"./cert.pfx\" \\ --certificate-password \"password\" # With custom scopes entra-auth-cli config create \\ --name graph-api \\ --scope \"User.Read Mail.Read Calendars.Read\" list linkList all configured profiles.\nentra-auth-cli config list [flags] Flags:\n--output, -o - Output format (text, json, yaml) --verbose, -v - Show additional details Examples:\n# Simple list entra-auth-cli config list # With details entra-auth-cli config list --verbose # JSON output entra-auth-cli config list --output json show linkDisplay detailed information about a profile.\nentra-auth-cli config show [flags] Flags:\n--name, -n - Profile name --output, -o - Output format (text, json, yaml) --show-secrets - Show sensitive values (use with caution) Examples:\n# Show profile details entra-auth-cli config show --name production # JSON format entra-auth-cli config show --name production --output json # Show with secrets (sensitive) entra-auth-cli config show --name production --show-secrets edit linkEdit an existing profile.\nentra-auth-cli config edit [flags] Flags:\n--name, -n - Profile name --tenant-id - Update tenant ID --client-id - Update client ID --client-secret - Update client secret --certificate - Update certificate --scope - Update default scopes --interactive - Use interactive editor Examples:\n# Interactive edit entra-auth-cli config edit --name production # Update specific fields entra-auth-cli config edit --name production --scope \"User.Read Mail.Send\" # Update credentials entra-auth-cli config edit --name production --client-secret \"new-secret\" # Switch to certificate auth entra-auth-cli config edit --name production \\ --certificate \"./new-cert.pfx\" \\ --certificate-password \"password\" delete linkDelete a profile.\nentra-auth-cli config delete [flags] Flags:\n--name, -n - Profile name --force, -f - Skip confirmation prompt Examples:\n# Delete with confirmation entra-auth-cli config delete --name old-profile # Force delete (no confirmation) entra-auth-cli config delete --name old-profile --force # Delete multiple profiles for profile in old-dev old-test old-staging; do entra-auth-cli config delete --name \"$profile\" --force done export linkExport profile configuration to a file.\nentra-auth-cli config export [flags] Flags:\n--name, -n - Profile name (or all profiles if omitted) --output, -o - Output file path --include-secrets - Include sensitive data (use with caution) Examples:\n# Export single profile entra-auth-cli config export --name production \u003e production-profile.json # Export all profiles entra-auth-cli config export \u003e all-profiles.json # Export with secrets (for backup/migration) entra-auth-cli config export --name production --include-secrets \u003e backup.json import linkImport profile configuration from a file.\nentra-auth-cli config import [flags] Flags:\n--file, -f - Input file path --overwrite - Overwrite existing profiles --dry-run - Show what would be imported without making changes Examples:\n# Import from file entra-auth-cli config import --file production-profile.json # Import from stdin cat production-profile.json | entra-auth-cli config import # Import with overwrite entra-auth-cli config import --file all-profiles.json --overwrite # Dry run to preview entra-auth-cli config import --file backup.json --dry-run Complete Examples linkCreating Profiles linkClient Secret Authentication link # Interactive (recommended for first-time users) entra-auth-cli config create # You'll be prompted for: # - Profile name: production # - Tenant ID: 12345678-1234-1234-1234-123456789012 # - Client ID: 87654321-4321-4321-4321-210987654321 # - Auth method: client-secret # - Client secret: (hidden input) # - Scopes: https://graph.microsoft.com/.default Certificate Authentication link # Create with certificate entra-auth-cli config create \\ --name secure-prod \\ --tenant-id \"$TENANT_ID\" \\ --client-id \"$CLIENT_ID\" \\ --certificate \"./certs/production.pfx\" \\ --certificate-password \"$CERT_PASSWORD\" \\ --scope \"https://graph.microsoft.com/.default\" Multiple Environments link # Development environment entra-auth-cli config create --name dev \\ --tenant-id \"$DEV_TENANT_ID\" \\ --client-id \"$DEV_CLIENT_ID\" \\ --client-secret \"$DEV_SECRET\" # Staging environment entra-auth-cli config create --name staging \\ --tenant-id \"$STAGING_TENANT_ID\" \\ --client-id \"$STAGING_CLIENT_ID\" \\ --client-secret \"$STAGING_SECRET\" # Production environment entra-auth-cli config create --name production \\ --tenant-id \"$PROD_TENANT_ID\" \\ --client-id \"$PROD_CLIENT_ID\" \\ --certificate \"./certs/prod.pfx\" Managing Profiles linkList and View link # List all profiles entra-auth-cli config list # Output: # default # production # staging # dev # graph-api # Show details of specific profile entra-auth-cli config show --name production # Output: # Profile: production # Tenant ID: 12345678-1234-1234-1234-123456789012 # Client ID: 87654321-4321-4321-4321-210987654321 # Auth Method: certificate # Certificate: /path/to/cert.pfx # Default Scopes: https://graph.microsoft.com/.default Update Configuration link # Change default scopes entra-auth-cli config edit --name production \\ --scope \"User.Read Mail.Read Calendars.Read\" # Rotate client secret entra-auth-cli config edit --name production \\ --client-secret \"$NEW_SECRET\" # Switch from secret to certificate entra-auth-cli config edit --name production \\ --certificate \"./new-cert.pfx\" \\ --certificate-password \"$CERT_PASS\" Backup and Migration linkBackup Profiles link #!/bin/bash # Backup all profiles BACKUP_DIR=\"./profile-backups\" TIMESTAMP=$(date +%Y%m%d_%H%M%S) mkdir -p \"$BACKUP_DIR\" # Export each profile for profile in $(entra-auth-cli config list); do echo \"Backing up profile: $profile\" entra-auth-cli config export --name \"$profile\" --include-secrets \\ \u003e \"$BACKUP_DIR/${profile}_${TIMESTAMP}.json\" done echo \"Backup complete: $BACKUP_DIR\" Migrate to New Machine link # On old machine entra-auth-cli config export --include-secrets \u003e profiles-backup.json # Transfer file to new machine scp profiles-backup.json user@newmachine:/tmp/ # On new machine entra-auth-cli config import --file /tmp/profiles-backup.json # Verify entra-auth-cli config list Environment-Based Configuration link #!/bin/bash # Script to create profiles based on environment create_env_profile() { local env=\"$1\" local tenant_var=\"${env}_TENANT_ID\" local client_var=\"${env}_CLIENT_ID\" local secret_var=\"${env}_CLIENT_SECRET\" echo \"Creating profile for $env environment...\" entra-auth-cli config create \\ --name \"$env\" \\ --tenant-id \"${!tenant_var}\" \\ --client-id \"${!client_var}\" \\ --client-secret \"${!secret_var}\" \\ --scope \"https://graph.microsoft.com/.default\" } # Create profiles for each environment for env in DEV STAGING PRODUCTION; do create_env_profile \"$env\" done echo \"All profiles created:\" entra-auth-cli config list Validation Script link #!/bin/bash # Validate all profiles can generate tokens echo \"Validating profiles...\" failed=0 for profile in $(entra-auth-cli config list); do echo -n \"Testing $profile... \" if entra-auth-cli get-token --profile \"$profile\" --output json \u003e /dev/null 2\u003e\u00261; then echo \"✓ OK\" else echo \"✗ FAILED\" failed=$((failed + 1)) fi done if [ $failed -eq 0 ]; then echo \"All profiles valid!\" exit 0 else echo \"$failed profile(s) failed validation\" exit 1 fi Profile Storage linkProfiles are stored in platform-specific locations:\nWindows link %LOCALAPPDATA%\\EntraAuthCli\\profiles\\ macOS link ~/Library/Application Support/entra-auth-cli/profiles/ Linux link ~/.entra-auth-cli/profiles/ Each profile consists of:\nprofile-name.json - Configuration profile-name.token - Encrypted tokens (if cached) Security Best Practices linkSecrets Management link # ✅ Good - use environment variables export CLIENT_SECRET=$(vault read -field=secret secret/azure/client) entra-auth-cli config create --client-secret \"$CLIENT_SECRET\" # ✅ Good - interactive prompt (hides input) entra-auth-cli config create # Will prompt for secret # ❌ Bad - hardcoded in script entra-auth-cli config create --client-secret \"my-secret-123\" # ❌ Bad - visible in command history entra-auth-cli config create --client-secret \"$SECRET\" # If $SECRET expands Profile Naming link # ✅ Good - descriptive names entra-auth-cli config create --name prod-graph-api entra-auth-cli config create --name staging-azure-mgmt entra-auth-cli config create --name dev-user-app # ❌ Avoid - generic names entra-auth-cli config create --name app1 entra-auth-cli config create --name test Regular Rotation link #!/bin/bash # Rotate secrets for all profiles for profile in $(entra-auth-cli config list); do echo \"Rotating secret for $profile\" # Get new secret from vault NEW_SECRET=$(vault read -field=secret \"secret/azure/$profile\") # Update profile entra-auth-cli config edit --name \"$profile\" --client-secret \"$NEW_SECRET\" # Verify if entra-auth-cli get-token --profile \"$profile\" \u003e /dev/null; then echo \"✓ $profile updated successfully\" else echo \"✗ $profile update failed\" fi done Troubleshooting linkProfile Not Found link # List available profiles entra-auth-cli config list # Check exact name (case-sensitive) entra-auth-cli config show --name Production # Won't match \"production\" Cannot Create Profile link # Check storage directory permissions # Linux/macOS ls -la ~/.entra-auth-cli/profiles/ chmod 700 ~/.entra-auth-cli/profiles/ # Windows (PowerShell) Test-Path \"$env:LOCALAPPDATA\\EntraAuthCli\\profiles\" Profile Corruption link # View raw profile file # Linux/macOS cat ~/.entra-auth-cli/profiles/production.json # If corrupted, delete and recreate entra-auth-cli config delete --name production --force entra-auth-cli config create --name production See Also link Managing Profiles - Detailed profile management guide get-token - Generate tokens using profiles Security Best Practices - Secure configuration practices "
            }
        );
    index.add(
            {
                id:  38 ,
                href: "\/docs\/oauth-flows\/",
                title: "OAuth2 Flows",
                description: "Detailed guides for each OAuth2 authentication flow",
                content: "OAuth2 Flows linkComprehensive guides for each supported OAuth2 authentication flow.\nSupported Flows linkEntra Auth Cli supports four OAuth2 authentication flows, each designed for specific scenarios.\nService-to-Service linkClient Credentials Flow →\nBest for: Automated services, daemons, CI/CD pipelines\nCharacteristics:\nNo user interaction required Uses client secret or certificate Application permissions only Highest security with certificates User Authentication linkInteractive Browser Flow →\nBest for: Desktop applications, CLI tools with user authentication\nCharacteristics:\nOpens browser for user sign-in Delegated permissions Uses system default browser Cached credentials Device Code Flow →\nBest for: Headless devices, IoT, SSH sessions\nCharacteristics:\nSign in on another device Works without local browser User-friendly for limited-input devices 15-minute time window Authorization Code Flow →\nBest for: Web applications with user sign-in\nCharacteristics:\nRedirect-based authentication Requires web server callback Most secure user flow Supports refresh tokens Flow Comparison link Flow User Interaction Best For Security Level Client Credentials None Services Highest (with cert) Interactive Browser Required Desktop apps High Device Code Required (other device) Headless Medium-High Authorization Code Required Web apps High Quick Examples linkClient Credentials link entra-auth-cli get-token -p service-principal -f ClientCredentials Interactive Browser link entra-auth-cli get-token -p desktop-app -f InteractiveBrowser Device Code link entra-auth-cli get-token -p iot-device -f DeviceCode Authorization Code link entra-auth-cli get-token -p webapp -f AuthorizationCode Automatic Flow Selection linkThe tool automatically selects the appropriate flow based on your profile configuration:\nClient Secret or Certificate configured → Client Credentials flow No client secret/certificate → Interactive Browser flow Manual Override link # Override automatic selection entra-auth-cli get-token -p myprofile -f DeviceCode Next Steps link Client Credentials Flow Interactive Browser Flow Device Code Flow Core Concepts: OAuth2 Flows "
            }
        );
    index.add(
            {
                id:  39 ,
                href: "\/docs\/certificates\/",
                title: "Certificate Authentication",
                description: "Using certificates for secure authentication",
                content: "Certificate Authentication linkLearn how to use X.509 certificates for secure, passwordless authentication with Microsoft Entra ID.\nWhy Use Certificates? linkCertificates provide stronger security than client secrets and are recommended for production deployments.\nOverview →\nLearn about:\nAdvantages over client secrets When to use certificates vs secrets Certificate types and formats Security benefits Getting Started linkStep-by-step guides for certificate authentication.\nCreating Certificates →\nLearn how to:\nGenerate self-signed certificates for testing Request CA-signed certificates for production Convert certificate formats (PEM to PFX) Create certificates on Windows, macOS, and Linux Registering in Azure →\nLearn how to:\nUpload certificates to app registrations Extract public keys from PFX files Verify certificate thumbprints Manage certificates in Azure Portal Configuring Profiles →\nLearn how to:\nCreate profiles with certificate authentication Configure certificate paths Store certificate passwords securely Update existing profiles to use certificates Certificate Management linkAdvanced topics for managing certificates in production.\nCertificate Storage →\nLearn how to:\nStore certificates securely on the filesystem Use Windows Certificate Store Use macOS Keychain Set proper file permissions Using Certificates →\nLearn how to:\nGenerate tokens with certificate profiles Understand certificate password caching Troubleshoot common issues Monitor certificate usage Certificate Rotation →\nLearn how to:\nPlan certificate rotation schedules Rotate certificates without downtime Automate rotation processes Test new certificates safely Validation \u0026 Troubleshooting →\nLearn how to:\nCheck certificate expiration dates Verify certificate thumbprints Diagnose certificate errors Fix common problems Quick Start link # 1. Create a self-signed certificate (development only) openssl req -x509 -newkey rsa:4096 \\ -keyout key.pem -out cert.pem \\ -days 730 -nodes \\ -subj \"/CN=MyApp\" # 2. Convert to PFX openssl pkcs12 -export \\ -in cert.pem -inkey key.pem \\ -out certificate.pfx \\ -password pass:YourPassword # 3. Upload public key to Azure Portal # Extract public key: openssl pkcs12 -in certificate.pfx -nokeys -out certificate.cer # 4. Create profile with certificate entra-auth-cli config create # Select: Certificate # Path: /path/to/certificate.pfx # Password: **** # 5. Generate token entra-auth-cli get-token -p cert-profile Security Best Practices link✅ Do link Use certificates for production service principals Store certificates with restrictive file permissions (600) Rotate certificates annually or per policy Use CA-signed certificates for production Monitor certificate expiration dates Use separate certificates for dev/staging/prod ❌ Don’t link Store certificates in git repositories Share certificates via email/Slack Use weak certificate passwords Ignore certificate expiration warnings Reuse certificates across environments Next Steps link Creating Certificates Configuring Profiles Security Hardening Platform Guides "
            }
        );
    index.add(
            {
                id:  40 ,
                href: "\/docs\/reference\/",
                title: "Command Reference",
                description: "Complete reference for all Entra Auth Cli commands",
                content: "Command Reference linkComplete documentation for all Entra Auth Cli commands, options, and arguments.\nCommands linkCore commands for token generation and management.\nget-token →\nGenerate access tokens using configured profiles\nLearn how to:\nGenerate tokens with different flows Override scopes at runtime Use silent mode for scripts Save tokens to files refresh →\nRefresh expired access tokens\nLearn how to:\nRefresh tokens with refresh tokens Handle token expiration Use offline_access scope inspect →\nDecode and inspect JWT tokens\nLearn how to:\nView token claims Check expiration dates Validate token structure Debug authentication issues discover →\nQuick token information and validation\nLearn how to:\nValidate token format Check token validity Get quick token info config →\nManage authentication profiles\nLearn how to:\nCreate new profiles List existing profiles Edit profile settings Delete profiles Import/export profiles Global Options link–help linkDisplay help information for any command.\n# General help entra-auth-cli --help # Command-specific help entra-auth-cli get-token --help entra-auth-cli config --help –version linkShow version information.\nentra-auth-cli --version Quick Reference linkCommon Commands link # Generate token entra-auth-cli get-token -p my-profile # Generate token (silent mode for scripts) TOKEN=$(entra-auth-cli get-token -p my-profile --silent) # Override scope entra-auth-cli get-token -p my-profile --scope \"https://graph.microsoft.com/User.Read\" # Use specific flow entra-auth-cli get-token -p my-profile -f ClientCredentials # Inspect token entra-auth-cli inspect -t \"eyJ0eXAiOiJKV1Q...\" # List profiles entra-auth-cli config list # Create profile entra-auth-cli config create # Delete profile entra-auth-cli config delete -p my-profile Exit Codes link Code Meaning 0 Success 1 General error 2 Authentication failed 3 Profile not found 4 Invalid arguments 5 Network error Next Steps link get-token Command config Command User Guide Recipes "
            }
        );
    index.add(
            {
                id:  41 ,
                href: "\/docs\/platform-guides\/",
                title: "Platform Guides",
                description: "Platform-specific considerations and best practices",
                content: "Platform Guides linkPlatform-specific configuration, security considerations, and best practices for Windows, macOS, and Linux.\nPlatform Overview linkEntra Auth Cli works across all major platforms, but each has unique characteristics for secure storage and certificate management.\nPlatform Secure Storage Security Level Production Ready Windows DPAPI 🔒 Strong ✅ Yes macOS Keychain 🔒 Strong ✅ Yes Linux XOR Obfuscation ⚠️ Weak ⚠️ Use alternatives Platform-Specific Guides linkWindows linkWindows Guide →\nLearn about:\nDPAPI secure storage Windows Certificate Store integration PowerShell automation Installation methods macOS linkmacOS Guide →\nLearn about:\nKeychain integration Certificate management Bash scripting patterns Homebrew installation Linux linkLinux Guide →\nLearn about:\nSecure storage limitations Alternative security approaches Package manager installation Container deployment Quick Start by Platform linkWindows link # Install dotnet tool install --global EntraAuthCli # Create profile (uses DPAPI for secrets) entra-auth-cli config create # Generate token entra-auth-cli get-token -p my-profile macOS link # Install dotnet tool install --global EntraAuthCli # Create profile (uses Keychain for secrets) entra-auth-cli config create # Generate token entra-auth-cli get-token -p my-profile Linux link # Install dotnet tool install --global EntraAuthCli # Create profile (uses XOR obfuscation - consider alternatives) entra-auth-cli config create # Generate token entra-auth-cli get-token -p my-profile # For production, use environment variables or external secrets manager Security Recommendations linkWindows ✅ link Use built-in DPAPI secure storage Leverage Windows Certificate Store Production-ready out of the box macOS ✅ link Use built-in Keychain integration Leverage macOS Keychain for certificates Production-ready out of the box Linux ⚠️ link XOR obfuscation provides minimal security Recommended alternatives: Environment variables Azure Key Vault HashiCorp Vault Docker secrets Kubernetes secrets Next Steps link Windows Guide macOS Guide Linux Guide Security Hardening "
            }
        );
    index.add(
            {
                id:  42 ,
                href: "\/docs\/troubleshooting\/",
                title: "Troubleshooting",
                description: "Common issues and solutions",
                content: "Troubleshooting linkSolutions to common problems and error messages.\nCommon Issues linkProfile Problems linkProfile Issues →\nCommon errors:\n“Profile not found” “Profile already exists” “Invalid profile configuration” “Cannot access secure storage” Authentication Failures linkAuthentication Issues →\nCommon errors:\n“Authentication failed” “Invalid client secret” “AADSTS errors” “Token generation failed” Certificate Problems linkCertificate Issues →\nCommon errors:\n“Certificate not found” “Invalid certificate password” “Client assertion contains an invalid signature” “Certificate has expired” Token Issues linkToken Issues →\nCommon errors:\n“Token expired” “Invalid token format” “Insufficient permissions” “Token validation failed” Quick Fixes linkProfile Not Found link # List available profiles entra-auth-cli config list # Use correct profile name entra-auth-cli get-token -p correct-profile-name Authentication Failed link # Verify credentials are correct entra-auth-cli config show -p my-profile # Recreate profile if needed entra-auth-cli config delete -p my-profile entra-auth-cli config create Certificate Issues link # Verify certificate file exists ls -l /path/to/certificate.pfx # Check certificate is uploaded to Azure # Azure Portal → App registrations → Your app → Certificates \u0026 secrets Token Expired link # Simply request a new token entra-auth-cli get-token -p my-profile # Or use refresh if available entra-auth-cli refresh -p my-profile Diagnostic Commands linkCheck Configuration link # List profiles entra-auth-cli config list # Show profile details entra-auth-cli config show -p my-profile # Verify token generation entra-auth-cli get-token -p my-profile Inspect Tokens link # Get token and inspect TOKEN=$(entra-auth-cli get-token -p my-profile --silent) entra-auth-cli inspect -t \"$TOKEN\" # Check expiration entra-auth-cli discover -t \"$TOKEN\" Validate Certificate link # Check certificate file openssl pkcs12 -info -in certificate.pfx -noout # Verify thumbprint matches Azure openssl pkcs12 -in certificate.pfx -nokeys | \\ openssl x509 -noout -fingerprint -sha1 Error Code Reference linkAADSTS Error Codes link Code Meaning Solution AADSTS50011 Redirect URI mismatch Add redirect URI in Azure Portal AADSTS700016 Application not found Verify Client ID AADSTS700027 Invalid certificate signature Check certificate registration AADSTS70002 Invalid client secret Update client secret AADSTS50076 MFA required Use interactive flow Common Exit Codes link Code Meaning Action 1 General error Check error message 2 Authentication failed Verify credentials 3 Profile not found Check profile name 4 Invalid arguments Check command syntax Getting Help linkCheck Logs link # Enable verbose logging (if supported) entra-auth-cli get-token -p my-profile --verbose # Check system logs # Windows: Event Viewer # macOS: Console.app # Linux: journalctl Community Support link GitHub Issues Documentation Recipes Next Steps link Profile Issues Authentication Issues Certificate Issues User Guide "
            }
        );
    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>