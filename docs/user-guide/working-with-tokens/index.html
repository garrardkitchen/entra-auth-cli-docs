<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Working with Tokens | Documentation</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Inspect, validate, and use access tokens effectively"><meta name=keywords content="Documentation,Hugo,Hugo Theme,Bootstrap"><meta name=author content="Colin Wilson - Lotus Labs"><meta name=email content="support@aigis.uk"><meta name=website content="https://lotusdocs.dev"><meta name=Version content="v0.1.0"><link rel=icon href=https://entratool-docs.garrardkitchen.com/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://entratool-docs.garrardkitchen.com/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://entratool-docs.garrardkitchen.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://entratool-docs.garrardkitchen.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://entratool-docs.garrardkitchen.com/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://entratool-docs.garrardkitchen.com/site.webmanifest><meta property="og:title" content="Working with Tokens"><meta property="og:description" content="Inspect, validate, and use access tokens effectively"><meta property="og:type" content="article"><meta property="og:url" content="https://entratool-docs.garrardkitchen.com/docs/user-guide/working-with-tokens/"><meta property="og:image" content="https://entratool-docs.garrardkitchen.com/opengraph/card-base-2_hu_1e2897ce49a102df.png"><meta property="article:section" content="docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://entratool-docs.garrardkitchen.com/opengraph/card-base-2_hu_1e2897ce49a102df.png"><meta name=twitter:title content="Working with Tokens"><meta name=twitter:description content="Inspect, validate, and use access tokens effectively"><link rel=alternate type=application/atom+xml title="Atom feed for Entra Token CLI Documentation" href=/index.xml><script type=text/javascript src=https://entratool-docs.garrardkitchen.com/docs/js/flexsearch.bundle.min.f5159d5a2151ffbb653996ec17eaff7da4e04c286bd879fc41839d36a5586f3f20eaead0b6089de48f9adc669cdee771.js integrity=sha384-9RWdWiFR/7tlOZbsF+r/faTgTChr2Hn8QYOdNqVYbz8g6urQtgid5I+a3Gac3udx crossorigin=anonymous></script><link rel=stylesheet href=/docs/scss/style.min.2d89c453dd5961dcbf8e28a033c4ccfcf0c7d4388c656b47a28aed4d577fd8d0861b678dff9fc4ad5617f7f45ea5ccdb.css integrity=sha384-LYnEU91ZYdy/jiigM8TM/PDH1DiMZWtHoortTVd/2NCGG2eN/5/ErVYX9/Repczb crossorigin=anonymous></head><body><div class=content><div class="page-wrapper toggled"><nav id=sidebar class=sidebar-wrapper><div class=sidebar-brand><a href=/ aria-label=HomePage alt=HomePage><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></a></div><div class=sidebar-content style="height:calc(100% - 131px)"><ul class=sidebar-menu><li class="sidebar-dropdown no-icon"><button class=btn>
Getting Started</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/getting-started/installation/>Installation</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/getting-started/quickstart/>Quick Start</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/getting-started/first-token/>First Token Tutorial</a></li></ul></div></li><li class="sidebar-dropdown no-icon"><button class=btn>
Core Concepts</button><div class=sidebar-submenu><ul><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/core-concepts/profiles/>Authentication Profiles</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/core-concepts/oauth2-flows/>OAuth2 Flows</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/core-concepts/scopes/>Scopes & Permissions</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/core-concepts/secure-storage/>Secure Storage</a></li></ul></div></li><li class="sidebar-dropdown no-icon current active"><button class=btn>
User Guide</button><div class="sidebar-submenu d-block"><ul><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/user-guide/managing-profiles/>Managing Profiles</a></li><li class=no-icon><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/user-guide/generating-tokens/>Generating Tokens</a></li><li class="current no-icon"><a class=sidebar-nested-link href=https://entratool-docs.garrardkitchen.com/docs/user-guide/working-with-tokens/>Working with Tokens</a></li></ul></div></li><li><a class=sidebar-root-link href=https://entratool-docs.garrardkitchen.com/docs/recipes/>Recipes & Examples</a></li><li><a class=sidebar-root-link href=https://entratool-docs.garrardkitchen.com/docs/oauth-flows/>OAuth2 Flows</a></li><li><a class=sidebar-root-link href=https://entratool-docs.garrardkitchen.com/docs/certificates/>Certificate Authentication</a></li><li><a class=sidebar-root-link href=https://entratool-docs.garrardkitchen.com/docs/reference/>Command Reference</a></li><li><a class=sidebar-root-link href=https://entratool-docs.garrardkitchen.com/docs/platform-guides/>Platform Guides</a></li><li><a class=sidebar-root-link href=https://entratool-docs.garrardkitchen.com/docs/troubleshooting/>Troubleshooting</a></li></ul></div><ul class="sidebar-footer list-unstyled mb-0"></ul></nav><main class="page-content bg-transparent"><div id=top-header class="top-header d-print-none"><div class="header-bar d-flex justify-content-between"><div class="d-flex align-items-center"><a href=/ class="logo-icon me-3" aria-label=HomePage alt=HomePage><div class=small><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div><div class=big><svg id="Layer_1" viewBox="0 0 250 250"><path d="m143 39.5c-18 0-18 18-18 18s0-18-18-18H22c-2.76.0-5 2.24-5 5v143c0 2.76 2.24 5 5 5h76c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h76c2.76.0 5-2.24 5-5V44.5c0-2.76-2.24-5-5-5h-85zM206 163c0 1.38-1.12 2.5-2.5 2.5H143c-18 0-18 18-18 18s0-18-18-18H46.5c-1.38.0-2.5-1.12-2.5-2.5V69c0-1.38 1.12-2.5 2.5-2.5H98c7.2.0 8.64 11.52 8.93 16.13.07 1.05.95 1.87 2 1.87h32.14c1.06.0 1.94-.82 2-1.87.29-4.61 1.73-16.13 8.93-16.13h51.5c1.38.0 2.5 1.12 2.5 2.5v94z" style="fill:#06f"/></svg></div></a><button id=close-sidebar class="btn btn-icon btn-soft">
<span class="material-icons size-20 menu-icon align-middle">menu</span>
</button>
<button id=flexsearch-button class="ms-3 btn btn-soft" data-bs-toggle=collapse data-bs-target=#FlexSearchCollapse aria-expanded=false aria-controls=FlexSearchCollapse>
<span class="material-icons size-20 menu-icon align-middle">search</span>
<span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span><div class="d-none d-sm-block"><span class=flexsearch-button-keys><kbd class=flexsearch-button-cmd-key><svg width="44" height="15"><path d="M2.118 11.5A1.519 1.519.0 011 11.042 1.583 1.583.0 011 8.815a1.519 1.519.0 011.113-.458h.715V6.643h-.71A1.519 1.519.0 011 6.185 1.519 1.519.0 01.547 5.071 1.519 1.519.0 011 3.958 1.519 1.519.0 012.118 3.5a1.519 1.519.0 011.114.458A1.519 1.519.0 013.69 5.071v.715H5.4V5.071A1.564 1.564.0 016.976 3.5 1.564 1.564.0 018.547 5.071 1.564 1.564.0 016.976 6.643H6.261V8.357h.715a1.575 1.575.0 011.113 2.685 1.583 1.583.0 01-2.227.0A1.519 1.519.0 015.4 9.929V9.214H3.69v.715a1.519 1.519.0 01-.458 1.113A1.519 1.519.0 012.118 11.5zm0-.857a.714.714.0 00.715-.714V9.214H2.118a.715.715.0 100 1.429zm4.858.0a.715.715.0 100-1.429H6.261v.715a.714.714.0 00.715.714zM3.69 8.357H5.4V6.643H3.69zM2.118 5.786h.715V5.071a.714.714.0 00-.715-.714.715.715.0 00-.5 1.22A.686.686.0 002.118 5.786zm4.143.0h.715a.715.715.0 00.5-1.22.715.715.0 00-1.22.5z" fill="currentColor"/><path d="M12.4 11.475H11.344l3.879-7.95h1.056z" fill="currentColor"/><path d="M25.073 5.384l-.864.576a2.121 2.121.0 00-1.786-.923 2.207 2.207.0 00-2.266 2.326 2.206 2.206.0 002.266 2.325 2.1 2.1.0 001.782-.918l.84.617a3.108 3.108.0 01-2.622 1.293 3.217 3.217.0 01-3.349-3.317 3.217 3.217.0 013.349-3.317A3.046 3.046.0 0125.073 5.384z" fill="currentColor"/><path d="M30.993 5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172z" fill="currentColor"/><path d="M34.67 4.164c1.471.0 2.266.658 2.266 1.851.0 1.087-.832 1.809-2.134 1.855l2.107 2.691h-1.28L33.591 7.87H33.07v2.691H32.038v-6.4zm-1.6.969v1.8h1.572c.832.0 1.22-.3 1.22-.918s-.411-.882-1.22-.882z" fill="currentColor"/><path d="M42.883 10.561H38.31v-6.4h1.033V9.583h3.54z" fill="currentColor"/></svg>
</kbd><kbd class=flexsearch-button-key><svg width="15" height="15"><path d="M5.926 12.279H4.41L9.073 2.721H10.59z" fill="currentColor"/></svg></kbd></span></div></button></div><div class="d-flex align-items-center"><ul class="list-unstyled mb-0"><li class="list-inline-item mb-0"><a href=https://github.com/https://github.com/garrardkitchen/entra-token-cli alt=github rel="noopener noreferrer" target=_blank><div class="btn btn-icon btn-default border-0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></div></a></li></ul></div></div><div class=collapse id=FlexSearchCollapse><div class=flexsearch-container><div class=flexsearch-keymap><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd>
<kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd>
<span class=flexsearch-key-label>to navigate</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd>
<span class=flexsearch-key-label>to select</span></li><li><kbd class=flexsearch-button-cmd-key><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd>
<span class=flexsearch-key-label>to close</span></li></div><form class="flexsearch position-relative flex-grow-1 ms-2 me-2"><div class="d-flex flex-row"><input id=flexsearch class=form-control type=search placeholder=Search aria-label=Search autocomplete=off>
<button id=hideFlexsearch type=button class="ms-2 btn btn-soft">
cancel</button></div><div id=suggestions class="shadow rounded-1 d-none"></div></form></div></div></div><div class=container-fluid><div class=layout-spacing><div class="d-md-flex justify-content-between align-items-center"><nav aria-label=breadcrumb class="d-inline-block pb-2 mt-1 mt-sm-0"><ul id=breadcrumbs class="breadcrumb bg-transparent mb-0" itemscope itemtype=https://schema.org/BreadcrumbList><li class="breadcrumb-item text-capitalize active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/><i class="material-icons size-20 align-text-bottom" itemprop=name>Home</i>
</a><meta itemprop=position content='1'></li><li class="breadcrumb-item text-capitalize" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/docs/user-guide/><span itemprop=name>User Guide</span>
</a><meta itemprop=position content='2'></li><li class="breadcrumb-item text-capitalize active" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Working with Tokens</span>
<meta itemprop=position content='3'></li></ul></nav></div><div class="row flex-xl-nowrap"><div class="docs-toc col-xl-3 d-xl-block"><toc><div class="fw-bold text-uppercase mb-2">On this page</div><nav id=TableOfContents><ul><li><a href=#quick-reference>Quick Reference</a></li><li><a href=#token-inspection>Token Inspection</a><ul><li><a href=#decode-jwt-claims>Decode JWT Claims</a></li><li><a href=#inspect-from-file>Inspect from File</a></li><li><a href=#inspect-from-pipeline>Inspect from Pipeline</a></li></ul></li><li><a href=#understanding-token-claims>Understanding Token Claims</a><ul><li><a href=#essential-claims>Essential Claims</a></li><li><a href=#permission-claims>Permission Claims</a></li><li><a href=#user-claims>User Claims</a></li></ul></li><li><a href=#token-discovery>Token Discovery</a><ul><li><a href=#quick-token-info>Quick Token Info</a></li><li><a href=#check-if-token-is-valid>Check if Token is Valid</a></li><li><a href=#expiration-check>Expiration Check</a></li></ul></li><li><a href=#token-refresh>Token Refresh</a><ul><li><a href=#when-to-refresh>When to Refresh</a></li><li><a href=#refresh-command>Refresh Command</a></li><li><a href=#refresh-vs-new-token>Refresh vs New Token</a></li></ul></li><li><a href=#using-tokens-with-apis>Using Tokens with APIs</a><ul><li><a href=#microsoft-graph-api>Microsoft Graph API</a></li><li><a href=#azure-resource-manager>Azure Resource Manager</a></li><li><a href=#custom-apis>Custom APIs</a></li></ul></li><li><a href=#token-validation>Token Validation</a><ul><li><a href=#client-side-validation>Client-Side Validation</a></li><li><a href=#server-side-validation>Server-Side Validation</a></li></ul></li><li><a href=#token-expiration>Token Expiration</a><ul><li><a href=#typical-lifetimes>Typical Lifetimes</a></li><li><a href=#handling-expiration>Handling Expiration</a></li></ul></li><li><a href=#token-storage>Token Storage</a><ul><li><a href=#temporary-storage>Temporary Storage</a></li><li><a href=#cache-location>Cache Location</a></li><li><a href=#clearing-cache>Clearing Cache</a></li></ul></li><li><a href=#token-security>Token Security</a><ul><li><a href=#-best-practices>✅ Best Practices</a></li><li><a href=#secure-token-handling>Secure Token Handling</a></li></ul></li><li><a href=#common-patterns>Common Patterns</a><ul><li><a href=#pattern-1-token-in-script>Pattern 1: Token in Script</a></li><li><a href=#pattern-2-cached-token>Pattern 2: Cached Token</a></li><li><a href=#pattern-3-token-rotation>Pattern 3: Token Rotation</a></li><li><a href=#pattern-4-multi-profile-management>Pattern 4: Multi-Profile Management</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#invalid-token>&ldquo;Invalid token&rdquo;</a></li><li><a href=#token-expired>&ldquo;Token expired&rdquo;</a></li><li><a href=#insufficient-privileges>&ldquo;Insufficient privileges&rdquo;</a></li><li><a href=#invalid-audience>&ldquo;Invalid audience&rdquo;</a></li></ul></li><li><a href=#next-steps>Next Steps</a></li></ul></nav></toc></div><div class="docs-toc-mobile d-print-none d-xl-none"><button id=toc-dropdown-btn class="btn-secondary dropdown-toggle" type=button data-bs-toggle=dropdown data-bs-offset=0,0 aria-expanded=false>
Table of Contents</button><nav id=toc-mobile><ul class=dropdown-menu><li><a href=#quick-reference>Quick Reference</a></li><li><a href=#token-inspection>Token Inspection</a><ul><li><a href=#decode-jwt-claims>Decode JWT Claims</a></li><li><a href=#inspect-from-file>Inspect from File</a></li><li><a href=#inspect-from-pipeline>Inspect from Pipeline</a></li></ul></li><li><a href=#understanding-token-claims>Understanding Token Claims</a><ul><li><a href=#essential-claims>Essential Claims</a></li><li><a href=#permission-claims>Permission Claims</a></li><li><a href=#user-claims>User Claims</a></li></ul></li><li><a href=#token-discovery>Token Discovery</a><ul><li><a href=#quick-token-info>Quick Token Info</a></li><li><a href=#check-if-token-is-valid>Check if Token is Valid</a></li><li><a href=#expiration-check>Expiration Check</a></li></ul></li><li><a href=#token-refresh>Token Refresh</a><ul><li><a href=#when-to-refresh>When to Refresh</a></li><li><a href=#refresh-command>Refresh Command</a></li><li><a href=#refresh-vs-new-token>Refresh vs New Token</a></li></ul></li><li><a href=#using-tokens-with-apis>Using Tokens with APIs</a><ul><li><a href=#microsoft-graph-api>Microsoft Graph API</a></li><li><a href=#azure-resource-manager>Azure Resource Manager</a></li><li><a href=#custom-apis>Custom APIs</a></li></ul></li><li><a href=#token-validation>Token Validation</a><ul><li><a href=#client-side-validation>Client-Side Validation</a></li><li><a href=#server-side-validation>Server-Side Validation</a></li></ul></li><li><a href=#token-expiration>Token Expiration</a><ul><li><a href=#typical-lifetimes>Typical Lifetimes</a></li><li><a href=#handling-expiration>Handling Expiration</a></li></ul></li><li><a href=#token-storage>Token Storage</a><ul><li><a href=#temporary-storage>Temporary Storage</a></li><li><a href=#cache-location>Cache Location</a></li><li><a href=#clearing-cache>Clearing Cache</a></li></ul></li><li><a href=#token-security>Token Security</a><ul><li><a href=#-best-practices>✅ Best Practices</a></li><li><a href=#secure-token-handling>Secure Token Handling</a></li></ul></li><li><a href=#common-patterns>Common Patterns</a><ul><li><a href=#pattern-1-token-in-script>Pattern 1: Token in Script</a></li><li><a href=#pattern-2-cached-token>Pattern 2: Cached Token</a></li><li><a href=#pattern-3-token-rotation>Pattern 3: Token Rotation</a></li><li><a href=#pattern-4-multi-profile-management>Pattern 4: Multi-Profile Management</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#invalid-token>&ldquo;Invalid token&rdquo;</a></li><li><a href=#token-expired>&ldquo;Token expired&rdquo;</a></li><li><a href=#insufficient-privileges>&ldquo;Insufficient privileges&rdquo;</a></li><li><a href=#invalid-audience>&ldquo;Invalid audience&rdquo;</a></li></ul></li><li><a href=#next-steps>Next Steps</a></li></ul></nav></div><div class="docs-content col-12 col-xl-9 mt-0"><div class="mb-0 d-flex"><h1 class="content-title mb-0">Working with Tokens</h1></div><div id=content class=main-content><div data-prismjs-copy data-prismjs-copy-success data-prismjs-copy-error><h1 id=working-with-tokens>Working with Tokens <a href=#working-with-tokens class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h1><p>Once you have an access token, learn how to inspect, validate, refresh, and use it effectively with APIs.</p><hr><h2 id=quick-reference>Quick Reference <a href=#quick-reference class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><table><thead><tr><th>Task</th><th>Command</th></tr></thead><tbody><tr><td>Inspect token</td><td><code>entratool inspect -t TOKEN</code></td></tr><tr><td>Inspect from file</td><td><code>entratool inspect -f token.txt</code></td></tr><tr><td>Discover token info</td><td><code>entratool discover -t TOKEN</code></td></tr><tr><td>Refresh token</td><td><code>entratool refresh -p PROFILE</code></td></tr><tr><td>Check expiration</td><td><code>entratool discover -t TOKEN | jq .exp</code></td></tr></tbody></table><hr><h2 id=token-inspection>Token Inspection <a href=#token-inspection class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=decode-jwt-claims>Decode JWT Claims <a href=#decode-jwt-claims class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool inspect -t <span style=color:#e6db74>&#34;eyJ0eXAiOiJKV1QiLCJh...&#34;</span></span></span></code></pre></td></tr></table></div></div><p><strong>Output:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;header&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;typ&#34;</span>: <span style=color:#e6db74>&#34;JWT&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;alg&#34;</span>: <span style=color:#e6db74>&#34;RS256&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;kid&#34;</span>: <span style=color:#e6db74>&#34;abc123...&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;payload&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;aud&#34;</span>: <span style=color:#e6db74>&#34;https://graph.microsoft.com&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;iss&#34;</span>: <span style=color:#e6db74>&#34;https://sts.windows.net/12345678-1234-1234-1234-123456789abc/&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;iat&#34;</span>: <span style=color:#ae81ff>1701432000</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;nbf&#34;</span>: <span style=color:#ae81ff>1701432000</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;exp&#34;</span>: <span style=color:#ae81ff>1701435600</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;appid&#34;</span>: <span style=color:#e6db74>&#34;12345678-1234-1234-1234-123456789abc&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;appidacr&#34;</span>: <span style=color:#e6db74>&#34;1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;idp&#34;</span>: <span style=color:#e6db74>&#34;https://sts.windows.net/...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;oid&#34;</span>: <span style=color:#e6db74>&#34;87654321-4321-4321-4321-cba987654321&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;rh&#34;</span>: <span style=color:#e6db74>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;sub&#34;</span>: <span style=color:#e6db74>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;tid&#34;</span>: <span style=color:#e6db74>&#34;12345678-1234-1234-1234-123456789abc&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;uti&#34;</span>: <span style=color:#e6db74>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ver&#34;</span>: <span style=color:#e6db74>&#34;1.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;scp&#34;</span>: <span style=color:#e6db74>&#34;User.Read Mail.Read&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;roles&#34;</span>: []
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;signature&#34;</span>: <span style=color:#e6db74>&#34;...&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><h3 id=inspect-from-file>Inspect from File <a href=#inspect-from-file class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool get-token -p myprofile --silent &gt; token.txt
</span></span><span style=display:flex><span>entratool inspect -f token.txt</span></span></code></pre></td></tr></table></div></div><h3 id=inspect-from-pipeline>Inspect from Pipeline <a href=#inspect-from-pipeline class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool get-token -p myprofile --silent | entratool inspect</span></span></code></pre></td></tr></table></div></div><p><a href=/docs/user-guide/working-with-tokens/inspecting/>Detailed inspection guide →</a></p><hr><h2 id=understanding-token-claims>Understanding Token Claims <a href=#understanding-token-claims class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=essential-claims>Essential Claims <a href=#essential-claims class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><table><thead><tr><th>Claim</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>aud</code></td><td>Audience (API)</td><td><code>https://graph.microsoft.com</code></td></tr><tr><td><code>iss</code></td><td>Issuer (Entra ID)</td><td><code>https://sts.windows.net/...</code></td></tr><tr><td><code>iat</code></td><td>Issued at (Unix timestamp)</td><td><code>1701432000</code></td></tr><tr><td><code>exp</code></td><td>Expiration (Unix timestamp)</td><td><code>1701435600</code></td></tr><tr><td><code>appid</code></td><td>Application ID</td><td><code>12345678-...</code></td></tr><tr><td><code>tid</code></td><td>Tenant ID</td><td><code>87654321-...</code></td></tr></tbody></table><h3 id=permission-claims>Permission Claims <a href=#permission-claims class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Delegated permissions (user context):</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scp&#34;</span>: <span style=color:#e6db74>&#34;User.Read Mail.Read Calendars.Read&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><p><strong>Application permissions (app context):</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;roles&#34;</span>: [<span style=color:#e6db74>&#34;User.Read.All&#34;</span>, <span style=color:#e6db74>&#34;Mail.Send&#34;</span>]
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><h3 id=user-claims>User Claims <a href=#user-claims class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;unique_name&#34;</span>: <span style=color:#e6db74>&#34;user@contoso.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;upn&#34;</span>: <span style=color:#e6db74>&#34;user@contoso.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;John Doe&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;oid&#34;</span>: <span style=color:#e6db74>&#34;87654321-4321-4321-4321-cba987654321&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><hr><h2 id=token-discovery>Token Discovery <a href=#token-discovery class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=quick-token-info>Quick Token Info <a href=#quick-token-info class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool discover -t <span style=color:#e6db74>&#34;eyJ0eXAiOiJKV1QiLCJh...&#34;</span></span></span></code></pre></td></tr></table></div></div><p><strong>Output:</strong></p><pre tabindex=0><code>Token Information:
  Audience: https://graph.microsoft.com
  Issued: 2024-12-01 10:00:00 UTC
  Expires: 2024-12-01 11:00:00 UTC
  Time remaining: 45 minutes
  Scopes: User.Read Mail.Read
  Application ID: 12345678-1234-1234-1234-123456789abc
  Tenant ID: 87654321-4321-4321-4321-cba987654321</code></pre><h3 id=check-if-token-is-valid>Check if Token is Valid <a href=#check-if-token-is-valid class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool discover -t <span style=color:#e6db74>&#34;eyJ0eXAiOiJKV1QiLCJh...&#34;</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;Valid&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;Expired&#34;</span></span></span></code></pre></td></tr></table></div></div><p><strong>Exit codes:</strong></p><ul><li><code>0</code>: Token is valid</li><li><code>1</code>: Token is expired or invalid</li></ul><h3 id=expiration-check>Expiration Check <a href=#expiration-check class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Get expiration timestamp</span>
</span></span><span style=display:flex><span>EXP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool inspect -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> | jq -r .payload.exp<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert to readable date</span>
</span></span><span style=display:flex><span>date -r $EXP  <span style=color:#75715e># macOS</span>
</span></span><span style=display:flex><span>date -d @$EXP  <span style=color:#75715e># Linux</span></span></span></code></pre></td></tr></table></div></div><p><a href=/docs/user-guide/working-with-tokens/discovering/>Detailed discovery guide →</a></p><hr><h2 id=token-refresh>Token Refresh <a href=#token-refresh class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=when-to-refresh>When to Refresh <a href=#when-to-refresh class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Refresh token when:</strong></p><ul><li>Token is expired or about to expire</li><li>You need a fresh token with updated permissions</li></ul><p><strong>Check expiration:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool discover -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span></span></span></code></pre></td></tr></table></div></div><h3 id=refresh-command>Refresh Command <a href=#refresh-command class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool refresh -p myprofile</span></span></code></pre></td></tr></table></div></div><p><strong>Requirements:</strong></p><ul><li>Original token acquired with <code>offline_access</code> scope</li><li>Refresh token available in cache</li></ul><p><strong>Output:</strong></p><pre tabindex=0><code>Refreshing token for profile &#39;myprofile&#39;...
✓ Token refreshed successfully

eyJ0eXAiOiJKV1QiLCJh...</code></pre><h3 id=refresh-vs-new-token>Refresh vs New Token <a href=#refresh-vs-new-token class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><table><thead><tr><th>Operation</th><th>Refresh</th><th>New Token</th></tr></thead><tbody><tr><td><strong>Speed</strong></td><td>Faster</td><td>Slower</td></tr><tr><td><strong>User interaction</strong></td><td>None</td><td>May require</td></tr><tr><td><strong>Requirements</strong></td><td>Refresh token</td><td>Profile + credentials</td></tr><tr><td><strong>Use case</strong></td><td>Token expired</td><td>First request or refresh unavailable</td></tr></tbody></table><p><strong>When refresh isn&rsquo;t available:</strong></p><ul><li>Client Credentials flow (no refresh tokens)</li><li>Refresh token expired (>90 days of inactivity)</li></ul><p><a href=/docs/user-guide/working-with-tokens/refreshing/>Detailed refresh guide →</a></p><hr><h2 id=using-tokens-with-apis>Using Tokens with APIs <a href=#using-tokens-with-apis class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=microsoft-graph-api>Microsoft Graph API <a href=#microsoft-graph-api class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p graph-profile --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>     https://graph.microsoft.com/v1.0/me</span></span></code></pre></td></tr></table></div></div><p><strong>Example response:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;@odata.context&#34;</span>: <span style=color:#e6db74>&#34;https://graph.microsoft.com/v1.0/$metadata#users/$entity&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;87654321-4321-4321-4321-cba987654321&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;displayName&#34;</span>: <span style=color:#e6db74>&#34;John Doe&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;mail&#34;</span>: <span style=color:#e6db74>&#34;john.doe@contoso.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;userPrincipalName&#34;</span>: <span style=color:#e6db74>&#34;john.doe@contoso.com&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><h3 id=azure-resource-manager>Azure Resource Manager <a href=#azure-resource-manager class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p azure-profile --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;https://management.azure.com/subscriptions?api-version=2020-01-01&#34;</span></span></span></code></pre></td></tr></table></div></div><h3 id=custom-apis>Custom APIs <a href=#custom-apis class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p custom-api --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>     -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>     -d <span style=color:#e6db74>&#39;{&#34;key&#34;: &#34;value&#34;}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>     https://api.contoso.com/v1/resources</span></span></code></pre></td></tr></table></div></div><hr><h2 id=token-validation>Token Validation <a href=#token-validation class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=client-side-validation>Client-Side Validation <a href=#client-side-validation class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Check expiration:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Extract exp claim</span>
</span></span><span style=display:flex><span>EXP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool inspect -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> | jq -r .payload.exp<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Compare with current time</span>
</span></span><span style=display:flex><span>NOW<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>date +%s<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $EXP -lt $NOW <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Token expired&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Token valid for </span><span style=color:#66d9ef>$((</span> <span style=color:#f92672>(</span>$EXP <span style=color:#f92672>-</span> $NOW<span style=color:#f92672>)</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>60</span> <span style=color:#66d9ef>))</span><span style=color:#e6db74> minutes&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span></span></span></code></pre></td></tr></table></div></div><p><strong>Verify audience:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>AUD<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool inspect -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> | jq -r .payload.aud<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$AUD<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://graph.microsoft.com&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Valid for Graph API&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Wrong audience: </span>$AUD<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span></span></span></code></pre></td></tr></table></div></div><h3 id=server-side-validation>Server-Side Validation <a href=#server-side-validation class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p>APIs validate tokens by:</p><ol><li>Verifying signature using Microsoft&rsquo;s public keys</li><li>Checking expiration (<code>exp</code> claim)</li><li>Validating audience (<code>aud</code> claim)</li><li>Checking issuer (<code>iss</code> claim)</li></ol><p><strong>Microsoft Graph validates:</strong></p><ul><li>Token signature</li><li>Expiration time</li><li>Audience = <code>https://graph.microsoft.com</code></li><li>Issuer from trusted Entra ID tenant</li></ul><hr><h2 id=token-expiration>Token Expiration <a href=#token-expiration class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=typical-lifetimes>Typical Lifetimes <a href=#typical-lifetimes class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><table><thead><tr><th>Token Type</th><th>Lifetime</th></tr></thead><tbody><tr><td><strong>Access token</strong></td><td>1 hour</td></tr><tr><td><strong>Refresh token</strong></td><td>90 days (or until revoked)</td></tr><tr><td><strong>ID token</strong></td><td>1 hour</td></tr></tbody></table><h3 id=handling-expiration>Handling Expiration <a href=#handling-expiration class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Pattern 1: Check before use</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>if</span> entratool discover -f token.txt &amp;&gt;/dev/null; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p myprofile --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> &gt; token.txt
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span></span></span></code></pre></td></tr></table></div></div><p><strong>Pattern 2: Catch API errors</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>cat token.txt<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>RESPONSE<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>curl -s -w <span style=color:#e6db74>&#34;%{http_code}&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  https://graph.microsoft.com/v1.0/me<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$RESPONSE<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;401&#34;</span>* <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Token expired, get new one</span>
</span></span><span style=display:flex><span>  TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p myprofile --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> &gt; token.txt
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># Retry request</span>
</span></span><span style=display:flex><span>  curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>       https://graph.microsoft.com/v1.0/me
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span></span></span></code></pre></td></tr></table></div></div><p><strong>Pattern 3: Preemptive refresh</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Refresh if less than 5 minutes remaining</span>
</span></span><span style=display:flex><span>EXP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool inspect -f token.txt | jq -r .payload.exp<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>NOW<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>date +%s<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>REMAINING<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span> <span style=color:#f92672>(</span>$EXP <span style=color:#f92672>-</span> $NOW<span style=color:#f92672>)</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>60</span> <span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $REMAINING -lt <span style=color:#ae81ff>5</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  entratool get-token -p myprofile --silent &gt; token.txt
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span></span></span></code></pre></td></tr></table></div></div><p><a href=/docs/user-guide/working-with-tokens/expiration/>Detailed expiration guide →</a></p><hr><h2 id=token-storage>Token Storage <a href=#token-storage class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=temporary-storage>Temporary Storage <a href=#temporary-storage class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># In-memory (session only)</span>
</span></span><span style=display:flex><span>export TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p myprofile --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># File (with restricted permissions)</span>
</span></span><span style=display:flex><span>entratool get-token -p myprofile --silent &gt; /tmp/token.txt
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> /tmp/token.txt</span></span></code></pre></td></tr></table></div></div><h3 id=cache-location>Cache Location <a href=#cache-location class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>MSAL token cache:</strong></p><ul><li><strong>Windows:</strong> <code>%LOCALAPPDATA%\.msal\cache</code></li><li><strong>macOS/Linux:</strong> <code>~/.msal/cache</code></li></ul><p><strong>Contains:</strong></p><ul><li>Access tokens</li><li>Refresh tokens</li><li>ID tokens</li><li>Account information</li></ul><p><strong>Security:</strong></p><ul><li>Encrypted on Windows (DPAPI)</li><li>Encrypted on macOS (Keychain)</li><li>⚠️ Obfuscated on Linux (not secure)</li></ul><h3 id=clearing-cache>Clearing Cache <a href=#clearing-cache class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Delete cache directory</span>
</span></span><span style=display:flex><span>rm -rf ~/.msal/cache
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Next token request will require re-authentication</span>
</span></span><span style=display:flex><span>entratool get-token -p myprofile</span></span></code></pre></td></tr></table></div></div><hr><h2 id=token-security>Token Security <a href=#token-security class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=-best-practices>✅ Best Practices <a href=#-best-practices class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Do:</strong></p><ul><li>✅ Request tokens on-demand</li><li>✅ Use HTTPS for all API requests</li><li>✅ Check token expiration before use</li><li>✅ Store tokens with restrictive permissions (600)</li><li>✅ Clear tokens after use</li><li>✅ Use environment variables for temporary storage</li><li>✅ Rotate credentials regularly</li></ul><p><strong>Don&rsquo;t:</strong></p><ul><li>❌ Hard-code tokens in source code</li><li>❌ Commit tokens to git repositories</li><li>❌ Share tokens via email/chat</li><li>❌ Log tokens in plaintext</li><li>❌ Store tokens long-term</li><li>❌ Use tokens across environments (dev/prod)</li></ul><h3 id=secure-token-handling>Secure Token Handling <a href=#secure-token-handling class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>set -e
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Secure temp file</span>
</span></span><span style=display:flex><span>TOKEN_FILE<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>mktemp<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>trap <span style=color:#e6db74>&#34;rm -f </span>$TOKEN_FILE<span style=color:#e6db74>&#34;</span> EXIT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Get token</span>
</span></span><span style=display:flex><span>entratool get-token -p myprofile --silent &gt; <span style=color:#e6db74>&#34;</span>$TOKEN_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> <span style=color:#e6db74>&#34;</span>$TOKEN_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use token</span>
</span></span><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>cat <span style=color:#e6db74>&#34;</span>$TOKEN_FILE<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> https://api.example.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># File automatically deleted on exit</span></span></span></code></pre></td></tr></table></div></div><hr><h2 id=common-patterns>Common Patterns <a href=#common-patterns class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=pattern-1-token-in-script>Pattern 1: Token in Script <a href=#pattern-1-token-in-script class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>set -euo pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>get_token<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  entratool get-token -p <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> --silent
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>get_token <span style=color:#e6db74>&#34;myprofile&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use token</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>     https://graph.microsoft.com/v1.0/me</span></span></code></pre></td></tr></table></div></div><h3 id=pattern-2-cached-token>Pattern 2: Cached Token <a href=#pattern-2-cached-token class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TOKEN_CACHE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/tmp/my-token-cache.txt&#34;</span>
</span></span><span style=display:flex><span>TOKEN_MAX_AGE<span style=color:#f92672>=</span><span style=color:#ae81ff>3000</span>  <span style=color:#75715e># 50 minutes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>get_fresh_token<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  entratool get-token -p myprofile --silent &gt; <span style=color:#e6db74>&#34;</span>$TOKEN_CACHE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  chmod <span style=color:#ae81ff>600</span> <span style=color:#e6db74>&#34;</span>$TOKEN_CACHE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check if cache exists and is fresh</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span>$TOKEN_CACHE<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  FILE_AGE<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span> <span style=color:#66d9ef>$(</span>date +%s<span style=color:#66d9ef>)</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>$(</span>stat -f %m <span style=color:#e6db74>&#34;</span>$TOKEN_CACHE<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span> <span style=color:#66d9ef>))</span>  <span style=color:#75715e># macOS</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># FILE_AGE=$(( $(date +%s) - $(stat -c %Y &#34;$TOKEN_CACHE&#34;) ))  # Linux</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $FILE_AGE -gt $TOKEN_MAX_AGE <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    get_fresh_token
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  get_fresh_token
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>cat <span style=color:#e6db74>&#34;</span>$TOKEN_CACHE<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span></span></span></code></pre></td></tr></table></div></div><h3 id=pattern-3-token-rotation>Pattern 3: Token Rotation <a href=#pattern-3-token-rotation class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Function to get valid token</span>
</span></span><span style=display:flex><span>get_valid_token<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  local profile<span style=color:#f92672>=</span>$1
</span></span><span style=display:flex><span>  local token_file<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/tmp/token-</span>$profile<span style=color:#e6db74>.txt&#34;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># Check if token exists and is valid</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span>$token_file<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> entratool discover -f <span style=color:#e6db74>&#34;</span>$token_file<span style=color:#e6db74>&#34;</span> &amp;&gt;/dev/null; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    cat <span style=color:#e6db74>&#34;</span>$token_file<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Get fresh token</span>
</span></span><span style=display:flex><span>    entratool get-token -p <span style=color:#e6db74>&#34;</span>$profile<span style=color:#e6db74>&#34;</span> --silent | tee <span style=color:#e6db74>&#34;</span>$token_file<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    chmod <span style=color:#ae81ff>600</span> <span style=color:#e6db74>&#34;</span>$token_file<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use it</span>
</span></span><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>get_valid_token <span style=color:#e6db74>&#34;myprofile&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$TOKEN<span style=color:#e6db74>&#34;</span> https://api.example.com</span></span></code></pre></td></tr></table></div></div><h3 id=pattern-4-multi-profile-management>Pattern 4: Multi-Profile Management <a href=#pattern-4-multi-profile-management class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>declare -A TOKENS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>get_token_for_profile<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  local profile<span style=color:#f92672>=</span>$1
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TOKENS[$profile]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    TOKENS<span style=color:#f92672>[</span>$profile<span style=color:#f92672>]=</span><span style=color:#66d9ef>$(</span>entratool get-token -p <span style=color:#e6db74>&#34;</span>$profile<span style=color:#e6db74>&#34;</span> --silent<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TOKENS[$profile]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use different profiles</span>
</span></span><span style=display:flex><span>GRAPH_TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>get_token_for_profile <span style=color:#e6db74>&#34;graph-profile&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>AZURE_TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>get_token_for_profile <span style=color:#e6db74>&#34;azure-profile&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$GRAPH_TOKEN<span style=color:#e6db74>&#34;</span> https://graph.microsoft.com/v1.0/me
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;Authorization: Bearer </span>$AZURE_TOKEN<span style=color:#e6db74>&#34;</span> https://management.azure.com/subscriptions</span></span></code></pre></td></tr></table></div></div><hr><h2 id=troubleshooting>Troubleshooting <a href=#troubleshooting class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><h3 id=invalid-token>&ldquo;Invalid token&rdquo; <a href=#invalid-token class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Cause:</strong> Token is malformed or corrupted</p><p><strong>Fix:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Validate token format</span>
</span></span><span style=display:flex><span>entratool inspect -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># If invalid, get fresh token</span>
</span></span><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p myprofile --silent<span style=color:#66d9ef>)</span></span></span></code></pre></td></tr></table></div></div><h3 id=token-expired>&ldquo;Token expired&rdquo; <a href=#token-expired class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Cause:</strong> Token lifetime exceeded</p><p><strong>Fix:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Get new token</span>
</span></span><span style=display:flex><span>TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>entratool get-token -p myprofile --silent<span style=color:#66d9ef>)</span></span></span></code></pre></td></tr></table></div></div><h3 id=insufficient-privileges>&ldquo;Insufficient privileges&rdquo; <a href=#insufficient-privileges class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Cause:</strong> Token lacks required permissions</p><p><strong>Fix:</strong></p><ol><li>Check token scopes:<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool inspect -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> | jq .payload.scp</span></span></code></pre></td></tr></table></div></div></li><li>Request token with correct scopes:<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>entratool get-token -p myprofile <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --scope <span style=color:#e6db74>&#34;https://graph.microsoft.com/User.Read Mail.Send&#34;</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=invalid-audience>&ldquo;Invalid audience&rdquo; <a href=#invalid-audience class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h3><p><strong>Cause:</strong> Token issued for different API</p><p><strong>Fix:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check audience</span>
</span></span><span style=display:flex><span>entratool inspect -t <span style=color:#e6db74>&#34;</span>$TOKEN<span style=color:#e6db74>&#34;</span> | jq .payload.aud
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Get token for correct API</span>
</span></span><span style=display:flex><span>entratool get-token -p myprofile <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --scope <span style=color:#e6db74>&#34;https://correct-api.com/.default&#34;</span></span></span></code></pre></td></tr></table></div></div><hr><h2 id=next-steps>Next Steps <a href=#next-steps class=anchor aria-hidden=true><i class="material-icons align-middle">link</i></a></h2><ul><li><a href=/docs/user-guide/working-with-tokens/inspecting/>Token Inspection (Detailed)</a></li><li><a href=/docs/user-guide/working-with-tokens/refreshing/>Token Refresh (Detailed)</a></li><li><a href=/docs/user-guide/working-with-tokens/expiration/>Token Expiration Handling</a></li><li><a href=/docs/recipes/>API Integration Recipes</a></li></ul></div></div><div><hr class=doc-hr><div id=doc-nav class=d-print-none><div class="row flex-xl-nowrap"><div class="col-sm-6 pt-2 doc-next"><a href=/docs/core-concepts/scopes/><div class="card h-100 my-1"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0"><i class="material-icons align-middle">navigate_before</i> Scopes & Permissions</p></div></div></a></div><div class="col-sm-6 pt-2 doc-prev"><a class=ms-auto href=/docs/recipes/><div class="card h-100 my-1 text-end"><div class="card-body py-2"><p class="card-title fs-5 fw-semibold lh-base mb-0">Recipes & Examples <i class="material-icons align-middle">navigate_next</i></p></div></div></a></div></div></div></div></div></div></div></div><footer class="shadow py-3 d-print-none"><div class=container-fluid><div class="row align-items-center"><div class=col><div class="text-sm-start text-center mx-md-2"><p class=mb-0>© 2025 Garrard Kitchen</p></div></div></div></div></footer></main></div></div><button onclick=topFunction() id=back-to-top aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12 10.224l-6.3 6.3-1.38-1.372L12 7.472l7.68 7.68-1.38 1.376z" style="fill:#fff"/></svg></button>
<script src=/docs/js/bootstrap.9830259bc28edf5a45a3c7aa85d782bb2b8ac9a68e8ff3e14e4ad92a0aaf7882b8c20ea2ba1c4fc65f4415a3046aca9a.js integrity=sha384-mDAlm8KO31pFo8eqhdeCuyuKyaaOj/PhTkrZKgqveIK4wg6iuhxPxl9EFaMEasqa defer></script><script type=text/javascript src=https://entratool-docs.garrardkitchen.com/docs/js/bundle.min.a046e72674401a45bf99217648934a99ff03a7c46d105e47916156e66969388a0643f55a1e850acb495c9bd8be985171.js integrity=sha384-oEbnJnRAGkW/mSF2SJNKmf8Dp8RtEF5HkWFW5mlpOIoGQ/VaHoUKy0lcm9i+mFFx crossorigin=anonymous defer></script><script type=module>
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    


    

    

    index.add(
            {
                id:  0 ,
                href: "\/docs\/",
                title: "Documentation",
                description: "Complete guide to using Entra Token CLI",
                content: "Entra Token CLI Documentation linkWelcome to the comprehensive documentation for Entra Token CLI, a cross-platform tool for generating Microsoft Entra ID access tokens.\nGetting Started linkNew to Entra Token CLI? Start here:\nInstallation - Install the tool on your platform Quick Start - Generate your first token in 5 minutes First Token Tutorial - Complete walkthrough Core Concepts linkUnderstand the fundamentals:\nAuthentication Profiles - What are profiles and how they work OAuth2 Flows - Understanding authentication flows Scopes \u0026 Resources - Managing API permissions Secure Storage - How secrets are protected User Guide linkDetailed guides for all features:\nManaging Profiles - Create, edit, delete, import/export Generating Tokens - Get tokens with different flows Working with Tokens - Inspect, refresh, manage tokens Reference linkComplete command reference and configuration:\nCommands - Full command-line reference Configuration - Profile schema and settings Environment Variables - Supported environment variables Need Help? link Check the Troubleshooting guide Review Common Errors Visit our GitHub Discussions "
            }
        );
    index.add(
            {
                id:  1 ,
                href: "\/docs\/getting-started\/",
                title: "Getting Started",
                description: "Get up and running with Entra Token CLI",
                content: "Getting Started linkWelcome! This section will help you install Entra Token CLI and generate your first token.\nWhat You’ll Learn link How to install the tool on your platform Creating your first authentication profile Generating and using access tokens Understanding the basics of OAuth2 flows Prerequisites linkBefore you begin, ensure you have:\n.NET Runtime (for global tool) or download self-contained executable Azure/Entra ID Account with access to app registrations App Registration (or permission to create one) Don’t have an app registration yet? No problem! The First Token Tutorial walks you through the complete setup.\nQuick Links link Installation Guide - Choose your installation method Quick Start - 5-minute guide to your first token Complete Tutorial - End-to-end walkthrough Next Steps link Install the tool → Follow the Quick Start guide Explore Core Concepts to understand how it works "
            }
        );
    index.add(
            {
                id:  2 ,
                href: "\/docs\/core-concepts\/",
                title: "Core Concepts",
                description: "Understand the fundamentals of Entra Token CLI",
                content: "Core Concepts linkUnderstanding these fundamental concepts will help you use Entra Token CLI effectively.\nKey Topics linkAuthentication Profiles linkLearn what profiles are, how they work, and why they’re useful for managing multiple authentication scenarios.\nOAuth2 Flows linkUnderstand the four OAuth2 authentication flows supported by the tool and when to use each one.\nScopes \u0026 Resources linkMaster how scopes define API permissions and learn common scope patterns for Microsoft Graph and custom APIs.\nSecure Storage linkDiscover how secrets are protected on each platform and understand the security model.\nQuick Overview linkProfiles store your authentication configuration (tenant, client ID, credentials) so you don’t have to enter them repeatedly.\nOAuth2 Flows determine how authentication happens - some require user interaction, others are fully automated.\nScopes specify what resources and permissions your token will have access to.\nSecure Storage keeps your secrets safe using platform-native encryption (DPAPI on Windows, Keychain on macOS).\nNext Steps linkStart with Authentication Profiles to understand the foundation of how the tool works.\n"
            }
        );
    index.add(
            {
                id:  3 ,
                href: "\/docs\/core-concepts\/profiles\/",
                title: "Authentication Profiles",
                description: "Understanding and managing authentication profiles",
                content: "Authentication Profiles linkProfiles are saved authentication configurations that store everything needed to generate tokens for a specific application or scenario.\nWhat is a Profile? linkA profile contains:\nProfile name: Unique identifier you choose Tenant ID: Your Azure/Entra ID tenant Client ID: Application (client) ID from app registration Scopes: API permissions to request (e.g., https://graph.microsoft.com/.default) Authentication method: How to authenticate (Client Secret, Certificate, or Passwordless Certificate) Credentials: Client secret or certificate path (stored securely) Default OAuth2 flow (optional): Preferred authentication flow Redirect URI (optional): Custom redirect for interactive flows Why Use Profiles? linkConvenience linkStore configuration once, reuse many times. No need to type tenant IDs and secrets repeatedly.\nSecurity linkCredentials are stored using platform-native secure storage, not in plain text files.\nOrganization linkManage multiple applications, environments, or tenants easily. Examples:\nprod-app-client dev-graph-api staging-custom-api Portability linkExport profiles (with encryption) to share with team members or move between machines.\nProfile Anatomy linkRequired Fields link 1 2 3 4 5 6 name: myprofile tenantId: contoso.onmicrosoft.com clientId: 12345678-1234-1234-1234-123456789abc scopes: - https://graph.microsoft.com/.default authMethod: ClientSecret Optional Fields link 1 2 3 4 defaultFlow: ClientCredentials # Auto-select flow redirectUri: http://localhost:8080 # For interactive flows certificatePath: /path/to/cert.pfx # For certificate auth cacheCertificatePassword: true # Cache cert password Profile Storage linkProfiles are stored in platform-specific locations:\nWindows: %APPDATA%\\entratool\\profiles.json macOS/Linux: ~/.config/entratool/profiles.json The profiles.json file contains metadata only - no secrets!\nExample profiles.json:\n1 2 3 4 5 6 7 8 9 10 11 12 13 { \"profiles\": [ { \"name\": \"myprofile\", \"tenantId\": \"contoso.onmicrosoft.com\", \"clientId\": \"12345678-...\", \"scopes\": [\"https://graph.microsoft.com/.default\"], \"authMethod\": \"ClientSecret\", \"createdAt\": \"2025-12-26T10:00:00Z\", \"updatedAt\": \"2025-12-26T10:00:00Z\" } ] } Secret Storage linkSecrets (client secrets and certificate passwords) are stored separately using secure storage:\nWindows: Encrypted with DPAPI in %APPDATA%\\entratool\\secure\\ macOS: Stored in Keychain (service: entratool, account: entratool:{profileName}:{secretType}) Linux: XOR-obfuscated in ~/.config/entratool/secure/ ⚠️ Security Note: See Secure Storage for details about platform security.\nProfile Lifecycle link1. Create link 1 entratool config create Interactive prompts guide you through setup.\n2. Use link 1 entratool get-token -p myprofile Reference the profile by name when generating tokens.\n3. Update link 1 entratool config edit -p myprofile Modify settings or rotate credentials.\n4. Share link 1 entratool config export -p myprofile --include-secrets -o myprofile.enc Export with AES-256 encryption for team sharing.\n5. Delete link 1 entratool config delete -p myprofile Remove profile and associated secrets.\nCommon Profile Patterns linkService Principal for Azure Resources link Name: azure-prod-sp Tenant: contoso.onmicrosoft.com Client ID: [service principal client ID] Scopes: https://management.azure.com/.default Auth Method: ClientSecret Microsoft Graph API Access link Name: graph-api-client Tenant: contoso.onmicrosoft.com Client ID: [app registration client ID] Scopes: https://graph.microsoft.com/.default Auth Method: Certificate Certificate Path: /path/to/cert.pfx Custom API Access link Name: myapi-client Tenant: [tenant ID] Client ID: [client app ID] Scopes: api://[api-app-id]/.default Auth Method: ClientSecret Multi-Tenant Application link Name: multitenant-app Tenant: organizations # or 'common' Client ID: [app client ID] Scopes: https://graph.microsoft.com/User.Read Auth Method: InteractiveBrowser Profile Management Commands link Command Purpose config create Create a new profile config list List all profiles config edit -p NAME Edit existing profile config delete -p NAME Delete a profile config export -p NAME Export profile (optionally with secrets) config import -i FILE Import profile from file See detailed profile management guide →\nBest Practices link✅ Do link Use descriptive profile names: prod-graph-api, not profile1 Store one app per profile for clarity Export profiles for backup before major changes Rotate secrets regularly ❌ Don’t link Share profiles with secrets via insecure channels Use the same profile for multiple environments Store production credentials on Linux (XOR obfuscation only) Commit profiles.json to version control Next Steps link Learn about OAuth2 Flows to understand authentication methods Manage Scopes to control API access Profile Management Guide for detailed commands "
            }
        );
    index.add(
            {
                id:  4 ,
                href: "\/docs\/getting-started\/installation\/",
                title: "Installation",
                description: "How to install Entra Token CLI on your platform",
                content: "Installation linkEntra Token CLI can be installed as a .NET global tool or downloaded as a self-contained executable for your platform.\nOption 1: .NET Global Tool (Recommended) linkPrerequisites: .NET Runtime 10.0 or later\nInstall link 1 dotnet tool install -g EntraTokenCli Update link 1 dotnet tool update -g EntraTokenCli Uninstall link 1 dotnet tool uninstall -g EntraTokenCli Verify Installation link 1 entratool --version Option 2: Self-Contained Executables linkDownload the latest release for your platform from the Releases page.\nWindows link Download entratool-win-x64.exe Place in a directory in your PATH (e.g., C:\\Tools\\) Run from command prompt: 1 entratool --version macOS (Apple Silicon) link Download entratool-osx-arm64 Make executable and move to PATH: 1 2 chmod +x entratool-osx-arm64 sudo mv entratool-osx-arm64 /usr/local/bin/entratool Verify: 1 entratool --version macOS (Intel) link Download entratool-osx-x64 Make executable and move to PATH: 1 2 chmod +x entratool-osx-x64 sudo mv entratool-osx-x64 /usr/local/bin/entratool Verify: 1 entratool --version Linux link Download entratool-linux-x64 Make executable and move to PATH: 1 2 chmod +x entratool-linux-x64 sudo mv entratool-linux-x64 /usr/local/bin/entratool Verify: 1 entratool --version ⚠️ Linux Security Note: Linux uses XOR obfuscation for secret storage, not cryptographic encryption. Suitable for development only. See Platform-Specific Guides for production alternatives.\nPlatform Requirements linkWindows link Windows 10+ (build 1607+) Secure storage via DPAPI macOS link macOS 10.15+ (Catalina or later) Secure storage via Keychain Linux link Ubuntu 20.04+, Fedora 35+, or compatible distributions XOR obfuscation (not cryptographically secure) Next Steps link Quick Start Guide → - Generate your first token Complete Tutorial → - Full walkthrough Core Concepts → - Understand how it works "
            }
        );
    index.add(
            {
                id:  5 ,
                href: "\/docs\/user-guide\/managing-profiles\/",
                title: "Managing Profiles",
                description: "Create, edit, and manage authentication profiles",
                content: "Managing Profiles linkAuthentication profiles store your configuration for connecting to Microsoft Entra ID. Learn how to create, view, edit, and delete profiles.\nQuick Reference link Task Command Create new profile entratool config create List all profiles entratool config list Edit existing profile entratool config edit -p NAME Delete profile entratool config delete -p NAME Export profile entratool config export -p NAME Import profile entratool config import -f FILE Creating Profiles linkInteractive Creation linkThe easiest way to create a profile:\n1 entratool config create Prompts:\nProfile name: Unique identifier Client ID: From app registration Tenant ID: Your Azure AD tenant Authentication method: Secret or Certificate Scope: API permissions OAuth2 flow: (Optional) Default flow Example session:\nProfile name: my-graph-app Client ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Authentication method: 1. Client Secret 2. Certificate Select: 1 Client secret: ******************************** Scope: https://graph.microsoft.com/.default Set default OAuth2 flow? (y/n): y OAuth2 flow: 1. ClientCredentials 2. AuthorizationCode 3. DeviceCode 4. InteractiveBrowser Select: 1 ✓ Profile 'my-graph-app' created successfully Detailed guide →\nListing Profiles linkView All Profiles link 1 entratool config list Output:\nAvailable profiles: 1. my-graph-app Client ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Scope: https://graph.microsoft.com/.default Flow: ClientCredentials 2. personal-graph Client ID: abcdef12-3456-7890-abcd-ef1234567890 Tenant ID: common Scope: https://graph.microsoft.com/User.Read Flow: InteractiveBrowser JSON Output link 1 entratool config list --json Output:\n1 2 3 4 5 6 7 8 9 10 11 12 { \"profiles\": [ { \"name\": \"my-graph-app\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true } ] } Detailed guide →\nEditing Profiles linkInteractive Edit link 1 entratool config edit -p my-graph-app Select what to edit:\nWhat would you like to edit? 1. Client ID 2. Tenant ID 3. Client Secret 4. Scope 5. OAuth2 Flow 6. Authority URL q. Done Select: 4 Current scope: https://graph.microsoft.com/.default New scope: https://graph.microsoft.com/User.Read Mail.Read ✓ Profile 'my-graph-app' updated Common Edits linkRotate client secret:\n1 2 3 entratool config edit -p my-graph-app # Select: Client Secret # Enter new secret Change scope:\n1 2 3 entratool config edit -p my-graph-app # Select: Scope # Enter: new-scope Switch authentication method:\n1 2 3 4 entratool config edit -p my-graph-app # Select: Authentication Method # Choose: Certificate # Enter certificate path and password Detailed guide →\nDeleting Profiles linkDelete Single Profile link 1 entratool config delete -p my-graph-app Confirmation prompt:\nAre you sure you want to delete profile 'my-graph-app'? (y/n): y ✓ Profile deleted successfully What gets deleted:\nProfile configuration from profiles.json Associated secrets from secure storage Delete with Force linkSkip confirmation:\n1 entratool config delete -p my-graph-app --force ⚠️ Warning: This is permanent. Secrets cannot be recovered.\nDetailed guide →\nExporting Profiles linkExport for Backup linkExport profile configuration (without secrets):\n1 entratool config export -p my-graph-app -o my-profile.json Output file:\n1 2 3 4 5 6 7 8 9 { \"name\": \"my-graph-app\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true // Note: clientSecret is NOT included } Export All Profiles link 1 entratool config export -o all-profiles.json Security Note link warning Exported files do NOT include secrets or certificates.\nYou must manually transfer secrets to the new location using secure methods.\nDetailed guide →\nImporting Profiles linkImport Single Profile link 1 entratool config import -f my-profile.json Post-import:\n✓ Profile 'my-graph-app' imported successfully ⚠ You must set the client secret: entratool config edit -p my-graph-app Import with Merge linkIf a profile with the same name exists:\nProfile 'my-graph-app' already exists. 1. Skip 2. Overwrite 3. Rename (import as 'my-graph-app-2') Select: Batch Import linkImport multiple profiles:\n1 entratool config import -f team-profiles.json team-profiles.json:\n1 2 3 4 5 6 { \"profiles\": [ { \"name\": \"profile1\", \"clientId\": \"...\", ... }, { \"name\": \"profile2\", \"clientId\": \"...\", ... } ] } Detailed guide →\nProfile Storage linkStorage Location linkFile: ~/.entratool/profiles.json\nPlatforms:\nWindows: %USERPROFILE%\\.entratool\\profiles.json macOS/Linux: ~/.entratool/profiles.json What’s Stored linkIn profiles.json (plaintext):\nProfile name Client ID Tenant ID Scope OAuth2 flow preference Authority URL Certificate path In secure storage (encrypted):\nClient secrets Certificate passwords Manual Editing linkYou can manually edit profiles.json:\n1 2 3 4 5 # macOS/Linux nano ~/.entratool/profiles.json # Windows notepad %USERPROFILE%\\.entratool\\profiles.json Example:\n1 2 3 4 5 6 7 8 9 10 11 12 { \"profiles\": [ { \"name\": \"my-profile\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true } ] } ⚠️ Be careful: Invalid JSON will break profile loading.\nCommon Workflows linkScenario: Team Onboarding linkShare profiles with new team members:\nExport profiles (without secrets):\n1 entratool config export -o team-profiles.json Share team-profiles.json via secure channel\nTeam member imports:\n1 entratool config import -f team-profiles.json Securely share secrets (use Azure Key Vault or password manager)\nTeam member adds secrets:\n1 2 entratool config edit -p profile1 # Add client secret Scenario: Environment Migration linkMove profiles from dev to prod machine:\nExport from dev:\n1 entratool config export -p prod-profile -o prod.json Transfer file securely (SCP, encrypted USB, etc.)\nImport on prod:\n1 entratool config import -f prod.json Add production secret:\n1 entratool config edit -p prod-profile Scenario: Secret Rotation linkRotate client secret after compromise:\nGenerate new secret in Azure Portal Update profile: 1 2 3 entratool config edit -p compromised-profile # Select: Client Secret # Enter: new-secret Test: 1 entratool get-token -p compromised-profile Delete old secret from Azure Portal Best Practices link✅ Naming Conventions linkUse descriptive, hierarchical names:\n1 2 3 4 5 6 7 8 9 # Good company-graph-prod company-graph-dev project-api-staging # Avoid profile1 test myprofile ✅ Organize by Environment link 1 2 3 4 5 6 7 8 9 10 11 # Production prod-graph-api prod-azure-management # Staging staging-graph-api staging-azure-management # Development dev-graph-api dev-azure-management ✅ Separate Concerns linkCreate profiles for different purposes:\n1 2 3 4 5 6 7 8 9 10 # Read-only operations readonly-graph-profile # Write operations admin-graph-profile # Different APIs profile-graph profile-azure profile-custom-api ✅ Regular Maintenance link Review profiles monthly Delete unused profiles Rotate secrets quarterly Update scopes as needed ❌ Avoid link ❌ Sharing profiles via email ❌ Committing profiles to git ❌ Using the same profile for dev and prod ❌ Storing secrets in plaintext ❌ Reusing secrets across profiles Troubleshooting link“Profile not found” linkCause: Profile name doesn’t exist\nFix:\n1 2 3 4 5 # List available profiles entratool config list # Use correct name entratool get-token -p correct-profile-name “Profile already exists” linkCause: Creating profile with duplicate name\nFix:\n1 2 3 4 5 6 # Option 1: Delete existing entratool config delete -p duplicate-name # Option 2: Use different name entratool config create # Enter: duplicate-name-2 “Invalid profile configuration” linkCause: Corrupted profiles.json\nFix:\n1 2 3 4 5 6 7 # Backup current file cp ~/.entratool/profiles.json ~/.entratool/profiles.json.bak # Validate JSON cat ~/.entratool/profiles.json | jq # Fix syntax errors or restore from backup “Cannot access secure storage” linkCause: Platform secure storage unavailable\nFix:\nWindows: Ensure user profile is not corrupted macOS: Unlock Keychain Linux: Check file permissions on ~/.entratool/ Next Steps link Creating Profiles (Detailed) Generating Tokens Certificate Authentication Security Best Practices "
            }
        );
    index.add(
            {
                id:  6 ,
                href: "\/docs\/user-guide\/generating-tokens\/",
                title: "Generating Tokens",
                description: "Request and obtain access tokens from Microsoft Entra ID",
                content: "Generating Tokens linkLearn how to generate access tokens using different OAuth2 flows and configurations.\nQuick Reference link Task Command Get token with profile entratool get-token -p PROFILE Override scope entratool get-token -p PROFILE --scope \"SCOPE\" Specify flow entratool get-token -p PROFILE -f FLOW Silent mode entratool get-token -p PROFILE --silent Save to file entratool get-token -p PROFILE -o token.txt Refresh token entratool refresh -p PROFILE Basic Token Generation linkUsing a Profile link 1 entratool get-token -p my-profile Output:\nAuthenticating with profile 'my-profile'... ✓ Token acquired successfully eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ij... What happens:\nProfile loaded from ~/.entratool/profiles.json Secrets retrieved from secure storage Authentication flow executed Access token printed to stdout Specifying a Flow linkOverride the default flow:\n1 entratool get-token -p my-profile -f ClientCredentials Available flows:\nClientCredentials AuthorizationCode DeviceCode InteractiveBrowser Learn about flows →\nClient Credentials Flow linkNon-Interactive Service Authentication link 1 entratool get-token -p service-principal -f ClientCredentials Requirements:\nClient secret or certificate configured Application permissions granted Admin consent completed Example:\n1 2 # Service principal for Graph API entratool get-token -p graph-sp -f ClientCredentials Output:\n✓ Token acquired successfully eyJ0eXAiOiJKV1QiLCJh... Detailed guide →\nInteractive Browser Flow linkUser Authentication with Browser link 1 entratool get-token -p user-app -f InteractiveBrowser What happens:\nBrowser opens to Entra ID login page User enters credentials User consents to permissions (if required) Browser redirects to localhost with code Tool exchanges code for token Example:\n1 entratool get-token -p personal-graph -f InteractiveBrowser Output:\nOpening browser for authentication... ✓ Authentication successful ✓ Token acquired eyJ0eXAiOiJKV1QiLCJh... Detailed guide →\nDevice Code Flow linkAuthentication on Limited-Input Devices link 1 entratool get-token -p iot-device -f DeviceCode What happens:\nTool displays code and URL User visits URL on another device User enters code User authenticates Tool polls and receives token Example:\n1 entratool get-token -p headless-server -f DeviceCode Output:\nDevice Code Authentication To sign in, use a web browser to open: https://microsoft.com/devicelogin and enter the code: ABCD-1234 Waiting for authentication... ✓ Token acquired successfully Detailed guide →\nAuthorization Code Flow linkWeb Application Authentication link 1 entratool get-token -p webapp -f AuthorizationCode Requirements:\nRedirect URI configured in app registration Delegated permissions User credentials Example:\n1 entratool get-token -p web-backend -f AuthorizationCode Output:\nOpening browser for authentication... Redirect URI: http://localhost:8080 ✓ Authorization code received ✓ Token acquired eyJ0eXAiOiJKV1QiLCJh... Detailed guide →\nScope Override linkRuntime Scope Specification linkOverride profile’s default scope:\n1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read\" Use cases:\nDifferent operations need different permissions Testing with minimal scopes Temporary scope changes Multiple Scopes linkSpace-separated:\n1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read Calendars.Read\" Comma-separated:\n1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read,Mail.Read,Calendars.Read\" .default Scope linkRequest all configured permissions:\n1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/.default\" Learn about scopes →\nCertificate Authentication linkUsing Certificates Instead of Secrets link 1 entratool get-token -p cert-profile -f ClientCredentials Profile configuration:\n1 2 3 4 5 6 7 { \"name\": \"cert-profile\", \"clientId\": \"...\", \"tenantId\": \"...\", \"certificatePath\": \"/path/to/cert.pfx\", \"useCertificate\": true } Certificate password:\nStored securely in platform-specific storage Prompted once during profile creation Never stored in plaintext Advantages link✅ More secure than secrets\n✅ Longer validity periods\n✅ Better for automation\n✅ Certificate rotation support\nDetailed certificate guide →\nOutput Options linkSilent Mode linkSuppress all output except the token:\n1 entratool get-token -p myprofile --silent Output:\neyJ0eXAiOiJKV1QiLCJh... Use in scripts:\n1 2 TOKEN=$(entratool get-token -p myprofile --silent) curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/me Save to File link 1 entratool get-token -p myprofile -o token.txt Output:\n✓ Token saved to token.txt Use later:\n1 2 TOKEN=$(cat token.txt) curl -H \"Authorization: Bearer $TOKEN\" ... JSON Output link 1 entratool get-token -p myprofile --json Output:\n1 2 3 4 5 6 { \"accessToken\": \"eyJ0eXAiOiJKV1QiLCJh...\", \"expiresOn\": \"2024-12-01T12:00:00Z\", \"tokenType\": \"Bearer\", \"scopes\": [\"https://graph.microsoft.com/.default\"] } Token Inspection linkInspect Token Claims link 1 2 # Generate and inspect in one command entratool get-token -p myprofile --silent | entratool inspect Or separately:\n1 2 TOKEN=$(entratool get-token -p myprofile --silent) entratool inspect -t \"$TOKEN\" Output:\n1 2 3 4 5 6 7 8 9 { \"aud\": \"https://graph.microsoft.com\", \"iss\": \"https://sts.windows.net/...\", \"iat\": 1701432000, \"exp\": 1701435600, \"appid\": \"12345678-1234-1234-1234-123456789abc\", \"scp\": \"User.Read Mail.Read\", \"roles\": [] } Learn about token inspection →\nToken Refresh linkRefreshing Expired Tokens linkIf you have a refresh token:\n1 entratool refresh -p myprofile Requirements:\nOriginal token acquired with offline_access scope Refresh token stored in cache Output:\nRefreshing token for profile 'myprofile'... ✓ Token refreshed successfully eyJ0eXAiOiJKV1QiLCJh... Note: Client Credentials flow doesn’t support refresh tokens. Just request a new token instead.\nLearn about token refreshing →\nCommon Patterns linkPattern 1: Script Automation link 1 2 3 4 5 6 7 8 9 10 #!/bin/bash set -e # Get token TOKEN=$(entratool get-token -p automation --silent) # Use token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/users \\ | jq Pattern 2: Environment Variable link 1 2 3 4 5 export ACCESS_TOKEN=$(entratool get-token -p myprofile --silent) # Use in multiple commands curl -H \"Authorization: Bearer $ACCESS_TOKEN\" https://api1.example.com curl -H \"Authorization: Bearer $ACCESS_TOKEN\" https://api2.example.com Pattern 3: Token Caching link 1 2 3 4 5 6 7 8 TOKEN_FILE=~/.cache/entratool-token.txt # Check if token exists and is valid if [ ! -f \"$TOKEN_FILE\" ] || ! entratool discover -f \"$TOKEN_FILE\" \u0026\u003e/dev/null; then entratool get-token -p myprofile --silent \u003e \"$TOKEN_FILE\" fi TOKEN=$(cat \"$TOKEN_FILE\") Pattern 4: Multi-API Access link 1 2 3 4 5 6 7 # Get tokens for different APIs TOKEN_GRAPH=$(entratool get-token -p graph-profile --silent) TOKEN_AZURE=$(entratool get-token -p azure-profile --silent) # Use with different APIs curl -H \"Authorization: Bearer $TOKEN_GRAPH\" https://graph.microsoft.com/v1.0/me curl -H \"Authorization: Bearer $TOKEN_AZURE\" https://management.azure.com/subscriptions Troubleshooting link“Profile not found” linkCause: Profile name is incorrect\nFix:\n1 2 3 4 5 # List profiles entratool config list # Use correct name entratool get-token -p correct-name “AADSTS70011: Invalid scope” linkCause: Requested scope is not configured in app registration\nFix:\nGo to Azure Portal → App registrations Select your app → API permissions Add the required permission Grant admin consent (if needed) “AADSTS7000215: Invalid client secret” linkCause: Client secret is expired or incorrect\nFix:\n1 2 3 4 5 # Rotate secret in Azure Portal # Update profile entratool config edit -p myprofile # Select: Client Secret # Enter: new-secret “Insufficient privileges” linkCause: Token has scope but lacks underlying permission\nFix:\nVerify API permissions in Azure Portal Grant admin consent For users: Assign appropriate Azure AD role “Browser did not respond” linkCause: Browser authentication timed out\nFix:\nTry Device Code flow instead: 1 entratool get-token -p myprofile -f DeviceCode Check redirect URI configuration Ensure localhost port is not blocked Best Practices link✅ Use Appropriate Flows link Automation: Client Credentials User apps: Interactive Browser Headless/SSH: Device Code Web apps: Authorization Code ✅ Request Minimal Scopes link 1 2 3 4 5 # ❌ Over-privileged --scope \"https://graph.microsoft.com/.default\" # ✓ Minimal --scope \"https://graph.microsoft.com/User.Read\" ✅ Handle Token Expiration link 1 2 3 4 5 6 7 # Check expiration before use entratool discover -f token.txt # Refresh if needed if [ $? -ne 0 ]; then entratool get-token -p myprofile --silent \u003e token.txt fi ✅ Secure Token Storage link 1 2 3 4 # Set restrictive permissions TOKEN_FILE=~/.cache/my-token.txt entratool get-token -p myprofile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" ❌ Avoid link ❌ Hard-coding tokens ❌ Committing tokens to git ❌ Sharing tokens via email/Slack ❌ Using expired tokens ❌ Requesting excessive scopes Next Steps link Client Credentials Flow (Detailed) Interactive Browser Flow (Detailed) Working with Tokens Token Recipes "
            }
        );
    index.add(
            {
                id:  7 ,
                href: "\/docs\/core-concepts\/oauth2-flows\/",
                title: "OAuth2 Flows",
                description: "Understanding the four OAuth2 authentication flows",
                content: "OAuth2 Flows linkEntra Token CLI supports four OAuth2 authentication flows. Each flow is designed for specific scenarios and security requirements.\nFlow Overview link Flow Use Case User Interaction Token Type Client Credentials Service-to-service None Application Authorization Code Web apps Required User + Application Device Code Limited-input devices Required (on another device) User Interactive Browser Desktop apps Required User Client Credentials Flow linkWhen to Use link Automated services and daemons CI/CD pipelines Background jobs without user context Service-to-service authentication How It Works link Application authenticates with client ID + secret (or certificate) Entra ID validates credentials Returns application-only access token Requirements link App registration with Application permissions (not Delegated) Admin consent granted Client secret or certificate Example link 1 entratool get-token -p service-principal -f ClientCredentials Full guide →\nAuthorization Code Flow linkWhen to Use link Web applications with user sign-in Apps requiring user context Multi-user scenarios Secure applications with confidential client How It Works link User is redirected to Entra ID sign-in page User authenticates and consents to permissions Entra ID returns authorization code Application exchanges code for access token Requirements link Redirect URI configured in app registration Delegated permissions User account credentials Example link 1 entratool get-token -p webapp -f AuthorizationCode Full guide →\nDevice Code Flow linkWhen to Use link Headless devices (IoT, servers) Limited-input devices (smart TVs, printers) SSH sessions Scenarios without browser access How It Works link Application requests device code User visits URL on another device and enters code Application polls Entra ID for token Token issued after user completes authentication Requirements link Device code flow enabled in app registration User account credentials Access to another device with browser Example link 1 entratool get-token -p iot-device -f DeviceCode Output:\nDevice Code Authentication To sign in, use a web browser to open https://microsoft.com/devicelogin and enter the code: ABCD-1234 Code: ABCD-1234 URL: https://microsoft.com/devicelogin Full guide →\nInteractive Browser Flow linkWhen to Use link Desktop applications Command-line tools with user authentication Personal productivity apps Interactive sessions How It Works link Application launches system browser User authenticates in browser Browser redirects to localhost with authorization code Application exchanges code for token Requirements link Redirect URI: http://localhost:{port} configured Delegated permissions User account credentials Browser availability Example link 1 entratool get-token -p desktop-app -f InteractiveBrowser Full guide →\nFlow Selection linkAutomatic Inference linkIf you don’t specify a flow with -f, the tool automatically infers based on your profile’s authentication method:\nClient Secret or Certificate → Client Credentials Other methods → Interactive Browser You can override this by setting a default flow in your profile or using the -f flag.\nSetting Default Flow linkWhen creating or editing a profile:\n1 2 3 4 entratool config create # ... other prompts ... Set default OAuth2 flow? y Default OAuth2 flow: ClientCredentials Or specify at runtime:\n1 entratool get-token -p myprofile -f DeviceCode Comparison Matrix linkUser Experience link Flow User Action Complexity Client Credentials None Simple Authorization Code Sign in + consent Moderate Device Code Sign in on another device Moderate Interactive Browser Sign in in browser Simple Security link Flow Security Level Best For Client Credentials High (with certificate) Automation Authorization Code High Web apps Device Code Medium Constrained devices Interactive Browser Medium-High User apps Token Properties link Flow Token Scope User Context Client Credentials Application No Authorization Code User + Application Yes Device Code User Yes Interactive Browser User Yes Common Scenarios linkScenario: Automated Azure Resource Management linkFlow: Client Credentials\nAuth: Certificate (recommended)\nScopes: https://management.azure.com/.default\n1 entratool get-token -p azure-automation -f ClientCredentials Scenario: Personal Microsoft Graph Access linkFlow: Interactive Browser or Device Code\nAuth: No client secret needed (public client)\nScopes: https://graph.microsoft.com/User.Read\n1 entratool get-token -p personal-graph -f InteractiveBrowser Scenario: CI/CD Pipeline linkFlow: Client Credentials\nAuth: Client Secret (stored in CI/CD secrets)\nScopes: API-specific scope\n1 entratool get-token -p cicd-deployer -f ClientCredentials Troubleshooting link“This application requires user consent” link Flow: Use Authorization Code or Interactive Browser Permissions: Configure Delegated permissions, not Application permissions “Client credentials flow not supported” link Fix: Enable Application permissions and grant admin consent Alternative: Use user-interactive flow instead “Redirect URI mismatch” link Fix: Add exact redirect URI to app registration Format: http://localhost:8080 (include port) Next Steps link Detailed Client Credentials Guide Detailed Authorization Code Guide Detailed Device Code Guide Detailed Interactive Browser Guide Understand Scopes "
            }
        );
    index.add(
            {
                id:  8 ,
                href: "\/docs\/getting-started\/quickstart\/",
                title: "Quick Start",
                description: "Generate your first token in 5 minutes",
                content: "Quick Start linkGenerate your first Entra ID access token in just a few minutes!\nStep 1: Install the Tool link 1 dotnet tool install -g EntraTokenCli See all installation options →\nStep 2: Create Your First Profile linkRun the interactive profile creation:\n1 entratool config create You’ll be prompted for:\nProfile name: myprofile (or any name you choose) Tenant ID: Your Azure tenant ID (e.g., contoso.onmicrosoft.com or GUID) Client ID: Your app registration client ID Scopes: https://graph.microsoft.com/.default (default for Microsoft Graph) Auth method: Choose ClientSecret for this quick start Client secret: Your app’s client secret (securely stored) Example:\nProfile name: myprofile Tenant ID: contoso.onmicrosoft.com Client ID: 12345678-1234-1234-1234-123456789abc Scopes (comma-separated): https://graph.microsoft.com/.default Authentication method: ClientSecret Client secret: **** 💡 Tip: Don’t have an app registration? See the Complete Tutorial for step-by-step setup.\nStep 3: Generate a Token link 1 entratool get-token -p myprofile The tool will:\nAuthenticate using your profile credentials Request a token from Entra ID Display the token details Copy the token to your clipboard (if available) Expected output:\n✓ Token retrieved successfully Expires: 2025-12-26 15:30:00 UTC (59 minutes) Scopes: https://graph.microsoft.com/.default Token copied to clipboard! Step 4: Use Your Token linkThe token is now in your clipboard. Use it to call APIs:\n1 2 3 # Example: Get current user info from Microsoft Graph curl -H \"Authorization: Bearer YOUR_TOKEN_HERE\" \\ https://graph.microsoft.com/v1.0/me Or read from the token file in headless environments:\n1 2 3 TOKEN=$(cat ~/.config/entratool/last-token.txt) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Step 5: Inspect the Token (Optional) linkWant to see what’s inside your token?\n1 entratool inspect $(cat ~/.config/entratool/last-token.txt) This decodes the JWT and displays claims like:\nAudience (aud) Issuer (iss) Subject (sub) Expiration (exp) Scopes (scp/roles) What’s Next? linkLearn the basics:\nAuthentication Profiles - Understand profiles OAuth2 Flows - Learn about different flows Scopes - Manage API permissions Explore features:\nManaging Profiles - Create, edit, export profiles Certificate Authentication - Use certificates instead of secrets Scope Overrides - Get tokens for different APIs Try recipes:\nService Principal Authentication Calling Microsoft Graph Custom APIs Troubleshooting linkToken generation fails?\nVerify your client ID and secret are correct Check app registration permissions in Azure Ensure tenant ID is correct Token not copied to clipboard?\nIn headless environments, use the file output Use --no-clipboard flag to suppress clipboard operations See full troubleshooting guide →\n"
            }
        );
    index.add(
            {
                id:  9 ,
                href: "\/docs\/user-guide\/",
                title: "User Guide",
                description: "Complete guide to using Entra Token CLI",
                content: "User Guide linkComprehensive guides for day-to-day usage of Entra Token CLI.\nGetting Started linkIf you’re new to Entra Token CLI, start here:\nInstallation - Install the tool on your platform Quick Start - Generate your first token in 5 minutes First Token Tutorial - Step-by-step from Azure to token Core Tasks linkManaging Profiles linkAuthentication profiles store your configuration for connecting to Microsoft Entra ID.\nManaging Profiles →\nLearn how to:\nCreate new profiles with interactive prompts List and view all configured profiles Edit existing profile settings Delete profiles and associated secrets Export profiles for backup Import profiles from files Organize profiles by environment Generating Tokens linkRequest access tokens using different OAuth2 flows and configurations.\nGenerating Tokens →\nLearn how to:\nGenerate tokens with client credentials flow Authenticate users with interactive browser Use device code for limited-input devices Override scopes at runtime Work with certificate authentication Handle different OAuth2 flows Automate token generation Working with Tokens linkInspect, validate, refresh, and use tokens effectively.\nWorking with Tokens →\nLearn how to:\nInspect JWT token claims Discover token information quickly Validate token expiration Refresh expired tokens Use tokens with Microsoft Graph Use tokens with Azure Management API Handle token expiration in scripts Store tokens securely By Scenario linkFor Developers linkBuilding applications:\nInteractive user authentication Inspecting token claims Testing different scopes API integration:\nMicrosoft Graph API access Azure Management API Custom API integration For DevOps Engineers linkAutomation:\nService principal setup Client credentials flow CI/CD integration Certificates:\nCertificate authentication Certificate rotation Secure certificate storage For System Administrators linkMulti-environment management:\nOrganizing profiles Profile export/import Secret rotation Security:\nSecure storage Security hardening Production deployment Common Workflows linkDaily Development link 1 2 3 4 5 6 # Morning: Get fresh token entratool get-token -p dev-graph --silent \u003e ~/.cache/token.txt # Use throughout the day TOKEN=$(cat ~/.cache/token.txt) curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/me Multi-Environment Testing link 1 2 3 4 5 6 7 8 # Test in dev entratool get-token -p dev-api -f ClientCredentials # Test in staging entratool get-token -p staging-api -f ClientCredentials # Deploy to prod entratool get-token -p prod-api -f ClientCredentials Secret Rotation link 1 2 3 4 5 6 7 8 9 10 # 1. Generate new secret in Azure Portal # 2. Update profile entratool config edit -p my-service-principal # Select: Client Secret # Enter: new-secret-from-portal # 3. Test entratool get-token -p my-service-principal # 4. Delete old secret in Azure Portal Team Onboarding link 1 2 3 4 5 6 7 8 9 10 11 12 # Team lead: Export profiles (without secrets) entratool config export -o team-profiles.json # Share team-profiles.json via secure channel # Share secrets via Azure Key Vault or password manager # New team member: Import entratool config import -f team-profiles.json # Add secrets entratool config edit -p profile1 # Add client secret from Key Vault Quick Command Reference link Task Command Profiles Create profile entratool config create List profiles entratool config list Edit profile entratool config edit -p NAME Delete profile entratool config delete -p NAME Export profile entratool config export -p NAME -o FILE Import profile entratool config import -f FILE Tokens Get token entratool get-token -p PROFILE Override scope entratool get-token -p PROFILE --scope \"SCOPE\" Specify flow entratool get-token -p PROFILE -f FLOW Silent output entratool get-token -p PROFILE --silent Save to file entratool get-token -p PROFILE -o token.txt Refresh token entratool refresh -p PROFILE Token Info Inspect token entratool inspect -t TOKEN Discover info entratool discover -t TOKEN Check expiration entratool discover -t TOKEN Advanced Topics linkOAuth2 Flows linkUnderstanding when to use each flow:\nClient Credentials - Service-to-service Authorization Code - Web applications Device Code - Limited-input devices Interactive Browser - Desktop apps Certificate Authentication linkUsing certificates for enhanced security:\nGetting Started with Certificates Creating Certificates Certificate Storage Certificate Rotation Platform-Specific Guides linkPlatform considerations and best practices:\nWindows Guide macOS Guide Linux Guide - ⚠️ Security warnings Troubleshooting linkCommon issues and solutions:\nProfile Issues Authentication Failures Token Problems Permission Errors Certificate Issues Next Steps linkLearn Core Concepts link Authentication Profiles OAuth2 Flows Scopes \u0026 Permissions Secure Storage Explore Recipes link Microsoft Graph Integration Azure Management CI/CD Integration Security Hardening Reference link Command Reference Configuration Reference API Reference "
            }
        );
    index.add(
            {
                id:  10 ,
                href: "\/docs\/getting-started\/first-token\/",
                title: "First Token Tutorial",
                description: "Complete end-to-end guide from Azure setup to token generation",
                content: "Your First Token - Complete Tutorial linkThis tutorial walks you through the complete process from setting up an app registration in Azure to generating your first token.\nPrerequisites link Azure subscription with access to create app registrations Entra Token CLI installed (Installation Guide) Basic understanding of Azure and authentication concepts Step 1: Create an App Registration link1.1 Navigate to Azure Portal link Go to Azure Portal Navigate to Azure Active Directory (or Microsoft Entra ID) Select App registrations from the left menu Click New registration 1.2 Register Your Application linkFill in the registration form:\nName: entratool-demo (or your preferred name) Supported account types: Select “Accounts in this organizational directory only” for single tenant Or choose multi-tenant if needed Redirect URI: Leave blank for now (we’ll add later if needed) Click Register\n1.3 Note Your IDs linkAfter registration, save these values:\nApplication (client) ID: Found on the Overview page Directory (tenant) ID: Also on the Overview page Step 2: Create a Client Secret link2.1 Generate Secret link In your app registration, go to Certificates \u0026 secrets Click New client secret Add a description: entratool-demo-secret Choose expiration: 6 months for testing 24 months for longer-term use Click Add 2.2 Copy the Secret link⚠️ Important: Copy the secret Value immediately - it won’t be shown again!\nStep 3: Configure API Permissions link3.1 Add Permissions link Go to API permissions in your app registration Click Add a permission Select Microsoft Graph Choose Application permissions (for service-to-service) Search for and add these permissions: User.Read.All (to read user information) Or any other permissions your application needs 3.2 Grant Admin Consent link Click Grant admin consent for [Your Organization] Confirm by clicking Yes 💡 Note: Admin consent is required for application permissions\nStep 4: Create Your Profile linkNow that your Azure app is configured, create a profile in entratool:\n1 entratool config create Enter the following when prompted:\nProfile name: demo-profile Tenant ID: YOUR-TENANT-ID Client ID: YOUR-CLIENT-ID Scopes (comma-separated): https://graph.microsoft.com/.default Authentication method: ClientSecret Client secret: YOUR-CLIENT-SECRET Set default OAuth2 flow? n Configure custom redirect URI? n Success! Your profile is created and the secret is securely stored.\nStep 5: Generate Your First Token link 1 entratool get-token -p demo-profile You should see output like:\n✓ Token retrieved successfully Expires: 2025-12-26 15:30:00 UTC (59 minutes) Scopes: https://graph.microsoft.com/.default Token Type: Bearer Token copied to clipboard! Step 6: Verify Your Token link6.1 Inspect the Token link 1 entratool inspect $(cat ~/.config/entratool/last-token.txt) This shows the decoded JWT claims, including:\naud: Audience (should be https://graph.microsoft.com) iss: Issuer (your Azure tenant) app_displayname: Your app name roles: Assigned application permissions exp: Expiration timestamp 6.2 Use the Token linkTest your token with Microsoft Graph:\n1 2 3 TOKEN=$(cat ~/.config/entratool/last-token.txt) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/users?$top=5 You should receive a JSON response with user data!\nTroubleshooting link“Invalid client secret” link Verify you copied the secret value (not the secret ID) Check if the secret has expired Regenerate the secret if needed “Insufficient privileges” link Ensure you granted admin consent for the permissions Verify the permissions are Application permissions, not Delegated permissions Wait a few minutes for changes to propagate “Token request failed” link Double-check tenant ID and client ID Ensure network connectivity to Azure Check if your Azure subscription is active What’s Next? linkExplore different flows:\nAuthorization Code Flow - For user authentication Device Code Flow - For limited-input devices Interactive Browser - For desktop applications Learn about features:\nScope Management - Using tokens for different APIs Certificate Authentication - Using certificates instead of secrets Profile Management - Managing multiple profiles Try recipes:\nCalling Microsoft Graph - Common Graph API scenarios Custom APIs - Access your own APIs CI/CD Integration - Use in automated pipelines "
            }
        );
    index.add(
            {
                id:  11 ,
                href: "\/docs\/core-concepts\/scopes\/",
                title: "Scopes \u0026 Permissions",
                description: "Understanding API scopes and permission requests",
                content: "Scopes \u0026 Permissions linkScopes define what your application can access using an access token. Understanding scopes is critical for requesting the right permissions and troubleshooting authorization issues.\nWhat Are Scopes? linkA scope is a permission that grants access to specific resources or operations in an API.\nFormat link https://api.example.com/.default https://graph.microsoft.com/User.Read https://management.azure.com/user_impersonation Parts:\nResource URI: The API you’re accessing (https://graph.microsoft.com) Permission: The specific capability (User.Read, .default) Common Scope Patterns linkMicrosoft Graph API link 1 2 3 4 5 6 7 8 9 # Read user profile https://graph.microsoft.com/User.Read # Read user profile and email https://graph.microsoft.com/User.Read https://graph.microsoft.com/Mail.Read # All configured permissions https://graph.microsoft.com/.default Azure Management API link 1 2 3 4 5 # Azure Resource Manager access https://management.azure.com/.default # With user impersonation https://management.azure.com/user_impersonation Custom APIs link 1 2 3 4 5 # Your custom API https://api.contoso.com/.default # Specific scopes api://12345678-1234-1234-1234-123456789abc/access_as_user Azure Key Vault link 1 https://vault.azure.net/.default Azure Storage link 1 https://storage.azure.com/.default The .default Scope linkWhat It Means linkThe .default suffix requests all permissions configured in your app registration.\nExample: If your app is configured with:\nUser.Read Mail.Read Calendars.Read Then requesting https://graph.microsoft.com/.default includes all three.\nWhen to Use link✅ Use .default when:\nWorking with service principals (Client Credentials flow) You want all configured permissions Building automation scripts ⚠️ Avoid .default when:\nRequesting minimal permissions Building user-facing apps (use explicit scopes) Different operations need different scopes Example link 1 2 3 # Request all configured Graph permissions entratool get-token -p service-principal \\ --scope \"https://graph.microsoft.com/.default\" Profile Scopes vs Runtime Scopes linkProfile Scopes linkScopes stored in your profile configuration:\n1 2 3 4 { \"name\": \"my-profile\", \"scope\": \"https://graph.microsoft.com/User.Read Mail.Read\" } Used by default when running:\n1 entratool get-token -p my-profile Runtime Scope Override linkOverride profile scopes with --scope or -s:\n1 2 3 # Override to request different scope entratool get-token -p my-profile \\ --scope \"https://graph.microsoft.com/Calendar.Read\" Use cases:\nDifferent operations need different permissions Testing with minimal scopes Temporary scope changes without editing profile Multiple Scopes linkSpace-Separated Format link 1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read Calendars.Read\" Comma-Separated Format link 1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read,Mail.Read,Calendars.Read\" The tool normalizes both formats automatically.\nScope Requirements by Flow linkClient Credentials Flow linkRequires: Application permissions configured in Azure Portal\n1 2 3 # App registration → API permissions → Add permission # Select: Application permissions (not Delegated) # Grant admin consent ✓ Example scopes:\n1 2 https://graph.microsoft.com/.default https://management.azure.com/.default User-Interactive Flows linkRequires: Delegated permissions configured in Azure Portal\n1 2 3 # App registration → API permissions → Add permission # Select: Delegated permissions # User consent required (or admin consent) Example scopes:\n1 2 https://graph.microsoft.com/User.Read https://graph.microsoft.com/Mail.Read Inspecting Token Scopes linkUse inspect to see what scopes are included in your token:\n1 entratool inspect -t \"eyJ0eXAiOiJKV1QiLCJhbGci...\" Output:\n1 2 3 4 { \"scp\": \"User.Read Mail.Read\", \"roles\": [\"User.Read.All\"] } Fields:\nscp: Delegated permissions (user context) roles: Application permissions (app context) Common Scope Patterns linkReading User Data link 1 2 3 4 # Microsoft Graph https://graph.microsoft.com/User.Read # Basic profile https://graph.microsoft.com/User.Read.All # All users (admin) https://graph.microsoft.com/User.ReadWrite # Modify profile Email Access link 1 2 3 https://graph.microsoft.com/Mail.Read # Read email https://graph.microsoft.com/Mail.Send # Send email https://graph.microsoft.com/Mail.ReadWrite # Full email access Calendar Access link 1 2 https://graph.microsoft.com/Calendars.Read https://graph.microsoft.com/Calendars.ReadWrite Azure Resource Management link 1 2 https://management.azure.com/.default https://management.azure.com/user_impersonation SharePoint link 1 2 https://graph.microsoft.com/Sites.Read.All https://graph.microsoft.com/Files.ReadWrite.All Scope Configuration linkSetting Scopes in Profile linkDuring Creation link 1 2 3 entratool config create # ... prompts ... Scope: https://graph.microsoft.com/.default During Edit link 1 2 3 entratool config edit -p myprofile # Select: Scope # Enter new: https://management.azure.com/.default Manual JSON Edit linkEdit ~/.entratool/profiles.json:\n1 2 3 4 5 6 7 8 { \"profiles\": [ { \"name\": \"myprofile\", \"scope\": \"https://graph.microsoft.com/User.Read Mail.Read\" } ] } Scope Troubleshooting link“Invalid scope” linkCause: Scope format is incorrect\nFix:\n1 2 3 4 5 # ❌ Wrong --scope \"User.Read\" # ✓ Correct --scope \"https://graph.microsoft.com/User.Read\" “AADSTS65001: User consent required” linkCause: User hasn’t consented to delegated permissions\nFix:\nUse interactive flow (Authorization Code or Interactive Browser) User will be prompted to consent Or: Admin grants consent in Azure Portal “AADSTS70011: Invalid scopes” linkCause: Scope not configured in app registration\nFix:\nGo to Azure Portal → App registrations Select your app → API permissions Add the required permission Grant admin consent (if Application permission) “Insufficient privileges” linkCause: Token has scope but user/app lacks underlying permission\nFix:\nFor users: Assign appropriate role (e.g., Global Reader) For apps: Grant admin consent for Application permissions Verify permission configuration in Azure Portal Best Practices link✅ Principle of Least Privilege linkRequest only the scopes you need:\n1 2 3 4 5 # ❌ Over-privileged --scope \"https://graph.microsoft.com/.default\" # ✓ Minimal scopes --scope \"https://graph.microsoft.com/User.Read Mail.Read\" ✅ Use Explicit Scopes for User Apps linkFor user-facing applications, request specific scopes:\n1 2 entratool get-token -p user-app \\ --scope \"https://graph.microsoft.com/User.Read\" ✅ Use .default for Service Principals linkFor automation and service accounts:\n1 2 entratool get-token -p automation \\ --scope \"https://graph.microsoft.com/.default\" ✅ Separate Profiles for Different Scopes linkCreate profiles for different scenarios:\n1 2 3 4 5 # Profile: graph-readonly scope: https://graph.microsoft.com/User.Read # Profile: graph-admin scope: https://graph.microsoft.com/.default ❌ Don’t Hard-Code Tokens linkAlways request fresh tokens with appropriate scopes:\n1 2 3 # ✓ Request token per operation TOKEN=$(entratool get-token -p myprofile --scope \"...\") curl -H \"Authorization: Bearer $TOKEN\" ... Scope Discovery linkFinding Available Scopes link Azure Portal:\nApp registrations → API permissions → Add permission Browse Microsoft APIs or your custom APIs View available Delegated and Application permissions Microsoft Graph Explorer:\nVisit: https://developer.microsoft.com/graph/graph-explorer Explore API endpoints and required scopes API Documentation:\nMicrosoft Graph: https://docs.microsoft.com/graph/permissions-reference Azure Management: https://docs.microsoft.com/rest/api/azure/ Using discover Command link 1 entratool discover -t \"eyJ0eXAiOiJKV1Qi...\" Output shows:\nToken audience Issued scopes Roles Expiration time Scope Combinations linkCommon Combinations linkGraph API Read-Only Access link 1 --scope \"https://graph.microsoft.com/User.Read Mail.Read Calendars.Read\" Graph API Admin Access link 1 --scope \"https://graph.microsoft.com/.default\" Azure Management + Graph link 1 2 3 # Request separately (different audiences) TOKEN_GRAPH=$(entratool get-token -p graph --scope \"https://graph.microsoft.com/.default\") TOKEN_AZURE=$(entratool get-token -p azure --scope \"https://management.azure.com/.default\") Next Steps link Learn about OAuth2 Flows Understand Authentication Profiles Inspect Tokens Scope Troubleshooting Guide "
            }
        );
    index.add(
            {
                id:  12 ,
                href: "\/docs\/user-guide\/working-with-tokens\/",
                title: "Working with Tokens",
                description: "Inspect, validate, and use access tokens effectively",
                content: "Working with Tokens linkOnce you have an access token, learn how to inspect, validate, refresh, and use it effectively with APIs.\nQuick Reference link Task Command Inspect token entratool inspect -t TOKEN Inspect from file entratool inspect -f token.txt Discover token info entratool discover -t TOKEN Refresh token entratool refresh -p PROFILE Check expiration entratool discover -t TOKEN | jq .exp Token Inspection linkDecode JWT Claims link 1 entratool inspect -t \"eyJ0eXAiOiJKV1QiLCJh...\" Output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 { \"header\": { \"typ\": \"JWT\", \"alg\": \"RS256\", \"kid\": \"abc123...\" }, \"payload\": { \"aud\": \"https://graph.microsoft.com\", \"iss\": \"https://sts.windows.net/12345678-1234-1234-1234-123456789abc/\", \"iat\": 1701432000, \"nbf\": 1701432000, \"exp\": 1701435600, \"appid\": \"12345678-1234-1234-1234-123456789abc\", \"appidacr\": \"1\", \"idp\": \"https://sts.windows.net/...\", \"oid\": \"87654321-4321-4321-4321-cba987654321\", \"rh\": \"...\", \"sub\": \"...\", \"tid\": \"12345678-1234-1234-1234-123456789abc\", \"uti\": \"...\", \"ver\": \"1.0\", \"scp\": \"User.Read Mail.Read\", \"roles\": [] }, \"signature\": \"...\" } Inspect from File link 1 2 entratool get-token -p myprofile --silent \u003e token.txt entratool inspect -f token.txt Inspect from Pipeline link 1 entratool get-token -p myprofile --silent | entratool inspect Detailed inspection guide →\nUnderstanding Token Claims linkEssential Claims link Claim Description Example aud Audience (API) https://graph.microsoft.com iss Issuer (Entra ID) https://sts.windows.net/... iat Issued at (Unix timestamp) 1701432000 exp Expiration (Unix timestamp) 1701435600 appid Application ID 12345678-... tid Tenant ID 87654321-... Permission Claims linkDelegated permissions (user context):\n1 2 3 { \"scp\": \"User.Read Mail.Read Calendars.Read\" } Application permissions (app context):\n1 2 3 { \"roles\": [\"User.Read.All\", \"Mail.Send\"] } User Claims link 1 2 3 4 5 6 { \"unique_name\": \"user@contoso.com\", \"upn\": \"user@contoso.com\", \"name\": \"John Doe\", \"oid\": \"87654321-4321-4321-4321-cba987654321\" } Token Discovery linkQuick Token Info link 1 entratool discover -t \"eyJ0eXAiOiJKV1QiLCJh...\" Output:\nToken Information: Audience: https://graph.microsoft.com Issued: 2024-12-01 10:00:00 UTC Expires: 2024-12-01 11:00:00 UTC Time remaining: 45 minutes Scopes: User.Read Mail.Read Application ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Check if Token is Valid link 1 entratool discover -t \"eyJ0eXAiOiJKV1QiLCJh...\" \u0026\u0026 echo \"Valid\" || echo \"Expired\" Exit codes:\n0: Token is valid 1: Token is expired or invalid Expiration Check link 1 2 3 4 5 6 # Get expiration timestamp EXP=$(entratool inspect -t \"$TOKEN\" | jq -r .payload.exp) # Convert to readable date date -r $EXP # macOS date -d @$EXP # Linux Detailed discovery guide →\nToken Refresh linkWhen to Refresh linkRefresh token when:\nToken is expired or about to expire You need a fresh token with updated permissions Check expiration:\n1 entratool discover -t \"$TOKEN\" Refresh Command link 1 entratool refresh -p myprofile Requirements:\nOriginal token acquired with offline_access scope Refresh token available in cache Output:\nRefreshing token for profile 'myprofile'... ✓ Token refreshed successfully eyJ0eXAiOiJKV1QiLCJh... Refresh vs New Token link Operation Refresh New Token Speed Faster Slower User interaction None May require Requirements Refresh token Profile + credentials Use case Token expired First request or refresh unavailable When refresh isn’t available:\nClient Credentials flow (no refresh tokens) Refresh token expired (\u003e90 days of inactivity) Detailed refresh guide →\nUsing Tokens with APIs linkMicrosoft Graph API link 1 2 3 4 TOKEN=$(entratool get-token -p graph-profile --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Example response:\n1 2 3 4 5 6 7 { \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#users/$entity\", \"id\": \"87654321-4321-4321-4321-cba987654321\", \"displayName\": \"John Doe\", \"mail\": \"john.doe@contoso.com\", \"userPrincipalName\": \"john.doe@contoso.com\" } Azure Resource Manager link 1 2 3 4 TOKEN=$(entratool get-token -p azure-profile --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ \"https://management.azure.com/subscriptions?api-version=2020-01-01\" Custom APIs link 1 2 3 4 5 6 TOKEN=$(entratool get-token -p custom-api --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d '{\"key\": \"value\"}' \\ https://api.contoso.com/v1/resources Token Validation linkClient-Side Validation linkCheck expiration:\n1 2 3 4 5 6 7 8 9 10 # Extract exp claim EXP=$(entratool inspect -t \"$TOKEN\" | jq -r .payload.exp) # Compare with current time NOW=$(date +%s) if [ $EXP -lt $NOW ]; then echo \"Token expired\" else echo \"Token valid for $(( ($EXP - $NOW) / 60 )) minutes\" fi Verify audience:\n1 2 3 4 5 6 AUD=$(entratool inspect -t \"$TOKEN\" | jq -r .payload.aud) if [ \"$AUD\" = \"https://graph.microsoft.com\" ]; then echo \"Valid for Graph API\" else echo \"Wrong audience: $AUD\" fi Server-Side Validation linkAPIs validate tokens by:\nVerifying signature using Microsoft’s public keys Checking expiration (exp claim) Validating audience (aud claim) Checking issuer (iss claim) Microsoft Graph validates:\nToken signature Expiration time Audience = https://graph.microsoft.com Issuer from trusted Entra ID tenant Token Expiration linkTypical Lifetimes link Token Type Lifetime Access token 1 hour Refresh token 90 days (or until revoked) ID token 1 hour Handling Expiration linkPattern 1: Check before use\n1 2 3 4 5 6 if entratool discover -f token.txt \u0026\u003e/dev/null; then TOKEN=$(cat token.txt) else TOKEN=$(entratool get-token -p myprofile --silent) echo \"$TOKEN\" \u003e token.txt fi Pattern 2: Catch API errors\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 TOKEN=$(cat token.txt) RESPONSE=$(curl -s -w \"%{http_code}\" \\ -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me) if [[ \"$RESPONSE\" == *\"401\"* ]]; then # Token expired, get new one TOKEN=$(entratool get-token -p myprofile --silent) echo \"$TOKEN\" \u003e token.txt # Retry request curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me fi Pattern 3: Preemptive refresh\n1 2 3 4 5 6 7 8 # Refresh if less than 5 minutes remaining EXP=$(entratool inspect -f token.txt | jq -r .payload.exp) NOW=$(date +%s) REMAINING=$(( ($EXP - $NOW) / 60 )) if [ $REMAINING -lt 5 ]; then entratool get-token -p myprofile --silent \u003e token.txt fi Detailed expiration guide →\nToken Storage linkTemporary Storage link 1 2 3 4 5 6 # In-memory (session only) export TOKEN=$(entratool get-token -p myprofile --silent) # File (with restricted permissions) entratool get-token -p myprofile --silent \u003e /tmp/token.txt chmod 600 /tmp/token.txt Cache Location linkMSAL token cache:\nWindows: %LOCALAPPDATA%\\.msal\\cache macOS/Linux: ~/.msal/cache Contains:\nAccess tokens Refresh tokens ID tokens Account information Security:\nEncrypted on Windows (DPAPI) Encrypted on macOS (Keychain) ⚠️ Obfuscated on Linux (not secure) Clearing Cache link 1 2 3 4 5 # Delete cache directory rm -rf ~/.msal/cache # Next token request will require re-authentication entratool get-token -p myprofile Token Security link✅ Best Practices linkDo:\n✅ Request tokens on-demand ✅ Use HTTPS for all API requests ✅ Check token expiration before use ✅ Store tokens with restrictive permissions (600) ✅ Clear tokens after use ✅ Use environment variables for temporary storage ✅ Rotate credentials regularly Don’t:\n❌ Hard-code tokens in source code ❌ Commit tokens to git repositories ❌ Share tokens via email/chat ❌ Log tokens in plaintext ❌ Store tokens long-term ❌ Use tokens across environments (dev/prod) Secure Token Handling link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #!/bin/bash set -e # Secure temp file TOKEN_FILE=$(mktemp) trap \"rm -f $TOKEN_FILE\" EXIT # Get token entratool get-token -p myprofile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" # Use token TOKEN=$(cat \"$TOKEN_FILE\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com # File automatically deleted on exit Common Patterns linkPattern 1: Token in Script link 1 2 3 4 5 6 7 8 9 10 11 12 #!/bin/bash set -euo pipefail get_token() { entratool get-token -p \"$1\" --silent } TOKEN=$(get_token \"myprofile\") # Use token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Pattern 2: Cached Token link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #!/bin/bash TOKEN_CACHE=\"/tmp/my-token-cache.txt\" TOKEN_MAX_AGE=3000 # 50 minutes get_fresh_token() { entratool get-token -p myprofile --silent \u003e \"$TOKEN_CACHE\" chmod 600 \"$TOKEN_CACHE\" } # Check if cache exists and is fresh if [ -f \"$TOKEN_CACHE\" ]; then FILE_AGE=$(( $(date +%s) - $(stat -f %m \"$TOKEN_CACHE\") )) # macOS # FILE_AGE=$(( $(date +%s) - $(stat -c %Y \"$TOKEN_CACHE\") )) # Linux if [ $FILE_AGE -gt $TOKEN_MAX_AGE ]; then get_fresh_token fi else get_fresh_token fi TOKEN=$(cat \"$TOKEN_CACHE\") Pattern 3: Token Rotation link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #!/bin/bash # Function to get valid token get_valid_token() { local profile=$1 local token_file=\"/tmp/token-$profile.txt\" # Check if token exists and is valid if [ -f \"$token_file\" ] \u0026\u0026 entratool discover -f \"$token_file\" \u0026\u003e/dev/null; then cat \"$token_file\" else # Get fresh token entratool get-token -p \"$profile\" --silent | tee \"$token_file\" chmod 600 \"$token_file\" fi } # Use it TOKEN=$(get_valid_token \"myprofile\") curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com Pattern 4: Multi-Profile Management link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #!/bin/bash declare -A TOKENS get_token_for_profile() { local profile=$1 if [ -z \"${TOKENS[$profile]}\" ]; then TOKENS[$profile]=$(entratool get-token -p \"$profile\" --silent) fi echo \"${TOKENS[$profile]}\" } # Use different profiles GRAPH_TOKEN=$(get_token_for_profile \"graph-profile\") AZURE_TOKEN=$(get_token_for_profile \"azure-profile\") curl -H \"Authorization: Bearer $GRAPH_TOKEN\" https://graph.microsoft.com/v1.0/me curl -H \"Authorization: Bearer $AZURE_TOKEN\" https://management.azure.com/subscriptions Troubleshooting link“Invalid token” linkCause: Token is malformed or corrupted\nFix:\n1 2 3 4 5 # Validate token format entratool inspect -t \"$TOKEN\" # If invalid, get fresh token TOKEN=$(entratool get-token -p myprofile --silent) “Token expired” linkCause: Token lifetime exceeded\nFix:\n1 2 # Get new token TOKEN=$(entratool get-token -p myprofile --silent) “Insufficient privileges” linkCause: Token lacks required permissions\nFix:\nCheck token scopes: 1 entratool inspect -t \"$TOKEN\" | jq .payload.scp Request token with correct scopes: 1 2 entratool get-token -p myprofile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Send\" “Invalid audience” linkCause: Token issued for different API\nFix:\n1 2 3 4 5 6 # Check audience entratool inspect -t \"$TOKEN\" | jq .payload.aud # Get token for correct API entratool get-token -p myprofile \\ --scope \"https://correct-api.com/.default\" Next Steps link Token Inspection (Detailed) Token Refresh (Detailed) Token Expiration Handling API Integration Recipes "
            }
        );
    index.add(
            {
                id:  13 ,
                href: "\/docs\/recipes\/",
                title: "Recipes \u0026 Examples",
                description: "Practical examples and common integration patterns",
                content: "Recipes \u0026 Examples linkReal-world examples and patterns for integrating Entra Token CLI into your workflows.\nQuick Navigation linkAPI Integration link Microsoft Graph API - User management, email, calendars Azure Management API - Resource management Custom APIs - Your own API integration Automation link CI/CD Integration - GitHub Actions, Azure Pipelines Bash Scripts - Shell scripting patterns PowerShell Scripts - Windows automation Security link Security Hardening - Production best practices Secret Rotation - Credential lifecycle Multi-Environment Setup - Dev/staging/prod Advanced link Token Caching - Optimize performance Error Handling - Robust scripts Multi-Tenant Scenarios - Multiple tenants Microsoft Graph API linkRead User Profile link 1 2 3 4 5 #!/bin/bash TOKEN=$(entratool get-token -p graph-readonly --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me | jq List All Users link 1 2 3 4 5 #!/bin/bash TOKEN=$(entratool get-token -p graph-admin --silent) curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://graph.microsoft.com/v1.0/users?$select=displayName,mail' | jq Send Email link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/bin/bash TOKEN=$(entratool get-token -p graph-mail --silent \\ --scope \"https://graph.microsoft.com/Mail.Send\") curl -X POST \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d '{ \"message\": { \"subject\": \"Test Email\", \"body\": { \"contentType\": \"Text\", \"content\": \"This is a test email from Entra Token CLI\" }, \"toRecipients\": [ { \"emailAddress\": { \"address\": \"user@contoso.com\" } } ] }, \"saveToSentItems\": \"true\" }' \\ https://graph.microsoft.com/v1.0/me/sendMail More Microsoft Graph examples →\nAzure Management API linkList Subscriptions link 1 2 3 4 5 6 #!/bin/bash TOKEN=$(entratool get-token -p azure-mgmt --silent \\ --scope \"https://management.azure.com/.default\") curl -H \"Authorization: Bearer $TOKEN\" \\ 'https://management.azure.com/subscriptions?api-version=2020-01-01' | jq List Resource Groups link 1 2 3 4 5 6 #!/bin/bash TOKEN=$(entratool get-token -p azure-mgmt --silent) SUBSCRIPTION_ID=\"12345678-1234-1234-1234-123456789abc\" curl -H \"Authorization: Bearer $TOKEN\" \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/resourcegroups?api-version=2021-04-01\" | jq Create Virtual Machine link 1 2 3 4 5 6 7 8 9 10 11 #!/bin/bash TOKEN=$(entratool get-token -p azure-admin --silent) SUBSCRIPTION_ID=\"...\" RESOURCE_GROUP=\"my-rg\" VM_NAME=\"my-vm\" curl -X PUT \\ -H \"Authorization: Bearer $TOKEN\" \\ -H \"Content-Type: application/json\" \\ -d @vm-config.json \\ \"https://management.azure.com/subscriptions/$SUBSCRIPTION_ID/resourceGroups/$RESOURCE_GROUP/providers/Microsoft.Compute/virtualMachines/$VM_NAME?api-version=2021-03-01\" More Azure Management examples →\nCI/CD Integration linkGitHub Actions link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 name: Deploy on: [push] jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Install Entra Token CLI run: | dotnet tool install --global EntraTokenCli - name: Create Profile env: CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }} TENANT_ID: ${{ secrets.AZURE_TENANT_ID }} CLIENT_SECRET: ${{ secrets.AZURE_CLIENT_SECRET }} run: | # Create profile non-interactively cat \u003e profile.json \u003c"
            }
        );
    index.add(
            {
                id:  14 ,
                href: "\/docs\/core-concepts\/secure-storage\/",
                title: "Secure Storage",
                description: "How secrets and certificates are stored securely",
                content: "Secure Storage linkEntra Token CLI uses platform-specific secure storage mechanisms to protect sensitive authentication data. Understanding how secrets are stored helps you make informed security decisions.\nPlatform Security Overview link Platform Mechanism Security Level Notes Windows DPAPI 🔒 Strong User-account encryption macOS Keychain 🔒 Strong System-level encryption Linux XOR Obfuscation ⚠️ Weak Not secure for production What Gets Stored linkProfile Configuration (Plaintext) linkLocation: ~/.entratool/profiles.json\nStored in plaintext:\nProfile name Client ID Tenant ID Scope Authority URL OAuth2 flow preference Example:\n1 2 3 4 5 6 7 8 9 10 11 { \"profiles\": [ { \"name\": \"my-service-principal\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\" } ] } Secrets (Encrypted) linkWhat’s encrypted:\nClient secrets Certificate passwords Private key data Storage location:\nWindows: DPAPI-encrypted data macOS: Keychain access Linux: XOR-obfuscated file Windows Security (DPAPI) linkHow It Works linkData Protection API (DPAPI):\nBuilt into Windows Uses user account credentials to encrypt data Data is automatically tied to user profile Security Properties:\n✅ Strong encryption (AES-256) ✅ Automatic key management ✅ Per-user encryption ✅ OS-level protection Storage Location linkEncrypted data is stored in user-specific Windows data stores. The exact location is managed by Windows.\nAccess Control link Only the same user account on the same machine can decrypt Administrator accounts cannot decrypt another user’s DPAPI data Backing up and restoring requires user profile migration Security Considerations link✅ Safe for:\nDevelopment workstations Single-user systems Corporate managed devices ⚠️ Be aware:\nData is tied to user profile Lost password = lost data (unless backed up properly) Malware running under your account can access macOS Security (Keychain) linkHow It Works linkmacOS Keychain:\nSystem-level secure storage Encrypted with user’s login password Managed by macOS Security framework Security Properties:\n✅ Strong encryption (AES-256) ✅ Integration with Touch ID / Face ID ✅ Per-item access control ✅ Audit logging Storage Location link 1 ~/Library/Keychains/login.keychain-db Note: Keychain is encrypted; you cannot read it directly.\nViewing Secrets linkOpen Keychain Access app:\nLaunch: /Applications/Utilities/Keychain Access.app Search for: entratool Double-click item → “Show password” Authenticate with your login password Screenshot:\nAccess Control link Requires user authentication to access Can be protected by Touch ID Can set per-item access policies Exporting Keychain linkYou can export secrets for backup:\n1 security export -k login.keychain-db -t identities -o backup.p12 ⚠️ Warning: Exported files contain unencrypted secrets. Protect them carefully.\nSecurity Considerations link✅ Safe for:\nDevelopment workstations Personal Macs Production automation (with proper access controls) ⚠️ Be aware:\nMalware with keychain access can extract secrets User password compromise = keychain compromise Backup keychain securely Linux Security (XOR Obfuscation) link⚠️ Security Warning link report Linux storage is NOT secure for production use.\nSecrets are obfuscated using XOR encoding, which provides no real security. Anyone with access to the file can easily reverse the obfuscation.\nHow It Works linkXOR Obfuscation:\nSimple XOR cipher with fixed key Not encryption — just encoding Prevents casual viewing in text editors Security Properties:\n❌ No real protection ❌ Easily reversible ❌ Fixed obfuscation key in source code Storage Location link 1 ~/.entratool/secrets.dat Warning: This file contains your secrets in an easily decodable format.\nWhy XOR? linkLinux lacks a universal, secure secret storage mechanism:\nKeyring services vary by distribution (GNOME Keyring, KWallet, etc.) Not always available on servers or minimal installs Inconsistent APIs across distributions XOR obfuscation is a lowest common denominator approach that works everywhere but provides minimal security.\nLinux Alternatives link1. Environment Variables linkStore secrets in environment variables:\n1 2 export AZURE_CLIENT_SECRET=\"your-secret\" entratool get-token -p myprofile Profile without stored secret:\n1 2 3 4 5 6 { \"name\": \"myprofile\", \"clientId\": \"...\", \"useClientSecret\": true // No \"clientSecret\" field } The tool will read from AZURE_CLIENT_SECRET if available.\n2. Azure Key Vault linkStore secrets in Azure Key Vault and retrieve at runtime:\n1 2 SECRET=$(az keyvault secret show --vault-name MyVault --name ClientSecret --query value -o tsv) entratool get-token -p myprofile --client-secret \"$SECRET\" 3. HashiCorp Vault link 1 2 SECRET=$(vault kv get -field=client_secret secret/entratool) entratool get-token -p myprofile --client-secret \"$SECRET\" 4. Certificate Authentication linkUse certificates instead of secrets (more secure):\n1 2 3 entratool config create # Select: Certificate # Provide: /path/to/cert.pfx Certificates can be stored with restricted file permissions:\n1 2 chmod 600 /path/to/cert.pfx chown myuser:myuser /path/to/cert.pfx 5. Managed Identity (Azure VMs) linkOn Azure VMs, use Managed Identity (no secrets needed):\n1 2 3 # Configure VM with Managed Identity # No secrets stored locally entratool get-token -p managed-identity-profile Security Recommendations link warning For production Linux workloads:\nUse certificate authentication instead of client secrets Store certificates with strict file permissions (600) Use external secret managers (Azure Key Vault, Vault) Use Managed Identity on Azure VMs Rotate secrets frequently Monitor secret access DO NOT rely on ~/.entratool/secrets.dat for production security.\nCertificate Storage linkHow Certificates Are Stored linkCertificates are not stored by the tool. You provide the certificate path:\n1 2 3 4 { \"name\": \"cert-profile\", \"certificatePath\": \"/path/to/certificate.pfx\" } Certificate Security linkSecurity depends on:\nFile permissions on certificate file Password protection of PFX/PKCS12 file Storage location security Best Practices link1. Restrict File Permissions link 1 2 3 4 5 6 # Linux/macOS chmod 600 /path/to/cert.pfx chown myuser:myuser /path/to/cert.pfx # Windows icacls cert.pfx /inheritance:r /grant:r \"%USERNAME%:F\" 2. Password-Protect Certificates linkAlways use password-protected PFX files:\n1 2 3 # Convert to password-protected PFX openssl pkcs12 -export -in cert.pem -inkey key.pem \\ -out cert.pfx -password pass:YourStrongPassword 3. Store in Secure Locations linkmacOS:\n1 2 # Store in user-protected directory ~/Library/Application Support/entratool/certs/ Windows:\n1 2 # Store in user profile %USERPROFILE%\\.entratool\\certs\\ Linux:\n1 2 3 # Store with restricted permissions ~/.entratool/certs/ chmod 700 ~/.entratool/certs/ 4. Use Certificate Stores linkWindows Certificate Store:\n1 2 3 4 5 # Import certificate to Windows store certutil -user -p YourPassword -importPFX cert.pfx # Reference by thumbprint in profile \"certificateThumbprint\": \"ABC123...\" macOS Keychain:\n1 2 3 4 5 # Import to Keychain security import cert.pfx -k login.keychain -P YourPassword # Reference by name \"certificateName\": \"My Certificate\" Secret Lifecycle link1. Secret Creation linkClient Secret:\n1 2 3 4 entratool config create # Select: Client Secret # Enter: your-secret-here # ✓ Encrypted and stored securely Certificate:\n1 2 3 4 5 6 entratool config create # Select: Certificate # Enter: /path/to/cert.pfx # Enter password: **** # ✓ Password encrypted and stored # ✓ Certificate path stored (plaintext) 2. Secret Usage linkWhen generating tokens:\nProfile is read from profiles.json Secrets are decrypted from secure storage Used for authentication Never written to logs or disk unencrypted 3. Secret Rotation linkUpdate secrets regularly:\n1 2 3 4 5 # Edit profile and update secret entratool config edit -p myprofile # Select: Client Secret or Certificate # Enter new secret # ✓ Old secret overwritten 4. Secret Deletion linkWhen deleting a profile:\n1 2 3 entratool config delete -p myprofile # ✓ Profile removed from profiles.json # ✓ Associated secrets removed from secure storage Security Audit linkChecking What’s Stored linkList Profiles link 1 entratool config list View Profile Details link 1 2 # View non-sensitive profile data cat ~/.entratool/profiles.json | jq Check Keychain (macOS) link 1 security find-generic-password -s entratool -g DPAPI Inventory (Windows) linkUse specialized tools like dpapick to audit DPAPI-protected data.\nBest Practices link✅ Development link Use platform secure storage (DPAPI on Windows, Keychain on macOS) Separate profiles for dev/test/prod Short-lived secrets Regular rotation ✅ Production linkWindows/macOS:\nPlatform secure storage is acceptable Certificates preferred over secrets Regular audits Linux:\n⚠️ Do not use built-in storage Use external secret manager (Key Vault, Vault) Or use certificate authentication with restricted file permissions Or use Managed Identity ✅ CI/CD link Store secrets in CI/CD secret manager (GitHub Secrets, Azure Pipelines) Inject at runtime Never commit secrets to git Use short-lived tokens ❌ Never link ❌ Commit profiles.json to git ❌ Share secrets via email/Slack ❌ Store secrets in plaintext files ❌ Use the same secret across environments ❌ Trust Linux XOR storage for production Troubleshooting link“Access to secure storage denied” linkWindows:\nUser profile may be corrupted Try running as the correct user macOS:\nKeychain may be locked Open Keychain Access and unlock “Cannot decrypt secret” linkCause: Secret was encrypted on different machine or user account\nFix:\nDelete profile: entratool config delete -p myprofile Recreate profile: entratool config create Re-enter secret Migrating Secrets linkSecrets are tied to user accounts and machines. To migrate:\nExport profile configuration (plaintext):\n1 cat ~/.entratool/profiles.json On new machine, recreate profile:\n1 2 entratool config create # Re-enter all secrets Note: Secrets cannot be exported/imported directly due to encryption.\nNext Steps link Creating Profiles Certificate Authentication Guide Production Deployment Security Best Practices "
            }
        );
    index.add(
            {
                id:  15 ,
                href: "\/docs\/oauth-flows\/",
                title: "OAuth2 Flows",
                description: "Detailed guides for each OAuth2 authentication flow",
                content: "OAuth2 Flows linkComprehensive guides for each supported OAuth2 authentication flow.\nOverview linkEntra Token CLI supports four OAuth2 authentication flows, each designed for specific scenarios:\nFlow Best For User Interaction Client Credentials Service-to-service None Authorization Code Web applications Required Device Code Limited-input devices Required (on another device) Interactive Browser Desktop applications Required Quick Overview linkFor a quick overview of all flows, see the OAuth2 Flows Core Concept page.\nDetailed Guides linkClient Credentials Flow linkUse for: Automated services, daemons, CI/CD pipelines\nRead the detailed guide →\nQuick example:\n1 entratool get-token -p service-principal -f ClientCredentials Authorization Code Flow linkUse for: Web applications with user sign-in\nRead the detailed guide →\nQuick example:\n1 entratool get-token -p webapp -f AuthorizationCode Device Code Flow linkUse for: Headless devices, IoT, SSH sessions\nRead the detailed guide →\nQuick example:\n1 entratool get-token -p iot-device -f DeviceCode Interactive Browser Flow linkUse for: Desktop applications, CLI tools with user authentication\nRead the detailed guide →\nQuick example:\n1 entratool get-token -p desktop-app -f InteractiveBrowser Flow Selection linkAutomatic Inference linkThe tool automatically selects the appropriate flow based on your profile configuration:\nClient Secret or Certificate configured → Client Credentials flow No client secret/certificate → Interactive Browser flow Manual Override linkOverride the automatic selection:\n1 entratool get-token -p myprofile -f DeviceCode Setting Default Flow in Profile linkConfigure a default flow when creating or editing a profile:\n1 2 3 4 entratool config create # ... other prompts ... Set default OAuth2 flow? y Default OAuth2 flow: ClientCredentials Comparing Flows linkBy Security Level link Client Credentials with Certificate - Highest security Authorization Code - High security (user context) Interactive Browser - Medium-high security Device Code - Medium security By User Experience link Client Credentials - No user interaction (best for automation) Interactive Browser - Simple browser sign-in Authorization Code - Browser sign-in with redirect Device Code - Sign in on another device (slightly more complex) By Use Case linkAutomation \u0026 CI/CD:\n✅ Client Credentials ❌ User-interactive flows Personal Scripts:\n✅ Interactive Browser ✅ Device Code ⚠️ Authorization Code (requires web server) Production Services:\n✅ Client Credentials with Certificate ❌ User-interactive flows Headless Servers:\n✅ Device Code ✅ Client Credentials ❌ Interactive Browser Troubleshooting link“Flow not supported for this profile” linkCause: Profile configuration doesn’t support the selected flow\nSolution:\nFor Client Credentials: Ensure client secret or certificate is configured For user flows: Ensure delegated permissions are configured “AADSTS50011: Redirect URI mismatch” linkCause: Redirect URI not configured for Authorization Code or Interactive Browser\nSolution:\nAzure Portal → App registrations → Your app → Authentication Add redirect URI: http://localhost:8080 “Device code expired” linkCause: User didn’t authenticate within time limit (typically 15 minutes)\nSolution:\nRequest new device code Authenticate more quickly Next Steps link Core Concepts: OAuth2 Flows User Guide: Generating Tokens Troubleshooting "
            }
        );
    index.add(
            {
                id:  16 ,
                href: "\/docs\/certificates\/",
                title: "Certificate Authentication",
                description: "Using certificates for secure authentication",
                content: "Certificate Authentication linkLearn how to use X.509 certificates for secure, passwordless authentication with Microsoft Entra ID.\nWhy Use Certificates? linkAdvantages Over Client Secrets link Feature Client Secret Certificate Security Medium High Validity Period Up to 2 years Up to 3 years Rotation Manual Automated possible Compromise Risk Higher Lower Audit Trail Limited Better When to Use Certificates link✅ Use certificates for:\nProduction service principals Long-running automated services High-security requirements Certificate-based infrastructure ⚠️ Stick with secrets for:\nQuick development/testing Short-lived projects Simple automation scripts Getting Started linkQuick Example link 1 2 3 4 5 6 7 8 # Create profile with certificate entratool config create # Select: Certificate # Path: /path/to/certificate.pfx # Password: **** # Generate token entratool get-token -p cert-profile Certificate Types linkPFX/PKCS12 Format linkMost common format for certificates with private keys\n1 2 3 4 5 6 7 8 # File extension certificate.pfx certificate.p12 # Contains - X.509 certificate - Private key - Optional: Certificate chain Supported by:\nWindows Certificate Store macOS Keychain File-based storage PEM Format linkText-based format (not directly supported)\nTo use PEM certificates, convert to PFX:\n1 2 3 4 5 openssl pkcs12 -export \\ -in certificate.pem \\ -inkey private-key.pem \\ -out certificate.pfx \\ -password pass:YourPassword Creating Certificates linkOption 1: Self-Signed Certificate linkFor development/testing only:\n1 2 3 4 5 6 7 8 9 10 # Windows (PowerShell) $cert = New-SelfSignedCertificate ` -Subject \"CN=MyApp\" ` -CertStoreLocation \"Cert:\\CurrentUser\\My\" ` -KeyExportPolicy Exportable ` -KeySpec Signature ` -NotAfter (Get-Date).AddYears(2) $password = ConvertTo-SecureString -String \"YourPassword\" -Force -AsPlainText Export-PfxCertificate -Cert $cert -FilePath \"certificate.pfx\" -Password $password 1 2 3 4 5 6 7 8 9 10 11 # macOS/Linux openssl req -x509 -newkey rsa:4096 \\ -keyout key.pem -out cert.pem \\ -days 730 -nodes \\ -subj \"/CN=MyApp\" # Convert to PFX openssl pkcs12 -export \\ -in cert.pem -inkey key.pem \\ -out certificate.pfx \\ -password pass:YourPassword Option 2: Certificate Authority (CA) linkFor production:\nGenerate Certificate Signing Request (CSR) Submit to your organization’s CA Receive signed certificate Combine with private key into PFX Registering Certificates in Azure linkUpload Certificate to App Registration link Azure Portal → Azure Active Directory → App registrations Select your application Certificates \u0026 secrets → Certificates tab Click Upload certificate Select your .cer or .pem file (public key only) Add description Click Add Extract Public Key from PFX link 1 2 3 4 5 6 # macOS/Linux openssl pkcs12 -in certificate.pfx -nokeys -out certificate.cer # Windows (PowerShell) $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2(\"certificate.pfx\", \"password\") [System.IO.File]::WriteAllBytes(\"certificate.cer\", $cert.Export(\"Cert\")) Configuring Profiles with Certificates linkInteractive Configuration link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 entratool config create # Prompts: Profile name: production-service Client ID: 12345678-1234-1234-1234-123456789abc Tenant ID: 87654321-4321-4321-4321-cba987654321 Authentication method: 1. Client Secret 2. Certificate Select: 2 Certificate path: /path/to/certificate.pfx Certificate password: **** Scope: https://graph.microsoft.com/.default ✓ Profile 'production-service' created successfully Profile Structure linkprofiles.json:\n1 2 3 4 5 6 7 8 9 10 11 12 { \"profiles\": [ { \"name\": \"production-service\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"certificatePath\": \"/path/to/certificate.pfx\", \"useCertificate\": true, \"scope\": \"https://graph.microsoft.com/.default\" } ] } Certificate password: Stored securely in platform-specific storage\nCertificate Storage linkFile-Based Storage linkBest practices:\n1 2 3 4 5 6 7 8 9 10 11 # Create secure directory mkdir -p ~/.entratool/certs chmod 700 ~/.entratool/certs # Store certificate with restricted permissions cp certificate.pfx ~/.entratool/certs/ chmod 600 ~/.entratool/certs/certificate.pfx # Update profile with path entratool config edit -p myprofile # Certificate path: /Users/username/.entratool/certs/certificate.pfx Windows Certificate Store linkImport certificate:\n1 2 3 4 5 6 7 # Import to Current User store Import-PfxCertificate -FilePath certificate.pfx ` -CertStoreLocation Cert:\\CurrentUser\\My ` -Password (ConvertTo-SecureString -String \"password\" -AsPlainText -Force) # List certificates Get-ChildItem Cert:\\CurrentUser\\My Reference by thumbprint in profile:\n1 2 3 4 { \"certificateThumbprint\": \"ABC123...\", \"certificateStoreLocation\": \"CurrentUser\" } macOS Keychain linkImport certificate:\n1 2 3 4 security import certificate.pfx -k login.keychain -P YourPassword # List certificates security find-identity -v -p codesigning Using Certificates linkGenerate Token link 1 entratool get-token -p cert-profile What happens:\nProfile loaded Certificate password retrieved from secure storage Certificate loaded from path or store Token generated using certificate authentication No password prompt if cached Certificate Password Caching linkFirst use:\n1 2 entratool get-token -p cert-profile # May prompt for certificate password Subsequent uses:\n1 2 entratool get-token -p cert-profile # No password prompt (cached securely) Certificate Rotation linkWhy Rotate Certificates? link Expiring certificates (check expiration dates) Security policy requirements Compromised certificates Annual/periodic rotation policies Rotation Process link1. Generate new certificate:\n1 # Generate new certificate (see \"Creating Certificates\" above) 2. Upload to Azure Portal:\nApp registrations → Your app → Certificates \u0026 secrets Upload new certificate Don’t delete old certificate yet 3. Test new certificate:\n1 2 3 4 5 6 7 # Create test profile with new certificate entratool config create # Name: test-new-cert # Certificate: /path/to/new-certificate.pfx # Test token generation entratool get-token -p test-new-cert 4. Update production profile:\n1 2 3 4 5 6 7 entratool config edit -p production-service # Select: Certificate Path # Enter: /path/to/new-certificate.pfx # Enter password: **** # Test production profile entratool get-token -p production-service 5. Remove old certificate from Azure:\nApp registrations → Your app → Certificates \u0026 secrets Delete old certificate Automated Rotation Script link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #!/bin/bash set -euo pipefail PROFILE=\"production-service\" NEW_CERT=\"/path/to/new-certificate.pfx\" CERT_PASSWORD=\"YourPassword\" # Backup current profile entratool config export -p \"$PROFILE\" -o \"backup-$PROFILE.json\" # Update certificate path (manual edit required for password) echo \"Updating profile with new certificate...\" entratool config edit -p \"$PROFILE\" # Manual step: Select Certificate Path, enter new path and password # Test echo \"Testing new certificate...\" if entratool get-token -p \"$PROFILE\" --silent \u003e /dev/null; then echo \"✓ Certificate rotation successful\" else echo \"✗ Certificate rotation failed\" exit 1 fi Certificate Validation linkCheck Certificate Expiration link 1 2 3 4 5 6 7 # macOS/Linux openssl pkcs12 -in certificate.pfx -nodes -passin pass:YourPassword | \\ openssl x509 -noout -enddate # Windows (PowerShell) $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2(\"certificate.pfx\", \"password\") $cert.NotAfter Verify Certificate Thumbprint link 1 2 3 4 5 6 7 # macOS/Linux openssl pkcs12 -in certificate.pfx -nodes -passin pass:YourPassword | \\ openssl x509 -noout -fingerprint -sha1 # Windows (PowerShell) $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2(\"certificate.pfx\", \"password\") $cert.Thumbprint Troubleshooting link“Certificate not found” linkCause: Certificate path is incorrect\nSolution:\n1 2 3 4 5 6 # Verify file exists ls -l /path/to/certificate.pfx # Update profile entratool config edit -p myprofile # Select: Certificate Path “Invalid certificate password” linkCause: Incorrect password or corrupted certificate\nSolution:\n1 2 3 4 5 6 # Test certificate manually openssl pkcs12 -in certificate.pfx -noout -passin pass:YourPassword # Update password in profile entratool config edit -p myprofile # Select: Certificate Password “AADSTS700027: Client assertion contains an invalid signature” linkCause: Certificate not registered in Azure or expired\nSolution:\nVerify certificate is uploaded to app registration Check certificate expiration Ensure correct certificate (match thumbprints) “Certificate has expired” linkCause: Certificate validity period has passed\nSolution:\nGenerate new certificate Upload to Azure Portal Update profile with new certificate Security Best Practices link✅ Do link Use strong certificate passwords Store certificates with restrictive file permissions (600) Rotate certificates annually or per policy Use CA-signed certificates for production Monitor certificate expiration dates Use separate certificates for dev/staging/prod ❌ Don’t link Store certificates in git repositories Share certificates via email/Slack Use weak passwords Ignore certificate expiration warnings Reuse certificates across environments Next Steps link Creating Profiles with Certificates Platform-Specific Certificate Storage Security Best Practices Troubleshooting Certificate Issues "
            }
        );
    index.add(
            {
                id:  17 ,
                href: "\/docs\/reference\/",
                title: "Command Reference",
                description: "Complete reference for all Entra Token CLI commands",
                content: "Command Reference linkComplete documentation for all Entra Token CLI commands, options, and arguments.\nCommand Overview link Command Description get-token Generate access tokens refresh Refresh expired tokens inspect Decode and inspect JWT tokens discover Quick token information config Manage authentication profiles --help Display help information --version Show version information get-token linkGenerate an access token using a configured profile.\nSynopsis link 1 entratool get-token [OPTIONS] Options link Option Alias Required Description --profile -p Yes Profile name to use --scope -s No Override profile scope --flow -f No OAuth2 flow to use --silent No Suppress output except token --output -o No Save token to file --json No Output as JSON OAuth2 Flows link ClientCredentials - Service-to-service AuthorizationCode - Web applications DeviceCode - Limited-input devices InteractiveBrowser - Desktop applications Examples linkBasic usage:\n1 entratool get-token -p my-profile Override scope:\n1 2 entratool get-token -p my-profile \\ --scope \"https://graph.microsoft.com/User.Read Mail.Read\" Specify flow:\n1 entratool get-token -p my-profile -f ClientCredentials Silent output (for scripts):\n1 TOKEN=$(entratool get-token -p my-profile --silent) Save to file:\n1 entratool get-token -p my-profile -o token.txt JSON output:\n1 entratool get-token -p my-profile --json Multiple scopes:\n1 2 entratool get-token -p my-profile \\ --scope \"https://graph.microsoft.com/User.Read,Mail.Read,Calendars.Read\" Device code flow:\n1 entratool get-token -p headless-server -f DeviceCode Interactive browser:\n1 entratool get-token -p user-app -f InteractiveBrowser Certificate authentication:\n1 entratool get-token -p cert-profile -f ClientCredentials Full documentation →\nrefresh linkRefresh an expired access token using a refresh token.\nSynopsis link 1 entratool refresh [OPTIONS] Options link Option Alias Required Description --profile -p Yes Profile name to use --silent No Suppress output except token --output -o No Save token to file Examples linkRefresh token:\n1 entratool refresh -p my-profile Silent output:\n1 TOKEN=$(entratool refresh -p my-profile --silent) Save to file:\n1 entratool refresh -p my-profile -o token.txt Notes link Requires offline_access scope in original token request Not available for Client Credentials flow Refresh tokens expire after 90 days of inactivity Full documentation →\ninspect linkDecode and display JWT token claims.\nSynopsis link 1 entratool inspect [OPTIONS] Options link Option Alias Required Description --token -t Conditional Token string to inspect --file -f Conditional File containing token Note: Provide either --token or --file, or pipe token via stdin.\nExamples linkInspect token string:\n1 entratool inspect -t \"eyJ0eXAiOiJKV1Qi...\" Inspect from file:\n1 entratool inspect -f token.txt Inspect from pipeline:\n1 entratool get-token -p my-profile --silent | entratool inspect Extract specific claim:\n1 entratool inspect -t \"$TOKEN\" | jq -r .payload.scp Check expiration:\n1 entratool inspect -t \"$TOKEN\" | jq -r .payload.exp View all claims:\n1 entratool inspect -f token.txt | jq Full documentation →\ndiscover linkQuick token information and validation.\nSynopsis link 1 entratool discover [OPTIONS] Options link Option Alias Required Description --token -t Conditional Token string to discover --file -f Conditional File containing token Exit Codes link 0 - Token is valid 1 - Token is expired or invalid Examples linkDiscover token info:\n1 entratool discover -t \"eyJ0eXAiOiJKV1Qi...\" Check if token is valid:\n1 2 3 4 5 if entratool discover -t \"$TOKEN\" \u0026\u003e/dev/null; then echo \"Token is valid\" else echo \"Token is expired\" fi From file:\n1 entratool discover -f token.txt In script:\n1 2 3 4 if ! entratool discover -f token.txt; then # Token expired, get new one entratool get-token -p my-profile --silent \u003e token.txt fi Full documentation →\nconfig linkManage authentication profiles.\nSynopsis link 1 entratool config [OPTIONS] Subcommands link Subcommand Description create Create new profile list List all profiles edit Edit existing profile delete Delete profile export Export profile(s) import Import profile(s) config create linkCreate a new authentication profile interactively.\nSynopsis:\n1 entratool config create Example:\n1 2 3 4 5 6 7 8 9 entratool config create # Interactive prompts: # - Profile name # - Client ID # - Tenant ID # - Authentication method # - Scope # - OAuth2 flow (optional) config list linkList all configured profiles.\nSynopsis:\n1 entratool config list [OPTIONS] Options:\nOption Description --json Output as JSON Examples:\n1 2 3 4 5 # List profiles entratool config list # JSON output entratool config list --json config edit linkEdit an existing profile interactively.\nSynopsis:\n1 entratool config edit [OPTIONS] Options:\nOption Alias Required Description --profile -p Yes Profile name to edit Example:\n1 2 3 4 5 6 7 8 9 entratool config edit -p my-profile # Select what to edit: # - Client ID # - Tenant ID # - Client Secret # - Scope # - OAuth2 Flow # - Authority URL config delete linkDelete a profile and its associated secrets.\nSynopsis:\n1 entratool config delete [OPTIONS] Options:\nOption Alias Required Description --profile -p Yes Profile name to delete --force No Skip confirmation Examples:\n1 2 3 4 5 # Delete with confirmation entratool config delete -p my-profile # Delete without confirmation entratool config delete -p my-profile --force config export linkExport profile configuration (without secrets).\nSynopsis:\n1 entratool config export [OPTIONS] Options:\nOption Alias Required Description --profile -p No Profile name (omit for all) --output -o Yes Output file path Examples:\n1 2 3 4 5 # Export single profile entratool config export -p my-profile -o profile.json # Export all profiles entratool config export -o all-profiles.json config import linkImport profile configuration from file.\nSynopsis:\n1 entratool config import [OPTIONS] Options:\nOption Alias Required Description --file -f Yes File to import Example:\n1 entratool config import -f profile.json Full config documentation →\n--help linkDisplay help information.\nSynopsis link 1 2 entratool --help entratool --help Examples linkGeneral help:\n1 entratool --help Command-specific help:\n1 2 3 entratool get-token --help entratool config --help entratool config create --help --version linkDisplay version information.\nSynopsis link 1 entratool --version Output:\n_ _ _ ___ _ __ _ __| |_ _ __ __ _| |_ ___ ___ | | / _ \\ '_ \\| '__| __| '__/ _` | __/ _ \\ / _ \\| | | __/ | | | | | |_| | | (_| | || (_) | (_) | | \\___|_| |_|_| \\__|_| \\__,_|\\__\\___/ \\___/|_| version 1.0.0 Global Options linkAvailable for all commands:\nOption Description --help Display help --version Display version --verbose Enable verbose output --no-color Disable colored output Exit Codes link Code Meaning 0 Success 1 General error 2 Invalid arguments 3 Authentication failed 4 Profile not found 5 Token expired 6 Network error Environment Variables link Variable Description Example AZURE_CLIENT_ID Default client ID 12345678-... AZURE_TENANT_ID Default tenant ID 87654321-... AZURE_CLIENT_SECRET Client secret abc123... ENTRATOOL_CONFIG_PATH Config directory ~/.entratool Configuration Files linkProfile Configuration linkLocation: ~/.entratool/profiles.json\nFormat:\n1 2 3 4 5 6 7 8 9 10 11 12 { \"profiles\": [ { \"name\": \"my-profile\", \"clientId\": \"12345678-1234-1234-1234-123456789abc\", \"tenantId\": \"87654321-4321-4321-4321-cba987654321\", \"scope\": \"https://graph.microsoft.com/.default\", \"flow\": \"ClientCredentials\", \"useClientSecret\": true } ] } Secure Storage linkSecrets location:\nWindows: DPAPI-encrypted store macOS: Keychain (~/Library/Keychains/login.keychain-db) Linux: ~/.entratool/secrets.dat (⚠️ XOR obfuscated) Common Command Patterns linkScript Integration link 1 2 3 4 5 6 7 8 9 #!/bin/bash set -euo pipefail # Get token TOKEN=$(entratool get-token -p automation --silent) # Use token curl -H \"Authorization: Bearer $TOKEN\" \\ https://graph.microsoft.com/v1.0/me Token Caching link 1 2 3 4 5 6 7 8 9 10 TOKEN_FILE=\"/tmp/cached-token.txt\" # Check if token is valid if ! entratool discover -f \"$TOKEN_FILE\" \u0026\u003e/dev/null; then # Get fresh token entratool get-token -p my-profile --silent \u003e \"$TOKEN_FILE\" chmod 600 \"$TOKEN_FILE\" fi TOKEN=$(cat \"$TOKEN_FILE\") Multi-Environment link 1 2 3 4 5 6 7 8 # Development entratool get-token -p dev-profile -f ClientCredentials # Staging entratool get-token -p staging-profile -f ClientCredentials # Production entratool get-token -p prod-profile -f ClientCredentials Error Handling link 1 2 3 4 5 6 7 8 if ! TOKEN=$(entratool get-token -p my-profile --silent 2\u003e\u00261); then echo \"Error: Failed to get token\" echo \"$TOKEN\" exit 1 fi # Use token curl -H \"Authorization: Bearer $TOKEN\" ... Next Steps link Detailed Command Documentation Configuration Reference User Guide Recipes "
            }
        );
    index.add(
            {
                id:  18 ,
                href: "\/docs\/platform-guides\/",
                title: "Platform Guides",
                description: "Platform-specific considerations and best practices",
                content: "Platform Guides linkPlatform-specific configuration, security considerations, and best practices for Windows, macOS, and Linux.\nOverview linkEntra Token CLI works across all major platforms, but each has unique characteristics for secure storage and certificate management.\nPlatform Secure Storage Security Level Production Ready Windows DPAPI 🔒 Strong ✅ Yes macOS Keychain 🔒 Strong ✅ Yes Linux XOR Obfuscation ⚠️ Weak ⚠️ Use alternatives Windows linkInstallation linkGlobal Tool:\n1 dotnet tool install --global EntraTokenCli Self-Contained Executable:\n1 2 3 4 5 # Download from releases curl -L -o entratool.exe https://github.com/.../entratool-win-x64.exe # Add to PATH $env:PATH += \";C:\\path\\to\\entratool\" Secure Storage linkTechnology: Data Protection API (DPAPI)\nCharacteristics:\n✅ Strong encryption (AES-256) ✅ User-account bound ✅ No external dependencies ✅ Automatic key management Security Properties:\nSecrets encrypted with user’s Windows credentials Only same user on same machine can decrypt Administrators cannot decrypt other users’ data Survives system restarts Configuration Location:\n1 2 3 4 # Profiles $env:USERPROFILE\\.entratool\\profiles.json # Secure storage managed by Windows Certificate Management linkWindows Certificate Store:\n1 2 3 4 5 6 7 # Import certificate certutil -user -p YourPassword -importPFX cert.pfx # List certificates certutil -user -store My # Reference in profile by thumbprint File-Based Certificates:\n1 2 3 # Store with restricted permissions $cert = \"C:\\Users\\$env:USERNAME\\.entratool\\certs\\cert.pfx\" icacls $cert /inheritance:r /grant:r \"$env:USERNAME:F\" PowerShell Integration link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 function Get-EntraToken { param( [string]$Profile, [switch]$Silent ) $args = @(\"get-token\", \"-p\", $Profile) if ($Silent) { $args += \"--silent\" } $token = \u0026 entratool $args return $token } # Usage $token = Get-EntraToken -Profile \"my-profile\" -Silent $headers = @{\"Authorization\" = \"Bearer $token\"} Invoke-RestMethod -Uri \"https://graph.microsoft.com/v1.0/me\" ` -Headers $headers Best Practices link✅ Do:\nUse DPAPI secure storage (default) Store certificates in user profile or Windows Certificate Store Use Group Policy for enterprise deployment Implement credential rotation policies ⚠️ Avoid:\nStoring secrets in environment variables Using plaintext configuration files Sharing user profiles between environments Detailed Windows guide →\nmacOS linkInstallation linkGlobal Tool:\n1 dotnet tool install --global EntraTokenCli Self-Contained Executable:\nApple Silicon (M1/M2/M3):\n1 2 3 curl -L -o entratool https://github.com/.../entratool-osx-arm64 chmod +x entratool sudo mv entratool /usr/local/bin/ Intel:\n1 2 3 curl -L -o entratool https://github.com/.../entratool-osx-x64 chmod +x entratool sudo mv entratool /usr/local/bin/ Secure Storage linkTechnology: macOS Keychain\nCharacteristics:\n✅ System-level encryption (AES-256) ✅ Integration with Touch ID/Face ID ✅ Per-item access control ✅ Audit logging Keychain Location:\n1 ~/Library/Keychains/login.keychain-db Viewing Secrets:\nOpen Keychain Access app: /Applications/Utilities/Keychain Access.app Search for “entratool” Double-click item Check “Show password” Authenticate with your password or biometrics Keychain Management:\n1 2 3 4 5 6 7 8 # List entratool entries security find-generic-password -s entratool # Export keychain (for backup) security export -k login.keychain-db -t identities -o backup.p12 # Import keychain security import backup.p12 -k login.keychain-db Certificate Management linkImport to Keychain:\n1 security import cert.pfx -k login.keychain -P YourPassword File-Based Certificates:\n1 2 # Store with restricted permissions chmod 600 ~/Library/Application\\ Support/entratool/certs/cert.pfx Shell Integration link 1 2 3 4 5 6 7 8 9 # Add to ~/.zshrc or ~/.bash_profile get_entra_token() { local profile=$1 entratool get-token -p \"$profile\" --silent } # Usage TOKEN=$(get_entra_token \"my-profile\") curl -H \"Authorization: Bearer $TOKEN\" https://graph.microsoft.com/v1.0/me Best Practices link✅ Do:\nUse Keychain secure storage (default) Enable Touch ID for keychain access Use FileVault for full-disk encryption Back up keychain securely ⚠️ Avoid:\nExporting keychain to unencrypted files Storing secrets in plaintext Sharing login keychain Detailed macOS guide →\nLinux linkInstallation linkGlobal Tool:\n1 dotnet tool install --global EntraTokenCli Self-Contained Executable:\n1 2 3 4 # Download (replace with appropriate architecture) curl -L -o entratool https://github.com/.../entratool-linux-x64 chmod +x entratool sudo mv entratool /usr/local/bin/ ⚠️ Security Warning link report Linux storage uses XOR obfuscation - NOT secure for production!\nSecrets are stored in ~/.entratool/secrets.dat using reversible XOR encoding. Anyone with file access can decode secrets easily.\nFor production workloads, use:\nCertificate authentication with restricted file permissions\nExternal secret managers (Azure Key Vault, HashiCorp Vault)\nManaged Identity on Azure VMs\nEnvironment variables (CI/CD)\nStorage Location link 1 2 3 4 5 # Profiles (plaintext) ~/.entratool/profiles.json # Secrets (XOR obfuscated - NOT secure) ~/.entratool/secrets.dat File Permissions:\n1 2 chmod 700 ~/.entratool chmod 600 ~/.entratool/* Production Alternatives link1. Certificate Authentication link 1 2 3 4 5 6 7 8 # Store certificate with restricted permissions chmod 600 ~/.entratool/certs/cert.pfx chown $USER:$USER ~/.entratool/certs/cert.pfx # Use certificate in profile entratool config create # Select: Certificate # Path: /home/user/.entratool/certs/cert.pfx 2. Azure Key Vault link 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #!/bin/bash # Retrieve secret from Key Vault SECRET=$(az keyvault secret show \\ --vault-name MyVault \\ --name EntraClientSecret \\ --query value -o tsv) # Create profile without stored secret cat \u003e /tmp/profile.json \u003c"
            }
        );
    index.add(
            {
                id:  19 ,
                href: "\/docs\/troubleshooting\/",
                title: "Troubleshooting",
                description: "Common issues and solutions",
                content: "Troubleshooting linkSolutions to common problems and error messages.\nProfile Issues link“Profile not found” linkError:\nError: Profile 'my-profile' not found Cause: Profile name is incorrect or doesn’t exist.\nSolution:\n1 2 3 4 5 # List available profiles entratool config list # Use correct name entratool get-token -p correct-profile-name “Profile already exists” linkError:\nError: Profile 'my-profile' already exists Cause: Attempting to create a profile with a duplicate name.\nSolution:\n1 2 3 4 5 6 # Option 1: Delete existing profile entratool config delete -p my-profile # Option 2: Use a different name entratool config create # Enter: my-profile-2 “Invalid profile configuration” linkError:\nError: Failed to load profiles.json Invalid JSON format Cause: Corrupted profiles.json file.\nSolution:\n1 2 3 4 5 6 7 8 9 10 # Backup current file cp ~/.entratool/profiles.json ~/.entratool/profiles.json.bak # Validate JSON syntax cat ~/.entratool/profiles.json | jq # If invalid, manually fix JSON syntax or restore from backup # Or delete and recreate profiles rm ~/.entratool/profiles.json entratool config create “Cannot access secure storage” linkError:\nError: Failed to access secure storage Platform-specific causes and solutions:\nWindows:\nCause: User profile corrupted Solution: Run sfc /scannow as administrator macOS:\nCause: Keychain is locked Solution: Open Keychain Access app Select “login” keychain Unlock with your password Linux:\nCause: File permissions on ~/.entratool/ directory Solution: 1 2 chmod 700 ~/.entratool chmod 600 ~/.entratool/* Authentication Failures link“AADSTS70011: Invalid scope” linkError:\nAADSTS70011: The provided value for the input parameter 'scope' is not valid. Cause: Requested scope is not configured in app registration or has incorrect format.\nSolutions:\n1. Check scope format:\n1 2 3 4 5 # ❌ Wrong (missing base URL) --scope \"User.Read\" # ✓ Correct --scope \"https://graph.microsoft.com/User.Read\" 2. Add permission in Azure Portal:\nGo to Azure Portal Navigate to Azure Active Directory → App registrations Select your application Click “API permissions” Click “Add a permission” Select the API (e.g., Microsoft Graph) Select the required permission Click “Grant admin consent” (if needed) “AADSTS7000215: Invalid client secret” linkError:\nAADSTS7000215: Invalid client secret provided. Cause: Client secret is expired, incorrect, or not properly stored.\nSolutions:\n1. Check secret expiration in Azure Portal:\nApp registrations → Your app → Certificates \u0026 secrets Check “Client secrets” section for expiration date 2. Rotate secret:\n1 2 3 4 5 # Generate new secret in Azure Portal # Then update profile: entratool config edit -p my-profile # Select: Client Secret # Enter: new-secret-from-portal 3. Verify secret was stored correctly:\n1 2 3 4 # Recreate profile entratool config delete -p my-profile entratool config create # Carefully re-enter all information “AADSTS50057: Application is disabled” linkError:\nAADSTS50057: The application is currently disabled. Cause: App registration is disabled in Azure Portal.\nSolution:\nGo to Azure Portal → App registrations Select your application If disabled, contact your administrator to re-enable it “AADSTS65001: User consent required” linkError:\nAADSTS65001: The user or administrator has not consented to use the application. Cause: User hasn’t consented to delegated permissions.\nSolution:\nOption 1: Use interactive flow to consent:\n1 2 entratool get-token -p my-profile -f InteractiveBrowser # User will be prompted to consent Option 2: Admin grants consent in Azure Portal:\nApp registrations → Your app → API permissions Click “Grant admin consent for [Tenant]” Click “Yes” “AADSTS65002: Consent required for required scopes” linkError:\nAADSTS65002: Consent between first party application and first party resource must be configured via preauthorization. Cause: Requesting scopes that require admin consent but using user-interactive flow.\nSolution:\nHave admin grant consent in Azure Portal Or use Client Credentials flow with Application permissions “AADSTS700016: Application not found” linkError:\nAADSTS700016: Application with identifier '...' was not found in the directory. Cause: Client ID is incorrect or app registration doesn’t exist in the specified tenant.\nSolutions:\n1. Verify Client ID:\n1 2 3 4 # Check profile configuration entratool config list # Correct Client ID format: 12345678-1234-1234-1234-123456789abc 2. Verify Tenant ID:\nEnsure you’re using the correct tenant ID For multi-tenant apps, try common instead of specific tenant ID 3. Check app registration exists:\nAzure Portal → Azure Active Directory → App registrations Verify app exists and note the correct Application (client) ID Token Problems link“Token expired” linkError:\nError: Token has expired HTTP 401 Unauthorized Cause: Access token lifetime exceeded (typically 1 hour).\nSolutions:\n1. Get fresh token:\n1 TOKEN=$(entratool get-token -p my-profile --silent) 2. Use refresh token (if available):\n1 TOKEN=$(entratool refresh -p my-profile --silent) 3. Implement automatic refresh:\n1 2 3 4 5 6 7 8 9 #!/bin/bash get_valid_token() { if ! entratool discover -f token.txt \u0026\u003e/dev/null; then entratool get-token -p my-profile --silent \u003e token.txt fi cat token.txt } TOKEN=$(get_valid_token) “Invalid token format” linkError:\nError: Token is not a valid JWT Cause: Token string is malformed or corrupted.\nSolutions:\n1. Check for whitespace or newlines:\n1 2 3 4 5 6 # ❌ Token with newline TOKEN=\"eyJ0eXAi... extra text\" # ✓ Trim whitespace TOKEN=$(entratool get-token -p my-profile --silent | tr -d '\\n') 2. Verify token structure:\n1 2 3 # Should have 3 parts separated by dots echo \"$TOKEN\" | awk -F. '{print NF-1}' # Should output: 2 3. Regenerate token:\n1 TOKEN=$(entratool get-token -p my-profile --silent) “Invalid audience” linkError:\nError: Token audience does not match HTTP 401 Unauthorized Cause: Token was issued for a different API than you’re calling.\nSolution:\n1. Check token audience:\n1 entratool inspect -t \"$TOKEN\" | jq -r .payload.aud 2. Request token with correct scope:\n1 2 3 4 5 6 7 8 9 10 11 # For Microsoft Graph entratool get-token -p my-profile \\ --scope \"https://graph.microsoft.com/.default\" # For Azure Management entratool get-token -p my-profile \\ --scope \"https://management.azure.com/.default\" # For custom API entratool get-token -p my-profile \\ --scope \"https://api.contoso.com/.default\" Permission Errors link“Insufficient privileges” linkError:\nError: Insufficient privileges to complete the operation HTTP 403 Forbidden Cause: Token has the scope but user/app lacks the underlying permission.\nSolutions:\nFor users:\nVerify user has appropriate Azure AD role: Azure Portal → Azure Active Directory → Users Select user → Assigned roles Assign required role (e.g., Global Reader, User Administrator) For service principals:\nGrant admin consent for Application permissions: Azure Portal → App registrations → Your app → API permissions Check “Status” column shows “Granted” If not, click “Grant admin consent” 2. Check token claims:\n1 entratool inspect -t \"$TOKEN\" | jq '.payload | {scp, roles}' “AADSTS50105: Not assigned to a role” linkError:\nAADSTS50105: The signed in user is not assigned to a role for the application. Cause: User is not assigned to the application (when assignment is required).\nSolution:\nAzure Portal → Enterprise applications → Your app Click “Users and groups” Click “Add user/group” Select user and assign role Click “Assign” “AADSTS50076: MFA required” linkError:\nAADSTS50076: Due to a configuration change made by your administrator, or because you moved to a new location, you must use multi-factor authentication to access. Cause: Multi-factor authentication is required by conditional access policy.\nSolution:\nUse interactive flow (Interactive Browser or Device Code) User will be prompted for MFA during authentication Client Credentials flow cannot satisfy MFA requirements (use certificate or Managed Identity) Certificate Issues link“Certificate not found” linkError:\nError: Certificate file not found: /path/to/cert.pfx Cause: Certificate path is incorrect or file doesn’t exist.\nSolution:\n1. Verify path:\n1 ls -l /path/to/cert.pfx 2. Update profile with correct path:\n1 2 3 entratool config edit -p my-profile # Select: Certificate Path # Enter: /correct/path/to/cert.pfx “Invalid certificate password” linkError:\nError: The specified password is incorrect Cause: Certificate password is incorrect.\nSolution:\n1. Update password:\n1 2 3 entratool config edit -p my-profile # Select: Certificate Password # Enter correct password 2. Verify certificate manually:\n1 2 3 4 # macOS/Linux openssl pkcs12 -in cert.pfx -noout -passin pass:YourPassword # If this fails, password is incorrect “Certificate expired” linkError:\nError: Certificate has expired AADSTS700027: Client assertion contains an invalid signature. Cause: Certificate has passed its expiration date.\nSolution:\n1. Check certificate expiration:\n1 2 openssl pkcs12 -in cert.pfx -nodes -passin pass:YourPassword | \\ openssl x509 -noout -enddate 2. Generate new certificate:\n1 # See: /docs/certificates/creation/ 3. Update app registration:\nAzure Portal → App registrations → Your app Certificates \u0026 secrets → Certificates → Upload Upload new certificate 4. Update profile:\n1 2 entratool config edit -p my-profile # Update certificate path to new certificate Network Issues link“Connection timeout” linkError:\nError: Connection timed out Failed to connect to login.microsoftonline.com Cause: Network connectivity issue or firewall blocking.\nSolutions:\n1. Check internet connectivity:\n1 ping login.microsoftonline.com 2. Check firewall rules:\nEnsure outbound HTTPS (443) is allowed Check corporate proxy settings 3. Configure proxy (if needed):\n1 2 export HTTPS_PROXY=http://proxy.company.com:8080 entratool get-token -p my-profile “SSL/TLS error” linkError:\nError: SSL certificate problem: unable to get local issuer certificate Cause: SSL/TLS certificate validation failure.\nSolutions:\n1. Update CA certificates:\n1 2 3 4 5 6 7 8 # Ubuntu/Debian sudo apt-get update \u0026\u0026 sudo apt-get install ca-certificates # macOS # Certificates managed by Keychain, usually no action needed # Windows # Certificates managed by Windows, usually no action needed 2. Corporate proxy with SSL inspection:\n1 2 # If behind corporate proxy doing SSL inspection: # Import corporate root CA certificate to system trust store Flow-Specific Issues linkDevice Code: “Code expired” linkError:\nError: Device code expired Cause: User didn’t authenticate within the time limit (typically 15 minutes).\nSolution:\n1 2 3 # Request new device code entratool get-token -p my-profile -f DeviceCode # Authenticate faster this time Interactive Browser: “Redirect URI mismatch” linkError:\nAADSTS50011: The redirect URI specified in the request does not match the redirect URIs configured for the application. Cause: Localhost redirect URI not configured in app registration.\nSolution:\nAzure Portal → App registrations → Your app Authentication → Add a platform → Web Add redirect URI: http://localhost:8080 Save Try:\n1 entratool get-token -p my-profile -f InteractiveBrowser “Browser did not respond” linkError:\nError: Browser authentication timed out Cause: Browser didn’t complete authentication or localhost port blocked.\nSolutions:\n1. Try Device Code flow instead:\n1 entratool get-token -p my-profile -f DeviceCode 2. Check localhost is not blocked:\n1 2 3 4 5 # Verify localhost resolves ping localhost # Check port is available nc -zv localhost 8080 3. Try different port (if configurable):\n1 2 # Configure alternate redirect URI in Azure Portal # e.g., http://localhost:8081 Platform-Specific Issues linkLinux: “Secrets not secure” linkWarning:\nWarning: Linux storage uses XOR obfuscation (not secure) Cause: Linux lacks universal secure storage.\nRecommendations:\n1. Use certificate authentication:\n1 2 3 4 entratool config create # Select: Certificate # Store certificate with restricted permissions chmod 600 /path/to/cert.pfx 2. Use environment variables:\n1 2 export AZURE_CLIENT_SECRET=\"your-secret\" # Create profile without stored secret 3. Use external secret manager:\n1 2 3 # Azure Key Vault SECRET=$(az keyvault secret show --vault-name MyVault --name MySecret -query value -o tsv) entratool get-token -p my-profile --client-secret \"$SECRET\" macOS: “Operation not permitted” linkError:\nError: Keychain operation not permitted Cause: Keychain is locked or application needs permission.\nSolution:\nOpen Keychain Access app Unlock “login” keychain Try again Windows: “DPAPI error” linkError:\nError: Failed to protect data using DPAPI Cause: User profile issue.\nSolution:\nCheck user profile integrity Run sfc /scannow as administrator If problem persists, create new Windows user profile Diagnostic Commands linkCheck Tool Version link 1 entratool --version Verify Profile Configuration link 1 2 entratool config list cat ~/.entratool/profiles.json | jq Test Token Generation link 1 entratool get-token -p my-profile --silent Inspect Token link 1 2 TOKEN=$(entratool get-token -p my-profile --silent) entratool inspect -t \"$TOKEN\" Check Token Validity link 1 2 entratool discover -t \"$TOKEN\" echo \"Exit code: $?\" # 0 = valid, 1 = expired Getting Help linkEnable Verbose Output link 1 entratool get-token -p my-profile --verbose Check Logs linkLocation:\nWindows: %TEMP%\\entratool\\ macOS/Linux: /tmp/entratool/ Report Issues linkInclude:\nTool version: entratool --version Platform: Windows/macOS/Linux Error message (redact sensitive info) Steps to reproduce Next Steps link Core Concepts User Guide Platform Guides Security Best Practices "
            }
        );
    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script></body></html>